import{r as l,R as mi,Q as ui,u as ja,c as Ve,d as Se,j as e,e as xi}from"./query-jvROevkm.js";import{r as hi,s as pi,S as gr,O as zs,P as fr,C as qs,a as br,T as $s,D as Vs,R as yr,b as jr,c as wr,d as Nr,I as gi,e as vr,f as Sr,g as fi,h as Pr,V as bi,L as Tr,i as Cr,j as yi,k as ji,l as kr,m as wi,n as Ni,o as Ir,p as vi,q as Si,t as Ar,u as Pi,v as Er,w as Ti,x as Dr,y as Mr,z as Lr,A as Ci,B as Fr,E as Or,F as Rr,G as _r,H as ki,J as Br,K as zr,M as qr,N as $r,Q as Vr,U as Wr,W as Ii}from"./radix-cumDhdZK.js";import{L as gt,t as Ai,c as Ei,a as Gt,X as ce,C as wa,b as Di,d as Na,M as Ws,e as Hr,f as Ur,g as Kr,S as As,h as Qr,i as ft,j as _a,k as Mi,H as Bt,T as rt,A as st,D as Yr,l as Gr,U as bt,m as ye,I as Es,n as Xt,o as Li,p as ie,q as oa,P as Ba,R as zt,Z as Fi,r as Ie,B as ns,s as ys,u as Oi,v as Ri,w as is,x as Wt,y as Ts,z as va,E as _i,F as ts,G as Bi,J as Xr,K as zi,N as qi,O as ca,Q as Nt,V as at,W as $i,Y as et,_ as Vi,$ as Pt,a0 as Wi,a1 as Ds,a2 as da,a3 as Jr,a4 as Zr,a5 as en,a6 as Hi,a7 as Rt,a8 as Ui,a9 as Ki,aa as za,ab as Qi,ac as Ms,ad as ma,ae as Yi,af as Gi,ag as Xi,ah as Ji}from"./ui-Bne0lPEw.js";import{u as Zi,F as el,C as tn,o as tl,r as sl,a as al,b as Ct,e as Sa,c as Ht,n as Ls,d as Ut,f as sn,s as $e,g as an,h as rl,i as nl,j as ua,k as rn,l as il,z as ll}from"./forms-D7CqqJPV.js";import{M as nn,r as ln}from"./markdown-BfTglWBb.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function a(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=a(n);fetch(n.href,i)}})();var js={},qa;function ol(){if(qa)return js;qa=1;var s=hi();return js.createRoot=s.createRoot,js.hydrateRoot=s.hydrateRoot,js}var cl=ol();function dl(s,t){if(s instanceof RegExp)return{keys:!1,pattern:s};var a,r,n,i,o=[],m="",h=s.split("/");for(h[0]||h.shift();n=h.shift();)a=n[0],a==="*"?(o.push(a),m+=n[1]==="?"?"(?:/(.*))?":"/(.*)"):a===":"?(r=n.indexOf("?",1),i=n.indexOf(".",1),o.push(n.substring(1,~r?r:~i?i:n.length)),m+=~r&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(m+=(~r?"?":"")+"\\"+n.substring(i))):m+="/"+n;return{keys:o,pattern:new RegExp("^"+m+(t?"(?=$|/)":"/?$"),"i")}}const ml=mi.useInsertionEffect,ul=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",on=ul?l.useLayoutEffect:l.useEffect,xl=ml||on,Pa=s=>{const t=l.useRef([s,(...a)=>t[0](...a)]).current;return xl(()=>{t[0]=s}),t[1]},hl="popstate",Ta="pushState",Ca="replaceState",pl="hashchange",$a=[hl,Ta,Ca,pl],gl=s=>{for(const t of $a)addEventListener(t,s);return()=>{for(const t of $a)removeEventListener(t,s)}},cn=(s,t)=>pi.useSyncExternalStore(gl,s,t),Va=()=>location.search,fl=({ssrSearch:s}={})=>cn(Va,s!=null?()=>s:Va),Wa=()=>location.pathname,bl=({ssrPath:s}={})=>cn(Wa,s!=null?()=>s:Wa),yl=(s,{replace:t=!1,state:a=null}={})=>history[t?Ca:Ta](a,"",s),jl=(s={})=>[bl(s),yl],Ha=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[Ha]>"u"){for(const s of[Ta,Ca]){const t=history[s];history[s]=function(){const a=t.apply(this,arguments),r=new Event(s);return r.arguments=arguments,dispatchEvent(r),a}}Object.defineProperty(window,Ha,{value:!0})}const wl=(s,t)=>t.toLowerCase().indexOf(s.toLowerCase())?"~"+t:t.slice(s.length)||"/",dn=(s="")=>s==="/"?"":s,Nl=(s,t)=>s[0]==="~"?s.slice(1):dn(t)+s,vl=(s="",t)=>wl(Ua(dn(s)),Ua(t)),Ua=s=>{try{return decodeURI(s)}catch{return s}},mn={hook:jl,searchHook:fl,parser:dl,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:s=>s,aroundNav:(s,t,a)=>s(t,a)},un=l.createContext(mn),Jt=()=>l.useContext(un),xn={},hn=l.createContext(xn),Sl=()=>l.useContext(hn),us=s=>{const[t,a]=s.hook(s);return[vl(s.base,t),Pa((r,n)=>s.aroundNav(a,Nl(r,s.base),n))]},xs=()=>us(Jt()),pn=(s,t,a,r)=>{const{pattern:n,keys:i}=t instanceof RegExp?{keys:!1,pattern:t}:s(t||"*",r),o=n.exec(a)||[],[m,...h]=o;return m!==void 0?[!0,(()=>{const f=i!==!1?Object.fromEntries(i.map((y,b)=>[y,h[b]])):o.groups;let d={...h};return f&&Object.assign(d,f),d})(),...r?[m]:[]]:[!1,null]},Pl=({children:s,...t})=>{const a=Jt(),r=t.hook?mn:a;let n=r;const[i,o=t.ssrSearch??""]=t.ssrPath?.split("?")??[];i&&(t.ssrSearch=o,t.ssrPath=i),t.hrefs=t.hrefs??t.hook?.hrefs,t.searchHook=t.searchHook??t.hook?.searchHook;let m=l.useRef({}),h=m.current,f=h;for(let d in r){const y=d==="base"?r[d]+(t[d]??""):t[d]??r[d];h===f&&y!==f[d]&&(m.current=f={...f}),f[d]=y,(y!==r[d]||y!==n[d])&&(n=f)}return l.createElement(un.Provider,{value:n,children:s})},Ka=({children:s,component:t},a)=>t?l.createElement(t,{params:a}):typeof s=="function"?s(a):s,Tl=s=>{let t=l.useRef(xn);const a=t.current;return t.current=Object.keys(s).length!==Object.keys(a).length||Object.entries(s).some(([r,n])=>n!==a[r])?s:a},qt=({path:s,nest:t,match:a,...r})=>{const n=Jt(),[i]=us(n),[o,m,h]=a??pn(n.parser,s,i,t),f=Tl({...Sl(),...m});if(!o)return null;const d=h?l.createElement(Pl,{base:h},Ka(r,f)):Ka(r,f);return l.createElement(hn.Provider,{value:f,children:d})},Te=l.forwardRef((s,t)=>{const a=Jt(),[r,n]=us(a),{to:i="",href:o=i,onClick:m,asChild:h,children:f,className:d,replace:y,state:b,transition:N,...T}=s,E=Pa(G=>{G.ctrlKey||G.metaKey||G.altKey||G.shiftKey||G.button!==0||(m?.(G),G.defaultPrevented||(G.preventDefault(),n(o,s)))}),K=a.hrefs(o[0]==="~"?o.slice(1):a.base+o,a);return h&&l.isValidElement(f)?l.cloneElement(f,{onClick:E,href:K}):l.createElement("a",{...T,onClick:E,href:K,className:d?.call?d(r===o):d,children:f,ref:t})}),gn=s=>Array.isArray(s)?s.flatMap(t=>gn(t&&t.type===l.Fragment?t.props.children:t)):[s],Cl=({children:s,location:t})=>{const a=Jt(),[r]=us(a);for(const n of gn(s)){let i=0;if(l.isValidElement(n)&&(i=pn(a.parser,n.props.path,t||r,n.props.nest))[0])return l.cloneElement(n,{match:i})}return null},kl=s=>{const{to:t,href:a=t}=s,r=Jt(),[,n]=us(r),i=Pa(()=>n(t||a,s)),{ssrContext:o}=r;return on(()=>{i()},[]),o&&(o.redirectTo=t),null};async function fn(s){if(!s.ok){const t=await s.text()||s.statusText;let a=`${s.status}: ${t}`;try{const r=JSON.parse(t),n=r.error||r.message||t;n.includes("does not show solar panels")||n.includes("solar panels or photovoltaic equipment")?a="Please upload a solar panel image for fault detection. Rooftop images should be used for installation analysis instead.":n.includes("does not show a rooftop")||n.includes("rooftop suitable for solar panel installation")?a="Please upload a rooftop or building image for installation analysis. Solar panel images should be used for fault detection instead.":a=n}catch{}throw new Error(a)}}async function je(s,t,a){const r={},n=localStorage.getItem("sessionId");n&&(r["x-session-id"]=n);let i;a&&(a instanceof FormData?i=a:(r["Content-Type"]="application/json",i=JSON.stringify(a)));const o=await fetch(t,{method:s,headers:r,body:i,credentials:"include"});return await fn(o),o}const Il=({on401:s})=>async({queryKey:t})=>{const a={},r=localStorage.getItem("sessionId");r&&(a["x-session-id"]=r);const n=await fetch(t[0],{headers:a,credentials:"include"});return await fn(n),await n.json()},Al=new ui({defaultOptions:{queries:{queryFn:Il({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:300*1e3,gcTime:600*1e3,retry:1},mutations:{retry:1}}}),El=1,Dl=1e6;let Zs=0;function Ml(){return Zs=(Zs+1)%Number.MAX_SAFE_INTEGER,Zs.toString()}const ea=new Map,Qa=s=>{if(ea.has(s))return;const t=setTimeout(()=>{ea.delete(s),rs({type:"REMOVE_TOAST",toastId:s})},Dl);ea.set(s,t)},Ll=(s,t)=>{switch(t.type){case"ADD_TOAST":return{...s,toasts:[t.toast,...s.toasts].slice(0,El)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(a=>a.id===t.toast.id?{...a,...t.toast}:a)};case"DISMISS_TOAST":{const{toastId:a}=t;return a?Qa(a):s.toasts.forEach(r=>{Qa(r.id)}),{...s,toasts:s.toasts.map(r=>r.id===a||a===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return t.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(a=>a.id!==t.toastId)}}},Cs=[];let ks={toasts:[]};function rs(s){ks=Ll(ks,s),Cs.forEach(t=>{t(ks)})}function Fl({...s}){const t=Ml(),a=n=>rs({type:"UPDATE_TOAST",toast:{...n,id:t}}),r=()=>rs({type:"DISMISS_TOAST",toastId:t});return rs({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:n=>{n||r()}}}),{id:t,dismiss:r,update:a}}function Zt(){const[s,t]=l.useState(ks);return l.useEffect(()=>(Cs.push(t),()=>{const a=Cs.indexOf(t);a>-1&&Cs.splice(a,1)}),[s]),{...s,toast:Fl,dismiss:a=>rs({type:"DISMISS_TOAST",toastId:a})}}const bn=l.createContext(null);function Ol({children:s}){const{toast:t}=Zt(),a=ja(),[r,n]=l.useState(null),i=l.useCallback(async()=>{try{const N=(await fetch("/api/health")).ok?{status:"healthy",message:"Server is running"}:{status:"unhealthy",message:"Server returned error"};return n(N),N}catch{const b={status:"unhealthy",message:"Cannot connect to server"};return n(b),b}},[]);l.useEffect(()=>{i();const b=setInterval(i,300*1e3);return()=>clearInterval(b)},[i]);const{data:o,error:m,isLoading:h}=Ve({queryKey:["/api/user"],queryFn:async()=>{try{const b={},N=localStorage.getItem("sessionId");N&&(b["x-session-id"]=N);const T=await fetch("/api/user",{headers:b,credentials:"include"});return T.status===401?null:await T.json()}catch{return null}},retry:!1,staleTime:3e4,gcTime:6e4}),f=Se({mutationFn:async b=>{const N=await je("POST","/api/login",b);if(!N.ok){const T=await N.json();throw new Error(T.error||"Login failed")}return await N.json()},onSuccess:b=>{a.setQueryData(["/api/user"],b.user),b.sessionId&&localStorage.setItem("sessionId",b.sessionId),localStorage.removeItem("logoutSuccess")}}),d=Se({mutationFn:async b=>{const N=await je("POST","/api/register",b);if(!N.ok){const T=await N.json();throw new Error(T.error||"Registration failed")}return await N.json()},onSuccess:b=>{a.setQueryData(["/api/user"],b.user),b.sessionId&&localStorage.setItem("sessionId",b.sessionId)}}),y=Se({mutationFn:async()=>{await je("POST","/api/logout")},onSuccess:()=>{a.setQueryData(["/api/user"],null),a.clear(),localStorage.removeItem("authToken"),localStorage.removeItem("sessionId"),sessionStorage.clear(),localStorage.setItem("logoutSuccess","true"),window.location.href="/"},onError:()=>{t({title:"Logout failed",description:"Server is down. Please try again later.",variant:"destructive"})}});return e.jsx(bn.Provider,{value:{user:o??null,isLoading:h,error:m,loginMutation:f,logoutMutation:y,registerMutation:d,healthStatus:r,checkHealth:i},children:s})}function ct(){const s=l.useContext(bn);if(!s)throw new Error("useAuth must be used within an AuthProvider");return s}function ws({path:s,component:t}){const{user:a,isLoading:r}=ct();return r?e.jsx(qt,{path:s,children:e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(gt,{className:"h-8 w-8 animate-spin text-border"})})}):a?e.jsx(qt,{path:s,component:t}):e.jsx(qt,{path:s,children:e.jsx(kl,{to:"/login"})})}function A(...s){return Ai(Ei(s))}function vt(s){return isNaN(s)||!isFinite(s)?"₹0":`₹${parseFloat(s.toFixed(2))}`}function Fs(s){return isNaN(s)||!isFinite(s)?"0 kWh":`${parseFloat(s.toFixed(1))} kWh`}function St(s,t){if(isNaN(s)||!isFinite(s)||isNaN(t)||!isFinite(t))return"₹0";const a=s*t;return`₹${parseFloat(a.toFixed(2))}`}function yn(s){return isNaN(s)||!isFinite(s)?"0 kg CO2":`${parseFloat(s.toFixed(1))} kg CO2`}function Rl(s){return isNaN(s)||!isFinite(s)?"0 kWh":`${parseFloat(s.toFixed(1))} kWh`}const D=l.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:A("rounded-lg border bg-card text-card-foreground shadow-sm",s),...t}));D.displayName="Card";const se=l.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:A("flex flex-col space-y-1.5 p-6",s),...t}));se.displayName="CardHeader";const le=l.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:A("text-2xl font-semibold leading-none tracking-tight",s),...t}));le.displayName="CardTitle";const ka=l.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:A("text-sm text-muted-foreground",s),...t}));ka.displayName="CardDescription";const U=l.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:A("p-6 pt-0",s),...t}));U.displayName="CardContent";const xa=l.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:A("flex items-center p-6 pt-0",s),...t}));xa.displayName="CardFooter";const _l=Gt("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground ",destructive:"bg-destructive text-destructive-foreground",outline:"border border-input bg-background",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),w=l.forwardRef(({className:s,variant:t,size:a,asChild:r=!1,...n},i)=>{const o=r?gr:"button";return e.jsx(o,{className:A(_l({variant:t,size:a,className:s})),ref:i,...n})});w.displayName="Button";const ht=yr,Bl=jr,zl=fr,jn=l.forwardRef(({className:s,...t},a)=>e.jsx(zs,{ref:a,className:A("fixed inset-0 z-50 bg-slate-900/85 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t}));jn.displayName=zs.displayName;const nt=l.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(zl,{children:[e.jsx(jn,{}),e.jsxs(qs,{ref:r,className:A("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...a,children:[t,e.jsxs(br,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));nt.displayName=qs.displayName;const pt=({className:s,...t})=>e.jsx("div",{className:A("flex flex-col space-y-1.5 text-center sm:text-left",s),...t});pt.displayName="DialogHeader";const it=l.forwardRef(({className:s,...t},a)=>e.jsx($s,{ref:a,className:A("text-lg font-semibold leading-none tracking-tight",s),...t}));it.displayName=$s.displayName;const Hs=l.forwardRef(({className:s,...t},a)=>e.jsx(Vs,{ref:a,className:A("text-sm text-muted-foreground",s),...t}));Hs.displayName=Vs.displayName;const ql=Gt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ce=l.forwardRef(({className:s,...t},a)=>e.jsx(wr,{ref:a,className:A(ql(),s),...t}));Ce.displayName=wr.displayName;const Os=el,wn=l.createContext({}),We=({...s})=>e.jsx(wn.Provider,{value:{name:s.name},children:e.jsx(tn,{...s})}),Us=()=>{const s=l.useContext(wn),t=l.useContext(Nn),{getFieldState:a,formState:r}=Zi(),n=a(s.name,r);if(!s)throw new Error("useFormField should be used within <FormField>");const{id:i}=t;return{id:i,name:s.name,formItemId:`${i}-form-item`,formDescriptionId:`${i}-form-item-description`,formMessageId:`${i}-form-item-message`,...n}},Nn=l.createContext({}),Re=l.forwardRef(({className:s,...t},a)=>{const r=l.useId();return e.jsx(Nn.Provider,{value:{id:r},children:e.jsx("div",{ref:a,className:A("space-y-2",s),...t})})});Re.displayName="FormItem";const _e=l.forwardRef(({className:s,...t},a)=>{const{error:r,formItemId:n}=Us();return e.jsx(Ce,{ref:a,className:A(r&&"text-destructive",s),htmlFor:n,...t})});_e.displayName="FormLabel";const Qe=l.forwardRef(({...s},t)=>{const{error:a,formItemId:r,formDescriptionId:n,formMessageId:i}=Us();return e.jsx(gr,{ref:t,id:r,"aria-describedby":a?`${n} ${i}`:`${n}`,"aria-invalid":!!a,...s})});Qe.displayName="FormControl";const $l=l.forwardRef(({className:s,...t},a)=>{const{formDescriptionId:r}=Us();return e.jsx("p",{ref:a,id:r,className:A("text-sm text-muted-foreground",s),...t})});$l.displayName="FormDescription";const Be=l.forwardRef(({className:s,children:t,...a},r)=>{const{error:n,formMessageId:i}=Us(),o=n?String(n?.message??""):t;return o?e.jsx("p",{ref:r,id:i,className:A("text-sm font-medium text-destructive",s),...a,children:o}):null});Be.displayName="FormMessage";const te=l.forwardRef(({className:s,type:t,...a},r)=>e.jsx("input",{type:t,className:A("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:r,...a}));te.displayName="Input";const ls=wi,os=Ni,Kt=l.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(Nr,{ref:r,className:A("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...a,children:[t,e.jsx(gi,{asChild:!0,children:e.jsx(wa,{className:"h-4 w-4 opacity-50"})})]}));Kt.displayName=Nr.displayName;const vn=l.forwardRef(({className:s,...t},a)=>e.jsx(vr,{ref:a,className:A("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(Di,{className:"h-4 w-4"})}));vn.displayName=vr.displayName;const Sn=l.forwardRef(({className:s,...t},a)=>e.jsx(Sr,{ref:a,className:A("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(wa,{className:"h-4 w-4"})}));Sn.displayName=Sr.displayName;const Qt=l.forwardRef(({className:s,children:t,position:a="popper",...r},n)=>e.jsx(fi,{children:e.jsxs(Pr,{ref:n,className:A("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:a,...r,children:[e.jsx(vn,{}),e.jsx(bi,{className:A("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(Sn,{})]})}));Qt.displayName=Pr.displayName;const Vl=l.forwardRef(({className:s,...t},a)=>e.jsx(Tr,{ref:a,className:A("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...t}));Vl.displayName=Tr.displayName;const Pe=l.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(Cr,{ref:r,className:A("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(yi,{children:e.jsx(Na,{className:"h-4 w-4"})})}),e.jsx(ji,{children:t})]}));Pe.displayName=Cr.displayName;const Wl=l.forwardRef(({className:s,...t},a)=>e.jsx(kr,{ref:a,className:A("-mx-1 my-1 h-px bg-muted",s),...t}));Wl.displayName=kr.displayName;var Hl=function(s,t){for(var a={};s.length;){var r=s[0],n=r.code,i=r.message,o=r.path.join(".");if(!a[o])if("unionErrors"in r){var m=r.unionErrors[0].errors[0];a[o]={message:m.message,type:m.code}}else a[o]={message:i,type:n};if("unionErrors"in r&&r.unionErrors.forEach(function(d){return d.errors.forEach(function(y){return s.push(y)})}),t){var h=a[o].types,f=h&&h[r.code];a[o]=al(o,t,a,n,f?[].concat(f,r.message):r.message)}s.shift()}return a},Yt=function(s,t,a){return a===void 0&&(a={}),function(r,n,i){try{return Promise.resolve((function(o,m){try{var h=Promise.resolve(s[a.mode==="sync"?"parse":"parseAsync"](r,t)).then(function(f){return i.shouldUseNativeValidation&&tl({},i),{errors:{},values:a.raw?r:f}})}catch(f){return m(f)}return h&&h.then?h.then(void 0,m):h})(0,function(o){if((function(m){return Array.isArray(m?.errors)})(o))return{values:{},errors:sl(Hl(o.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw o}))}catch(o){return Promise.reject(o)}}};const Ia=l.forwardRef(({className:s,children:t,...a},r)=>e.jsxs(Ir,{ref:r,className:A("relative overflow-hidden",s),...a,children:[e.jsx(vi,{className:"h-full w-full rounded-[inherit]",children:t}),e.jsx(Pn,{}),e.jsx(Si,{})]}));Ia.displayName=Ir.displayName;const Pn=l.forwardRef(({className:s,orientation:t="vertical",...a},r)=>e.jsx(Ar,{ref:r,orientation:t,className:A("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...a,children:e.jsx(Pi,{className:"relative flex-1 rounded-full bg-border"})}));Pn.displayName=Ar.displayName;const Ya="/assets/robot-chat-bot-concept-illustration-vector_1752050227392.jpg";function Tn(){const{user:s}=ct(),[t,a]=l.useState(()=>{if(typeof window<"u"){const P=s?`chatOpen_${s.id}`:"chatOpen_guest";return localStorage.getItem(P)==="true"}return!1}),[r,n]=l.useState(()=>{if(typeof window<"u"){const P=s?`chatMessages_${s.id}`:"chatMessages_guest",v=localStorage.getItem(P);if(v)try{return JSON.parse(v).map(I=>({...I,timestamp:new Date(I.timestamp)}))}catch(I){console.error("Error parsing saved messages:",I)}}return[{id:1,message:"Hello! I'm your SolarSense AI assistant ready to help with energy trading and optimization. Ask about energy flow, trading strategies, or grid management.",sender:"ai",timestamp:new Date}]}),[i,o]=l.useState(""),[m,h]=l.useState(!1),[f,d]=l.useState(!1),[y,b]=l.useState(null),[N,T]=l.useState(null),[E,K]=l.useState({}),[G,fe]=l.useState(!1),[z,B]=l.useState(!1),[be,j]=l.useState(null),[M,C]=l.useState(!0),[Q,R]=l.useState(0),[W,ae]=l.useState(!1),Ae=l.useRef(null),Ne=l.useRef(null),J=l.useRef(null),ee=l.useRef(null),qe=l.useRef(null),de=l.useRef(null);l.useEffect(()=>{const P=s?`chatOpen_${s.id}`:"chatOpen_guest";localStorage.setItem(P,t.toString())},[t,s]),l.useEffect(()=>{const P=s?`chatMessages_${s.id}`:"chatMessages_guest";localStorage.setItem(P,JSON.stringify(r))},[r,s]),l.useEffect(()=>{if(s){const P=`chatMessages_${s.id}`,v=localStorage.getItem(P);if(v)try{const I=JSON.parse(v).map(L=>({...L,timestamp:new Date(L.timestamp)}));n(I)}catch(I){console.error("Error loading user chat messages:",I)}}else n([{id:1,message:"Hello! I'm your AI assistant. How can I help you with solar panel analysis today?",sender:"ai",timestamp:new Date}])},[s]),l.useEffect(()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const P=window.SpeechRecognition||window.webkitSpeechRecognition,v=new P;v.continuous=!1,v.interimResults=!1,v.lang="en-US",v.onresult=I=>{const L=I.results[0][0].transcript;o(L),d(!1)},v.onerror=()=>{d(!1)},v.onend=()=>{d(!1)},b(v)}},[]),l.useEffect(()=>{const P=v=>{Ne.current&&!Ne.current.contains(v.target)&&J.current&&!J.current.contains(v.target)&&a(!1)};return t&&document.addEventListener("mousedown",P),()=>{document.removeEventListener("mousedown",P)}},[t]),l.useEffect(()=>{const P=()=>{N&&(ae(!0),C(!1),H())},v=I=>{I.deltaY<0&&N&&(ae(!0),C(!1),H())};if(ee.current&&t){const I=ee.current.querySelector("[data-radix-scroll-area-viewport]");if(I)return I.addEventListener("touchstart",P,{passive:!0}),I.addEventListener("wheel",v,{passive:!0}),()=>{I.removeEventListener("touchstart",P),I.removeEventListener("wheel",v)}}},[t,N]),l.useEffect(()=>()=>{qe.current&&clearTimeout(qe.current),de.current&&clearInterval(de.current)},[]);const Ee=(P=!0)=>{if(ee.current){const v=ee.current.querySelector("[data-radix-scroll-area-viewport]");v&&v.scrollTo({top:v.scrollHeight,behavior:P?"smooth":"auto"})}},Je=()=>{if(ee.current){const P=ee.current.querySelector("[data-radix-scroll-area-viewport]");if(P){const{scrollTop:v,scrollHeight:I,clientHeight:L}=P,me=v+L>=I-50;v-Q<-2&&(ae(!0),C(!1),H()),me&&!N&&(C(!0),ae(!1)),R(v)}}};l.useEffect(()=>{if(M){const P=setTimeout(()=>{Ee(!0)},50);return()=>clearTimeout(P)}},[r,M,E]);const H=()=>{de.current&&(clearInterval(de.current),de.current=null)};l.useEffect(()=>{if(N&&M&&!W)return H(),de.current=setInterval(()=>{M&&!W&&N?Ee(!0):H()},100),()=>H();H()},[N,M,W]),l.useEffect(()=>{N&&(C(!0),ae(!1),R(0))},[N]);const He=()=>{qe.current&&clearTimeout(qe.current),T(null),fe(!1),B(!1)},De=(P,v)=>{T(P),fe(!0),B(!0),K(me=>({...me,[P]:""})),C(!0),ae(!1);let I=0;const L=()=>{I<v.length?(K(me=>({...me,[P]:v.substring(0,I+1)})),I++,qe.current=setTimeout(L,8)):(T(null),fe(!1),B(!1))};L()},he=(P,v)=>{const I=P.replace(/\*\*(.*?)\*\*/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/`(.*?)`/g,"$1").replace(/^#+\s/gm,"").replace(/^\-\s/gm,"• ");navigator.clipboard.writeText(I).then(()=>{j(v),setTimeout(()=>j(null),2e3)}).catch(()=>{const L=document.createElement("textarea");L.value=I,document.body.appendChild(L),L.select(),document.execCommand("copy"),document.body.removeChild(L),j(v),setTimeout(()=>j(null),2e3)})},x=async()=>{if(!i.trim())return;const P={id:r.length+1,message:i,sender:"user",timestamp:new Date};n(v=>[...v,P]),o(""),h(!0);try{const I=await(await je("POST","/api/ai/chat",{message:i})).json();let L="";if(I.error)I.error.includes("503")||I.error.includes("overloaded")||I.error.includes("UNAVAILABLE")?L="I'm currently experiencing high demand. Please wait a moment and try again. The AI service is temporarily overloaded.":L=`I apologize, but I'm experiencing some technical difficulties: ${I.error}`;else if(typeof I=="string")try{L=JSON.parse(I).response||I}catch{L=I}else L=I.response||I.message||"I'm sorry, I couldn't process your request right now.";const me={id:r.length+2,message:L,sender:"ai",timestamp:new Date};n(Me=>[...Me,me]),C(!0),ae(!1),De(me.id,L)}catch(v){console.error("AI Chat error:",v);let I="I'm experiencing connection issues. Please check your internet connection and try again.";v instanceof Error&&(v.message.includes("503")||v.message.includes("overloaded")?I="The AI service is currently experiencing high demand. Please wait a few minutes and try again.":v.message.includes("timeout")?I="The request timed out. Please try again with a shorter message.":v.message.includes("network")&&(I="Network connection failed. Please check your internet connection and try again."));const L={id:r.length+2,message:I,sender:"ai",timestamp:new Date};n(me=>[...me,L]),C(!0),ae(!1),De(L.id,I)}finally{h(!1)}},p=()=>{a(!1),localStorage.removeItem("chatOpen")},k=()=>{localStorage.removeItem("chatMessages"),n([{id:1,message:"Hello! I'm your AI assistant. How can I help you with solar panel analysis today?",sender:"ai",timestamp:new Date}]),o(""),T(null),fe(!1),K({})},q=P=>{P.key==="Enter"&&x()},_=()=>{y&&(f?(y.stop(),d(!1)):(y.start(),d(!0)))};return e.jsxs("div",{className:"fixed bottom-4 right-4 z-[9999]",children:[e.jsx("button",{ref:J,onClick:()=>a(!t),className:"flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 md:w-14 md:h-14 bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-700 hover:to-blue-600 rounded-full shadow-lg transition-all duration-300 border-2 border-slate-300/20 cursor-pointer hover:scale-105 touch-manipulation","aria-label":t?"Close AI Chat":"Open AI Chat",children:e.jsx("img",{src:Ya,alt:"AI Robot",className:"w-6 h-6 sm:w-8 sm:h-8 md:w-10 md:h-10 rounded-full object-cover"})}),t&&e.jsx("div",{className:"absolute bottom-16 right-0 mb-2",ref:Ne,children:e.jsxs(D,{className:"w-[calc(100vw-2rem)] max-w-xs sm:max-w-sm md:max-w-md lg:max-w-lg transition-all duration-300 h-[60vh] sm:h-[70vh] max-h-80 sm:max-h-96 md:max-h-[500px] shadow-2xl drop-shadow-lg rounded-lg bg-slate-900/95 backdrop-blur-sm border border-slate-700/50",children:[e.jsxs(se,{className:"flex flex-row items-center justify-between p-3 sm:p-4 bg-gradient-to-r from-blue-600 to-blue-500 text-white rounded-t-lg border-b border-slate-700/50",children:[e.jsxs(le,{className:"text-sm sm:text-base font-medium flex items-center",children:[e.jsx("img",{src:Ya,alt:"AI Robot",className:"w-5 h-5 sm:w-6 sm:h-6 rounded-full object-cover mr-2"}),"AI Assistant"]}),e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[e.jsxs(w,{variant:"ghost",size:"sm",onClick:k,className:"h-7 w-auto px-2 sm:h-8 sm:px-3 hover:bg-white/20 text-xs rounded-md border border-white/20",title:"Start new conversation",children:[e.jsx(Ws,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1"}),e.jsx("span",{className:"text-[10px] sm:text-xs font-medium",children:"New Chat"})]}),e.jsx(w,{variant:"ghost",size:"sm",onClick:p,className:"h-6 w-6 sm:h-7 sm:w-7 p-0 hover:bg-white/20 border border-white/20 rounded",children:e.jsx(ce,{className:"h-3 w-3 sm:h-4 sm:w-4"})})]})]}),e.jsxs(U,{className:"p-0 flex flex-col h-[calc(100%-3rem)]",children:[e.jsx(Ia,{ref:ee,className:"flex-1 p-3 sm:p-4 pb-0",onScroll:Je,children:e.jsxs("div",{className:"space-y-3 sm:space-y-4 pb-3 sm:pb-4",children:[r.map(P=>e.jsx("div",{className:`flex ${P.sender==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[85%] ${P.sender==="user"?"ml-auto":"mr-auto"}`,children:[e.jsx("div",{className:`px-3 py-2 sm:px-4 sm:py-3 rounded-lg text-sm sm:text-base ${P.sender==="user"?"bg-blue-600 text-white shadow-md":"bg-slate-800/80 text-slate-100 border border-slate-700/50"}`,children:P.sender==="ai"?e.jsxs("div",{children:[e.jsx(nn,{remarkPlugins:[ln],components:{p:({children:v})=>e.jsx("p",{className:"mb-2 last:mb-0",children:v}),ul:({children:v})=>e.jsx("ul",{className:"mb-2 last:mb-0 ml-4 list-disc",children:v}),ol:({children:v})=>e.jsx("ol",{className:"mb-2 last:mb-0 ml-4 list-decimal",children:v}),li:({children:v})=>e.jsx("li",{className:"mb-1",children:v}),strong:({children:v})=>e.jsx("strong",{className:"font-semibold",children:v}),em:({children:v})=>e.jsx("em",{className:"italic",children:v}),code:({children:v,className:I})=>!I?.includes("language-")?e.jsx("code",{className:"bg-slate-700/60 px-1 py-0.5 rounded text-xs font-mono text-slate-200",children:v}):e.jsx("pre",{className:"bg-slate-700/60 p-2 rounded text-xs font-mono overflow-x-auto mb-2 text-slate-200",children:e.jsx("code",{children:v})}),blockquote:({children:v})=>e.jsx("blockquote",{className:"border-l-4 border-blue-500 pl-3 italic mb-2",children:v}),hr:()=>e.jsx("hr",{className:"my-2 border-slate-600"})},children:N===P.id?E[P.id]||"":P.message}),N===P.id&&e.jsx("span",{className:"inline-block w-2 h-4 bg-blue-500 animate-pulse ml-1 rounded-sm"})]}):e.jsx("div",{className:"whitespace-pre-wrap",children:P.message})}),P.sender==="ai"&&N!==P.id&&e.jsx("div",{className:"flex justify-end mt-2",children:e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>he(P.message,P.id),className:"h-6 w-6 p-0 hover:bg-slate-700/60 opacity-70 hover:opacity-100 transition-opacity rounded-md border border-slate-600/30",title:be===P.id?"Copied!":"Copy message",children:e.jsx(Hr,{className:`h-3 w-3 ${be===P.id?"text-green-400":"text-slate-400"}`})})})]})},P.id)),m&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-slate-800/80 text-slate-100 px-3 py-2 sm:px-4 sm:py-3 rounded-lg text-sm sm:text-base border border-slate-700/50",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce"}),e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})}),e.jsx("div",{ref:Ae})]})}),e.jsx("div",{className:"p-3 sm:p-4 border-t border-slate-700/50 bg-slate-800/60 backdrop-blur-sm rounded-b-lg",children:e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[e.jsx(te,{type:"text",placeholder:f?"Listening...":"Ask about solar panels...",value:i,onChange:P=>o(P.target.value),onKeyPress:q,className:"flex-1 text-sm sm:text-base h-9 sm:h-10 bg-slate-900/60 border-slate-600/50 text-slate-100 placeholder-slate-400",disabled:m||f}),y&&e.jsx(w,{size:"sm",onClick:_,disabled:m,className:`h-9 w-9 sm:h-10 sm:w-10 p-0 ${f?"bg-red-500 hover:bg-red-600":"bg-slate-600 hover:bg-slate-500"}`,children:f?e.jsx(Ur,{className:"h-3 w-3 sm:h-4 sm:w-4"}):e.jsx(Kr,{className:"h-3 w-3 sm:h-4 sm:w-4"})}),z||G?e.jsx(w,{size:"sm",onClick:He,className:"bg-red-500 hover:bg-red-600 h-9 w-9 sm:h-10 sm:w-10 p-0",title:"Stop AI response",children:e.jsx(As,{className:"h-3 w-3 sm:h-4 sm:w-4"})}):e.jsx(w,{size:"sm",onClick:x,disabled:!i.trim()||m||f,className:"bg-blue-600 hover:bg-blue-700 h-9 w-9 sm:h-10 sm:w-10 p-0",children:e.jsx(Qr,{className:"h-3 w-3 sm:h-4 sm:w-4"})})]})})]})]})})]})}const Ul=yr,Kl=jr,Ql=fr,Cn=l.forwardRef(({className:s,...t},a)=>e.jsx(zs,{className:A("fixed inset-0 z-[10000] bg-slate-900/85  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t,ref:a}));Cn.displayName=zs.displayName;const Yl=Gt("fixed z-[10001] gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),kn=l.forwardRef(({side:s="right",className:t,children:a,...r},n)=>e.jsxs(Ql,{children:[e.jsx(Cn,{}),e.jsxs(qs,{ref:n,className:A(Yl({side:s}),t),...r,children:[a,e.jsxs(br,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));kn.displayName=qs.displayName;const In=l.forwardRef(({className:s,...t},a)=>e.jsx($s,{ref:a,className:A("text-lg font-semibold text-foreground",s),...t}));In.displayName=$s.displayName;const An=l.forwardRef(({className:s,...t},a)=>e.jsx(Vs,{ref:a,className:A("text-sm text-muted-foreground",s),...t}));An.displayName=Vs.displayName;function Tt({currentPage:s,activeTab:t,onTabChange:a}){const{user:r,logoutMutation:n}=ct(),[i,o]=l.useState(!1);return e.jsx("header",{className:"bg-gradient-to-r from-slate-900/95 via-slate-800/95 to-slate-900/95 backdrop-blur-md border-b border-slate-700/50 shadow-xl shadow-slate-900/20 fixed top-0 left-0 right-0 z-50",children:e.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 md:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsx(Te,{href:"/",children:e.jsxs("div",{className:"flex items-center space-x-2 cursor-pointer transition-all duration-300 ease-in-out transform hover:scale-105",children:[e.jsx("div",{className:"p-1.5 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full",children:e.jsx(ft,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),e.jsx("span",{className:"text-lg sm:text-xl font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent",children:"SolarSense"})]})}),e.jsxs("nav",{className:"hidden md:flex items-center space-x-6 lg:space-x-8",children:[s==="dashboard"?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>a?.("energy-dashboard"),className:`transition-all duration-300 ease-in-out transform hover:scale-105 ${t==="energy-dashboard"?"text-primary font-medium":"text-secondary-custom hover:text-primary"}`,children:"Energy Dashboard"}),e.jsx("button",{onClick:()=>a?.("energy-trading"),className:`transition-all duration-300 ease-in-out transform hover:scale-105 ${t==="energy-trading"?"text-primary font-medium":"text-secondary-custom hover:text-primary"}`,children:"Energy Trading"}),e.jsx("button",{onClick:()=>a?.("simulation"),className:`transition-all duration-300 ease-in-out transform hover:scale-105 ${t==="simulation"?"text-primary font-medium":"text-secondary-custom hover:text-primary"}`,children:"Simulation"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Te,{href:"/?tab=energy-dashboard",children:e.jsx("button",{className:"text-secondary-custom hover:text-primary transition-all duration-300 ease-in-out transform hover:scale-105",children:"Energy Dashboard"})}),e.jsx(Te,{href:"/?tab=energy-trading",children:e.jsx("button",{className:"text-secondary-custom hover:text-primary transition-all duration-300 ease-in-out transform hover:scale-105",children:"Energy Trading"})}),e.jsx(Te,{href:"/?tab=simulation",children:e.jsx("button",{className:"text-secondary-custom hover:text-primary transition-all duration-300 ease-in-out transform hover:scale-105",children:"Simulation"})})]}),r&&e.jsx(Te,{href:"/storage",children:e.jsx("button",{className:`transition-all duration-300 ease-in-out transform hover:scale-105 ${s==="storage"?"text-primary font-medium":"text-secondary-custom hover:text-primary"}`,children:"Storage"})}),e.jsx(Te,{href:"/about",children:e.jsx("button",{className:`transition-all duration-300 ease-in-out transform hover:scale-105 ${s==="about"?"text-primary font-medium":"text-secondary-custom hover:text-primary"}`,children:"About"})}),r?e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>n.mutate(),className:"flex items-center gap-2 bg-card hover:bg-destructive/10 text-red-500 border-red-500/20 hover:border-red-500/30 transition-all duration-300 ease-in-out transform active:scale-95",children:[e.jsx(_a,{size:16}),"Logout"]}):e.jsx(Te,{href:"/login",children:e.jsx("button",{className:"bg-primary text-white px-4 py-2 rounded-lg transition-all duration-300 ease-in-out transform hover:scale-105",children:"Login"})})]}),e.jsx("div",{className:"md:hidden",children:e.jsxs(Ul,{open:i,onOpenChange:o,children:[e.jsx(Kl,{asChild:!0,children:e.jsxs(w,{variant:"outline",size:"icon",className:"bg-slate-800/50 hover:bg-blue-600/20 text-gray-300 hover:text-blue-400 border-slate-600/50 hover:border-blue-400/60 active:scale-95 transition-all duration-300 ease-in-out backdrop-blur-sm shadow-lg",children:[e.jsx(Mi,{className:"h-5 w-5"}),e.jsx("span",{className:"sr-only",children:"Toggle menu"})]})}),e.jsxs(kn,{side:"right",className:"w-[280px] sm:w-[300px] lg:w-[350px] p-0 overflow-y-auto bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 border-l border-slate-700/50 shadow-2xl backdrop-blur-xl",children:[e.jsx(In,{className:"sr-only",children:"Navigation Menu"}),e.jsx(An,{className:"sr-only",children:"Main navigation menu for SolarSense"}),e.jsxs("nav",{className:"flex flex-col space-y-3 sm:space-y-4 lg:space-y-6 p-3 sm:p-4 lg:p-6 mt-3 sm:mt-4 lg:mt-8",children:[e.jsxs("div",{className:"flex flex-col space-y-3 sm:space-y-4",children:[e.jsx("h3",{className:"font-semibold text-base sm:text-lg bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent px-1",children:"Energy Platform"}),s==="dashboard"&&a?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{a("energy-dashboard"),window.history.pushState({},"","/?tab=energy-dashboard"),o(!1),window.scrollTo({top:0,behavior:"smooth"})},className:`flex items-center space-x-2 sm:space-x-3 px-3 sm:px-4 py-2 sm:py-2.5 rounded-lg transition-all duration-300 ease-in-out transform hover:scale-105 text-xs sm:text-sm md:text-base touch-manipulation ${t==="energy-dashboard"?"bg-gradient-to-r from-blue-600 to-cyan-600 text-white shadow-lg":"text-gray-300 hover:bg-slate-800/60 hover:text-blue-400 backdrop-blur-sm border border-transparent hover:border-blue-500/30"}`,children:[e.jsx(Bt,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{children:"Energy Dashboard"})]}),e.jsxs("button",{onClick:()=>{a("energy-trading"),window.history.pushState({},"","/?tab=energy-trading"),o(!1),window.scrollTo({top:0,behavior:"smooth"})},className:`flex items-center space-x-2 sm:space-x-3 px-3 sm:px-4 py-2 sm:py-2.5 rounded-lg transition-all duration-300 ease-in-out transform hover:scale-105 text-xs sm:text-sm md:text-base touch-manipulation ${t==="energy-trading"?"bg-gradient-to-r from-blue-600 to-cyan-600 text-white shadow-lg":"text-gray-300 hover:bg-slate-800/60 hover:text-blue-400 backdrop-blur-sm border border-transparent hover:border-blue-500/30"}`,children:[e.jsx(rt,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{children:"Energy Trading"})]}),e.jsxs("button",{onClick:()=>{a("simulation"),window.history.pushState({},"","/?tab=simulation"),o(!1),window.scrollTo({top:0,behavior:"smooth"})},className:`flex items-center space-x-2 sm:space-x-3 px-3 sm:px-4 py-2 sm:py-2.5 rounded-lg transition-all duration-300 ease-in-out transform hover:scale-105 text-xs sm:text-sm md:text-base touch-manipulation ${t==="simulation"?"bg-gradient-to-r from-blue-600 to-cyan-600 text-white shadow-lg":"text-gray-300 hover:bg-slate-800/60 hover:text-blue-400 backdrop-blur-sm border border-transparent hover:border-blue-500/30"}`,children:[e.jsx(st,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{children:"Simulation Lab"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Te,{href:"/?tab=energy-dashboard",children:e.jsxs(w,{variant:"outline",className:"w-full justify-start space-x-2 sm:space-x-3 text-xs sm:text-sm md:text-base py-2 sm:py-2.5 transition-all duration-300 ease-in-out transform hover:scale-105 touch-manipulation bg-slate-800/40 hover:bg-slate-700/60 text-gray-300 hover:text-blue-400 border-slate-600/50 hover:border-blue-500/50 backdrop-blur-sm",onClick:()=>o(!1),children:[e.jsx(Bt,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{children:"Energy Dashboard"})]})}),e.jsx(Te,{href:"/?tab=energy-trading",children:e.jsxs(w,{variant:"outline",className:"w-full justify-start space-x-2 sm:space-x-3 text-xs sm:text-sm md:text-base py-2 sm:py-2.5 transition-all duration-300 ease-in-out transform hover:scale-105 touch-manipulation bg-slate-800/40 hover:bg-slate-700/60 text-gray-300 hover:text-blue-400 border-slate-600/50 hover:border-blue-500/50 backdrop-blur-sm",onClick:()=>o(!1),children:[e.jsx(rt,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{children:"Energy Trading"})]})}),e.jsx(Te,{href:"/?tab=simulation",children:e.jsxs(w,{variant:"outline",className:"w-full justify-start space-x-2 sm:space-x-3 text-xs sm:text-sm md:text-base py-2 sm:py-2.5 transition-all duration-300 ease-in-out transform hover:scale-105 touch-manipulation bg-slate-800/40 hover:bg-slate-700/60 text-gray-300 hover:text-blue-400 border-slate-600/50 hover:border-blue-500/50 backdrop-blur-sm",onClick:()=>o(!1),children:[e.jsx(st,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{children:"Simulation Lab"})]})})]})]}),r&&e.jsxs("div",{className:"flex flex-col space-y-3 sm:space-y-4",children:[e.jsx("h3",{className:"font-semibold text-base sm:text-lg bg-gradient-to-r from-green-400 to-emerald-400 bg-clip-text text-transparent px-1",children:"Data Management"}),e.jsx(Te,{href:"/storage",children:e.jsxs(w,{variant:s==="storage"?"default":"outline",className:`w-full justify-start space-x-2 sm:space-x-3 text-xs sm:text-sm md:text-base py-2 sm:py-2.5 transition-all duration-300 ease-in-out transform hover:scale-105 touch-manipulation ${s==="storage"?"bg-gradient-to-r from-green-600 to-emerald-600 text-white shadow-lg":"bg-slate-800/40 hover:bg-slate-700/60 text-gray-300 hover:text-green-400 border-slate-600/50 hover:border-green-500/50 backdrop-blur-sm"}`,onClick:()=>o(!1),children:[e.jsx(Yr,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{children:"Storage"})]})})]}),e.jsxs("div",{className:"flex flex-col space-y-3 sm:space-y-4",children:[e.jsx("h3",{className:"font-semibold text-base sm:text-lg bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent px-1",children:"Information"}),e.jsx(Te,{href:"/about",children:e.jsxs(w,{variant:s==="about"?"default":"outline",className:`w-full justify-start space-x-2 sm:space-x-3 text-xs sm:text-sm md:text-base py-2 sm:py-2.5 transition-all duration-300 ease-in-out transform hover:scale-105 touch-manipulation ${s==="about"?"bg-gradient-to-r from-purple-600 to-pink-600 text-white shadow-lg":"bg-slate-800/40 hover:bg-slate-700/60 text-gray-300 hover:text-purple-400 border-slate-600/50 hover:border-purple-500/50 backdrop-blur-sm"}`,onClick:()=>o(!1),children:[e.jsx(Gr,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{children:"About"})]})})]}),e.jsxs("div",{className:"flex flex-col space-y-3 sm:space-y-4",children:[e.jsx("h3",{className:"font-semibold text-base sm:text-lg bg-gradient-to-r from-amber-400 to-orange-400 bg-clip-text text-transparent px-1",children:"Account"}),r?e.jsxs(w,{variant:"outline",className:"w-full justify-start space-x-2 sm:space-x-3 text-xs sm:text-sm md:text-base py-2 sm:py-2.5 bg-slate-800/40 hover:bg-red-900/30 text-red-400 border-red-500/30 hover:border-red-400/60 transition-all duration-300 ease-in-out transform active:scale-95 touch-manipulation backdrop-blur-sm hover:shadow-lg",onClick:()=>{n.mutate(),o(!1)},children:[e.jsx(_a,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{children:"Logout"})]}):e.jsx(Te,{href:"/login",children:e.jsxs(w,{className:"w-full justify-start space-x-2 sm:space-x-3 text-xs sm:text-sm md:text-base py-2 sm:py-2.5 transition-all duration-300 ease-in-out transform hover:scale-105 touch-manipulation bg-gradient-to-r from-amber-600 to-orange-600 hover:from-amber-700 hover:to-orange-700 text-white shadow-lg",onClick:()=>o(!1),children:[e.jsx(bt,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{children:"Login"})]})})]})]})]})]})})]})})})}function Aa({type:s,title:t,description:a,className:r,onClose:n}){const i=()=>{switch(s){case"validating":return e.jsx(gt,{className:"h-5 w-5 animate-spin text-blue-600"});case"success":return e.jsx(ie,{className:"h-5 w-5 text-green-600"});case"error":return e.jsx(Li,{className:"h-5 w-5 text-red-600"});case"warning":return e.jsx(Xt,{className:"h-5 w-5 text-blue-600"});case"info":return e.jsx(Es,{className:"h-5 w-5 text-blue-600"});default:return e.jsx(Es,{className:"h-5 w-5 text-blue-600"})}},o=()=>{switch(s){case"validating":return"bg-white border-blue-200 shadow-lg";case"success":return"bg-white border-green-200 shadow-lg";case"error":return"bg-white border-red-200 shadow-lg";case"warning":return"bg-white border-blue-200 shadow-lg";case"info":return"bg-white border-blue-200 shadow-lg";default:return"bg-white border-gray-200 shadow-lg"}},m=()=>{switch(s){case"validating":return"text-blue-700";case"success":return"text-green-700";case"error":return"text-red-700";case"warning":return"text-blue-700";case"info":return"text-blue-700";default:return"text-gray-700"}},h=()=>{switch(s){case"success":return{x:100};case"error":return{x:100};case"warning":return{x:100};case"info":return{x:100};case"validating":return{x:100};default:return{x:100}}},f=()=>{switch(s){case"success":return"top-4 right-2 sm:right-4 md:right-6";case"error":return"top-4 right-2 sm:right-4 md:right-6";case"warning":return"top-4 right-2 sm:right-4 md:right-6";case"info":return"top-4 right-2 sm:right-4 md:right-6";case"validating":return"top-4 right-2 sm:right-4 md:right-6";default:return"top-4 right-2 sm:right-4 md:right-6"}};return e.jsx(ye.div,{initial:{opacity:0,...h()},animate:{opacity:1,x:0,y:0,scale:1},exit:{opacity:0,...h()},transition:{duration:.5,type:"spring",stiffness:300,damping:30},className:A("fixed z-[10002] rounded-lg border-2 p-3 sm:p-4 md:p-5 max-w-xs sm:max-w-sm md:max-w-md lg:max-w-lg shadow-xl select-none transition-all duration-200",f(),o(),r),onMouseEnter:d=>d.stopPropagation(),onMouseLeave:d=>d.stopPropagation(),onClick:d=>d.stopPropagation(),children:e.jsxs("div",{className:"flex items-start space-x-2 sm:space-x-3 md:space-x-4",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:i()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:A("text-sm sm:text-base md:text-lg font-semibold leading-tight",m()),children:t}),e.jsx("p",{className:"mt-1 text-xs sm:text-sm md:text-base text-gray-600 leading-relaxed",children:a})]}),n&&e.jsx("button",{onClick:d=>{d.stopPropagation(),n()},className:"absolute top-2 right-2 sm:top-3 sm:right-3 rounded-full p-1 hover:bg-gray-100 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-300",children:e.jsx(ce,{className:"h-3 w-3 sm:h-4 sm:w-4 md:h-5 md:w-5 text-gray-500 hover:text-gray-700 transition-colors"})})]})})}const Gl=Gt("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function X({className:s,variant:t,...a}){return e.jsx("div",{className:A(Gl({variant:t}),s),...a})}const ha=l.forwardRef(({className:s,value:t,...a},r)=>e.jsx(Er,{ref:r,className:A("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...a,children:e.jsx(Ti,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));ha.displayName=Er.displayName;const En=Ci,Ea=l.forwardRef(({className:s,...t},a)=>e.jsx(Dr,{ref:a,className:A("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...t}));Ea.displayName=Dr.displayName;const lt=l.forwardRef(({className:s,...t},a)=>e.jsx(Mr,{ref:a,className:A("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...t}));lt.displayName=Mr.displayName;const ot=l.forwardRef(({className:s,...t},a)=>e.jsx(Lr,{ref:a,className:A("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...t}));ot.displayName=Lr.displayName;function Xl(){const[s,t]=l.useState(null),[a,r]=l.useState(null),[n,i]=l.useState(null),[o,m]=l.useState(!1),[h,f]=l.useState(""),[d,y]=l.useState("overview"),{toast:b}=Zt();l.useEffect(()=>{let j;return s?.isRunning&&(j=setInterval(()=>{T(),E(),K()},5e3)),()=>{j&&clearInterval(j)}},[s?.isRunning]),l.useEffect(()=>{T(),E(),K()},[]);const N=async(j,M={})=>{const C={"Content-Type":"application/json",...M.headers},Q=localStorage.getItem("sessionId");return Q&&(C["x-session-id"]=Q),fetch(j,{credentials:"include",...M,headers:C})},T=async()=>{try{const j=await N("/api/simulation/status");if(j.ok){const M=await j.json();t(M)}else j.status===401&&b({title:"Authentication Error",description:"Please log in to access the simulation page",variant:"destructive"})}catch(j){console.error("Failed to fetch simulation status:",j)}},E=async()=>{try{const j=await N("/api/ml/optimization");if(j.ok){const M=await j.json();r(M.optimization)}else j.status===401&&b({title:"Authentication Error",description:"Please log in to access optimization data",variant:"destructive"})}catch(j){console.error("Failed to fetch optimization:",j)}},K=async()=>{try{const j=await N("/api/simulation/analytics");if(j.ok){const M=await j.json();i(M)}else if(j.status===401)b({title:"Authentication Error",description:"Please log in to access analytics data",variant:"destructive"});else{const M=await N("/api/analytics/network");if(M.ok){const C=await M.json();i(C)}}}catch(j){console.error("Failed to fetch analytics:",j)}},G=async()=>{m(!0);try{const j=await N("/api/simulation/start",{method:"POST"}),M=await j.json();if(j.ok)b({title:"Simulation Started",description:M.message}),T();else if(j.status===401)b({title:"Authentication Error",description:"Please log in to start the simulation",variant:"destructive"});else throw new Error(M.error)}catch(j){b({title:"Failed to start simulation",description:j instanceof Error?j.message:"Unknown error",variant:"destructive"})}finally{m(!1)}},fe=async()=>{m(!0);try{const j=await N("/api/simulation/stop",{method:"POST"}),M=await j.json();if(j.ok)b({title:"Simulation Stopped",description:M.message}),T();else if(j.status===401)b({title:"Authentication Error",description:"Please log in to stop the simulation",variant:"destructive"});else throw new Error(M.error)}catch(j){b({title:"Failed to stop simulation",description:j instanceof Error?j.message:"Unknown error",variant:"destructive"})}finally{m(!1)}},z=async j=>{m(!0);try{const M=await N("/api/simulation/weather",{method:"POST",body:JSON.stringify({condition:j})}),C=await M.json();if(M.ok)b({title:"Weather Changed",description:`${C.message}. ${C.impact}`}),T(),E();else if(M.status===401)b({title:"Authentication Error",description:"Please log in to change weather conditions",variant:"destructive"});else throw new Error(C.error)}catch(M){b({title:"Failed to change weather",description:M instanceof Error?M.message:"Unknown error",variant:"destructive"})}finally{m(!1)}},B=async()=>{m(!0);try{const j=await N("/api/simulation/outage",{method:"POST",body:JSON.stringify({})}),M=await j.json();if(j.ok)b({title:"Outage Simulation Triggered",description:`${M.message}. ${M.resilienceScore}`}),T(),E();else if(j.status===401)b({title:"Authentication Error",description:"Please log in to trigger power outage simulation",variant:"destructive"});else throw new Error(M.error)}catch(j){b({title:"Failed to trigger outage",description:j instanceof Error?j.message:"Unknown error",variant:"destructive"})}finally{m(!1)}},be=j=>{switch(j){case"sunny":return e.jsx(is,{className:"h-5 w-5 text-yellow-500"});case"partly-cloudy":return e.jsx(ys,{className:"h-5 w-5 text-gray-400"});case"cloudy":return e.jsx(ys,{className:"h-5 w-5 text-gray-600"});case"overcast":return e.jsx(ys,{className:"h-5 w-5 text-gray-700"});case"rainy":return e.jsx(Ri,{className:"h-5 w-5 text-blue-500"});case"stormy":return e.jsx(Oi,{className:"h-5 w-5 text-purple-500"});default:return e.jsx(ys,{className:"h-5 w-5"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center px-4",children:[e.jsx("h2",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-slate-100 mb-2",children:"ML Energy Trading Simulation"}),e.jsx("p",{className:"text-sm sm:text-base lg:text-lg text-slate-400 max-w-4xl mx-auto",children:"Experience real-time automatic energy flow management, weather adaptation, and power outage response in our decentralized energy network"})]}),e.jsxs(D,{className:"bg-slate-800/50 border-slate-600/50",children:[e.jsx(se,{children:e.jsxs(le,{className:"flex items-center gap-2 text-slate-200",children:[e.jsx(oa,{className:"h-5 w-5 text-emerald-400"}),"Live Demonstration Control Panel"]})}),e.jsxs(U,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3 sm:gap-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(X,{variant:s?.isRunning?"default":"secondary","data-testid":"simulation-status-badge",children:s?.isRunning?e.jsxs(e.Fragment,{children:[e.jsx(Ba,{className:"h-3 w-3 mr-1"}),"Running"]}):e.jsxs(e.Fragment,{children:[e.jsx(As,{className:"h-3 w-3 mr-1"}),"Stopped"]})})}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsxs(w,{onClick:G,disabled:s?.isRunning||o,size:"sm","data-testid":"button-start-simulation",className:"flex-1 sm:flex-none text-xs sm:text-sm",children:[o?e.jsx(zt,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(Ba,{className:"mr-2 h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Start Live Demo"}),e.jsx("span",{className:"sm:hidden",children:"Start Demo"})]}),e.jsxs(w,{onClick:fe,disabled:!s?.isRunning||o,variant:"outline",size:"sm","data-testid":"button-stop-simulation",className:"flex-1 sm:flex-none text-xs sm:text-sm",children:[e.jsx(As,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Stop Demo"}),e.jsx("span",{className:"sm:hidden",children:"Stop"})]})]})]}),s?.isRunning&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs sm:text-sm font-medium text-slate-300",children:"Test Weather Adaptation"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(ls,{value:h,onValueChange:f,"data-testid":"select-weather-condition",children:[e.jsx(Kt,{className:"w-full text-xs sm:text-sm",children:e.jsx(os,{placeholder:"Select weather condition"})}),e.jsxs(Qt,{children:[e.jsx(Pe,{value:"sunny",children:"☀️ Sunny"}),e.jsx(Pe,{value:"partly-cloudy",children:"⛅ Partly Cloudy"}),e.jsx(Pe,{value:"cloudy",children:"☁️ Cloudy"}),e.jsx(Pe,{value:"overcast",children:"☁️ Overcast"}),e.jsx(Pe,{value:"rainy",children:"🌧️ Rainy"}),e.jsx(Pe,{value:"stormy",children:"⛈️ Stormy"})]})]}),e.jsx(w,{onClick:()=>h&&z(h),disabled:!h||o,size:"sm",className:"w-full text-xs sm:text-sm","data-testid":"button-change-weather",children:"Apply Weather"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs sm:text-sm font-medium text-slate-300",children:"Test Power Outage Response"}),e.jsx("div",{className:"flex",children:e.jsxs(w,{onClick:B,disabled:o,variant:"outline",size:"sm",className:"w-full text-xs sm:text-sm","data-testid":"button-trigger-outage",children:[o?e.jsx(zt,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(Fi,{className:"mr-2 h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Simulate Outage"}),e.jsx("span",{className:"sm:hidden",children:"Outage Test"})]})})]})]})]})]}),e.jsxs(En,{defaultValue:"overview",className:"space-y-4",children:[e.jsxs(Ea,{className:"grid w-full grid-cols-4 gap-1 bg-slate-800/50 border-slate-600/50",children:[e.jsxs(lt,{value:"overview",className:"text-xs sm:text-sm px-2 py-2",children:[e.jsx("span",{className:"hidden sm:inline",children:"Overview"}),e.jsx("span",{className:"sm:hidden",children:"Stats"})]}),e.jsxs(lt,{value:"weather",className:"text-xs sm:text-sm px-2 py-2",children:[e.jsx("span",{className:"hidden sm:inline",children:"Weather Impact"}),e.jsx("span",{className:"sm:hidden",children:"Weather"})]}),e.jsxs(lt,{value:"grid",className:"text-xs sm:text-sm px-2 py-2",children:[e.jsx("span",{className:"hidden sm:inline",children:"Grid Management"}),e.jsx("span",{className:"sm:hidden",children:"Grid"})]}),e.jsxs(lt,{value:"equity",className:"text-xs sm:text-sm px-2 py-2",children:[e.jsx("span",{className:"hidden sm:inline",children:"Equitable Access"}),e.jsx("span",{className:"sm:hidden",children:"Access"})]})]}),e.jsx(ot,{value:"overview",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsx(D,{"data-testid":"card-total-households",className:"bg-slate-800/50 border-slate-600/50",children:e.jsx(U,{className:"pt-4 sm:pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm text-slate-400",children:"Total Households"}),e.jsx("p",{className:"text-lg sm:text-2xl font-bold text-slate-200","data-testid":"text-total-households",children:n?.network?.totalHouseholds||0})]}),e.jsx(st,{className:"h-6 w-6 sm:h-8 sm:w-8 text-slate-400"})]})})}),e.jsx(D,{"data-testid":"card-active-connections",className:"bg-slate-800/50 border-slate-600/50",children:e.jsx(U,{className:"pt-4 sm:pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm text-slate-400",children:"Active Connections"}),e.jsx("p",{className:"text-lg sm:text-2xl font-bold text-emerald-400","data-testid":"text-active-connections",children:n?.network?.activeHouseholds||0})]}),e.jsx(ie,{className:"h-6 w-6 sm:h-8 sm:w-8 text-emerald-400"})]})})}),e.jsx(D,{"data-testid":"card-grid-stability",className:"bg-slate-800/50 border-slate-600/50",children:e.jsx(U,{className:"pt-4 sm:pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm text-slate-400",children:"Grid Stability"}),e.jsx("p",{className:"text-lg sm:text-2xl font-bold text-blue-400","data-testid":"text-grid-stability",children:a?.gridStability&&typeof a.gridStability=="number"?`${Math.round(a.gridStability*100)}%`:"N/A"})]}),e.jsx(Ie,{className:"h-6 w-6 sm:h-8 sm:w-8 text-blue-400"})]})})}),e.jsx(D,{"data-testid":"card-storage-capacity",className:"bg-slate-800/50 border-slate-600/50",children:e.jsx(U,{className:"pt-4 sm:pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm text-slate-400",children:"Storage Capacity"}),e.jsx("p",{className:"text-lg sm:text-2xl font-bold text-slate-200","data-testid":"text-storage-capacity",children:n?.network?.totalStorageCapacity||"0 kWh"})]}),e.jsx(ns,{className:"h-6 w-6 sm:h-8 sm:w-8 text-yellow-400"})]})})})]})}),e.jsx(ot,{value:"weather",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs(D,{"data-testid":"card-current-weather",className:"bg-slate-800/50 border-slate-600/50",children:[e.jsx(se,{children:e.jsxs(le,{className:"flex items-center gap-2 text-sm sm:text-base text-slate-200",children:[be(s?.currentWeather?.condition||"sunny"),e.jsx("span",{className:"hidden sm:inline",children:"Current Weather Conditions"}),e.jsx("span",{className:"sm:hidden",children:"Weather"})]})}),e.jsxs(U,{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm text-slate-300",children:"Condition:"}),e.jsx(X,{"data-testid":"badge-weather-condition",className:"text-xs",children:s?.currentWeather?.condition||"sunny"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm text-slate-300",children:"Temperature:"}),e.jsxs("span",{className:"text-xs sm:text-sm font-medium text-slate-200","data-testid":"text-temperature",children:[s?.currentWeather?.temperature||25,"°C"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm text-slate-300",children:"Cloud Cover:"}),e.jsxs("span",{className:"text-xs sm:text-sm font-medium text-slate-200","data-testid":"text-cloud-cover",children:[s?.currentWeather?.cloudCover||20,"%"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs sm:text-sm font-medium text-slate-300",children:"Solar Generation Impact"}),e.jsx(ha,{value:s?.currentWeather?.condition==="sunny"?95:s?.currentWeather?.condition==="partly-cloudy"?75:s?.currentWeather?.condition==="cloudy"?45:s?.currentWeather?.condition==="overcast"?25:s?.currentWeather?.condition==="rainy"?15:s?.currentWeather?.condition==="stormy"?5:60,className:"w-full h-2 sm:h-3","data-testid":"progress-solar-impact"}),e.jsxs("div",{className:"flex justify-between text-xs text-slate-400 mt-1",children:[e.jsxs("span",{children:["Impact: ",s?.currentWeather?.condition==="sunny"?"95%":s?.currentWeather?.condition==="partly-cloudy"?"75%":s?.currentWeather?.condition==="cloudy"?"45%":s?.currentWeather?.condition==="overcast"?"25%":s?.currentWeather?.condition==="rainy"?"15%":s?.currentWeather?.condition==="stormy"?"5%":"60%"]}),e.jsx("span",{children:"Efficiency"})]})]})]})]}),e.jsxs(D,{"data-testid":"card-weather-adaptation",className:"bg-slate-800/50 border-slate-600/50",children:[e.jsx(se,{children:e.jsxs(le,{className:"text-sm sm:text-base text-slate-200",children:[e.jsx("span",{className:"hidden sm:inline",children:"Weather Adaptation Strategy"}),e.jsx("span",{className:"sm:hidden",children:"Adaptation"})]})}),e.jsx(U,{children:e.jsx("div",{className:"space-y-2",children:a?.recommendations?.slice(0,3).map((j,M)=>e.jsxs("div",{className:"flex items-start gap-2","data-testid":`recommendation-${M}`,children:[e.jsx(ie,{className:"h-3 w-3 sm:h-4 sm:w-4 text-emerald-400 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-xs sm:text-sm text-slate-300",children:j})]},M))||e.jsx("p",{className:"text-xs sm:text-sm text-slate-400",children:"Loading weather adaptation strategies..."})})})]})]})}),e.jsx(ot,{value:"grid",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs(D,{"data-testid":"card-load-balancing",className:"bg-slate-800/50 border-slate-600/50",children:[e.jsx(se,{children:e.jsxs(le,{className:"text-sm sm:text-base text-slate-200",children:[e.jsx("span",{className:"hidden sm:inline",children:"Automatic Load Balancing"}),e.jsx("span",{className:"sm:hidden",children:"Load Balance"})]})}),e.jsx(U,{className:"space-y-3 sm:space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm text-slate-300",children:"Network Efficiency:"}),e.jsx("span",{className:"font-mono text-xs sm:text-sm text-slate-200","data-testid":"text-network-efficiency",children:n?.efficiency?.networkEfficiency||"Loading..."})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm text-slate-300",children:"Average Distance:"}),e.jsx("span",{className:"font-mono text-xs sm:text-sm text-slate-200","data-testid":"text-avg-distance",children:n?.efficiency?.averageDistance||"0 km"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm text-slate-300",children:"Grid Load Status:"}),e.jsx(X,{variant:"default","data-testid":"badge-grid-status",className:"text-xs",children:"Optimized"})]})]})})]}),e.jsxs(D,{"data-testid":"card-outage-response",className:"bg-slate-800/50 border-slate-600/50",children:[e.jsx(se,{children:e.jsxs(le,{className:"text-sm sm:text-base text-slate-200",children:[e.jsx("span",{className:"hidden sm:inline",children:"Outage Response System"}),e.jsx("span",{className:"sm:hidden",children:"Outage Response"})]})}),e.jsx(U,{className:"space-y-3 sm:space-y-4",children:s?.activeOutages&&s.activeOutages.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xt,{className:"h-3 w-3 sm:h-4 sm:w-4 text-red-500"}),e.jsxs("span",{className:"text-xs sm:text-sm font-medium text-slate-200","data-testid":"text-active-outages",children:[s.activeOutages.length," households affected"]})]}),e.jsx("p",{className:"text-xs sm:text-sm text-slate-400",children:"Automatic energy redistribution in progress..."})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-3 w-3 sm:h-4 sm:w-4 text-emerald-400"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-slate-200","data-testid":"text-no-outages",children:"All systems operational"})]}),e.jsx("p",{className:"text-xs sm:text-sm text-slate-400",children:"Network resilience system standing by"})]})})]})]})}),e.jsx(ot,{value:"equity",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs(D,{"data-testid":"card-energy-security",className:"bg-slate-800/50 border-slate-600/50",children:[e.jsx(se,{children:e.jsxs(le,{className:"text-sm sm:text-base text-slate-200",children:[e.jsx("span",{className:"hidden sm:inline",children:"Energy Security Analysis"}),e.jsx("span",{className:"sm:hidden",children:"Energy Security"})]})}),e.jsx(U,{className:"space-y-3 sm:space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm text-slate-300",children:"Total Energy Traded:"}),e.jsx("span",{className:"font-mono text-xs sm:text-sm text-slate-200","data-testid":"text-total-traded",children:n?.trading?.totalEnergyTraded?Rl(parseFloat(n.trading.totalEnergyTraded.replace(/[^\d.]/g,""))):"Loading..."})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm text-slate-300",children:"Carbon Saved:"}),e.jsx("span",{className:"font-mono text-xs sm:text-sm text-emerald-400","data-testid":"text-carbon-saved",children:n?.trading?.carbonSaved?yn(parseFloat(n.trading.carbonSaved.replace(/[^\d.]/g,""))):"Loading..."})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs sm:text-sm text-slate-300",children:"Average Price:"}),e.jsx("span",{className:"font-mono text-xs sm:text-sm text-slate-200","data-testid":"text-avg-price",children:n?.trading?.averagePrice||"₹0.00/kWh"})]})]})})]}),e.jsxs(D,{"data-testid":"card-redistribution",className:"bg-slate-800/50 border-slate-600/50",children:[e.jsx(se,{children:e.jsxs(le,{className:"text-sm sm:text-base text-slate-200",children:[e.jsx("span",{className:"hidden sm:inline",children:"Energy Redistribution"}),e.jsx("span",{className:"sm:hidden",children:"Redistribution"})]})}),e.jsx(U,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(st,{className:"h-3 w-3 sm:h-4 sm:w-4 text-blue-400"}),e.jsxs("span",{className:"text-xs sm:text-sm font-medium text-slate-200",children:[e.jsx("span",{className:"hidden sm:inline",children:"Automatic Fair Distribution Active"}),e.jsx("span",{className:"sm:hidden",children:"Fair Distribution Active"})]})]}),e.jsxs("p",{className:"text-xs sm:text-sm text-slate-400",children:[e.jsx("span",{className:"hidden sm:inline",children:"System ensures equitable access to power across all households"}),e.jsx("span",{className:"sm:hidden",children:"Equitable power access system"})]}),e.jsxs("div",{className:"mt-3 sm:mt-4",children:[e.jsx(ha,{value:n?.equity?.fairDistributionScore||85,className:"w-full h-2 sm:h-3","data-testid":"progress-equity-score"}),e.jsxs("p",{className:"text-xs text-slate-400 mt-1",children:["Fair Distribution Score: ",n?.equity?.fairDistributionScore||85,"%"]})]})]})})]})]})})]}),s?.isRunning&&e.jsx(D,{"data-testid":"card-network-health",className:"bg-slate-800/50 border-slate-600/50",children:e.jsx(U,{className:"pt-4 sm:pt-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4 sm:h-5 sm:w-5 text-emerald-400"}),e.jsxs("span",{className:"text-xs sm:text-sm font-medium text-slate-200","data-testid":"text-network-health",children:[e.jsx("span",{className:"hidden sm:inline",children:"Network automatically managing energy flow and preventing grid overload"}),e.jsx("span",{className:"sm:hidden",children:"Auto-managing energy flow and grid stability"})]})]})})})]})}const Jl=Gt("relative w-full rounded-lg border p-3 sm:p-4 md:p-5 [&>svg~*]:pl-6 sm:[&>svg~*]:pl-7 md:[&>svg~*]:pl-8 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-3 sm:[&>svg]:left-4 md:[&>svg]:left-5 [&>svg]:top-3 sm:[&>svg]:top-4 md:[&>svg]:top-5 [&>svg]:text-foreground [&>svg]:h-4 [&>svg]:w-4 sm:[&>svg]:h-5 sm:[&>svg]:w-5",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Dn=l.forwardRef(({className:s,variant:t,...a},r)=>e.jsx("div",{ref:r,role:"alert",className:A(Jl({variant:t}),s),...a}));Dn.displayName="Alert";const Zl=l.forwardRef(({className:s,...t},a)=>e.jsx("h5",{ref:a,className:A("mb-1 font-medium leading-tight text-sm sm:text-base md:text-lg tracking-tight",s),...t}));Zl.displayName="AlertTitle";const Mn=l.forwardRef(({className:s,...t},a)=>e.jsx("div",{ref:a,className:A("text-xs sm:text-sm md:text-base [&_p]:leading-relaxed mt-1",s),...t}));Mn.displayName="AlertDescription";class _t{constructor(){this.currentLocation=null,this.locationPromise=null}static getInstance(){return _t.instance||(_t.instance=new _t),_t.instance}isGeolocationSupported(){return"geolocation"in navigator}async getCurrentLocation(t=!0){if(this.locationPromise)return this.locationPromise;if(!this.isGeolocationSupported())throw new Error("Geolocation is not supported by this browser");return this.locationPromise=new Promise((a,r)=>{const n={enableHighAccuracy:t,timeout:15e3,maximumAge:3e5};navigator.geolocation.getCurrentPosition(async i=>{const o={latitude:i.coords.latitude,longitude:i.coords.longitude,accuracy:i.coords.accuracy};try{const m=await this.reverseGeocode(o.latitude,o.longitude);Object.assign(o,m)}catch(m){console.warn("Could not fetch address information:",m)}this.currentLocation=o;try{localStorage.setItem("user_location",JSON.stringify(o)),localStorage.setItem("location_permission_granted","true")}catch(m){console.warn("Failed to cache location:",m)}this.locationPromise=null,a(o)},i=>{if(this.locationPromise=null,i.code===1)try{localStorage.setItem("location_permission_denied","true")}catch(m){console.warn("Failed to cache permission denial:",m)}const o={code:i.code,message:i.message,type:this.getErrorType(i.code)};r(o)},n)}),this.locationPromise}getErrorType(t){switch(t){case 1:return"permission_denied";case 2:return"position_unavailable";case 3:return"timeout";default:return"not_supported"}}async reverseGeocode(t,a){try{const r=await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${t}&longitude=${a}&localityLanguage=en`);if(!r.ok)throw new Error("Reverse geocoding failed");const n=await r.json();return{address:n.locality||n.city||"",city:n.city||n.locality||"",state:n.principalSubdivision||"",country:n.countryName||""}}catch(r){return console.warn("Reverse geocoding failed:",r),{}}}getCachedLocation(){if(this.currentLocation)return this.currentLocation;try{const t=localStorage.getItem("user_location");if(t)return this.currentLocation=JSON.parse(t),this.currentLocation}catch(t){console.warn("Failed to parse cached location:",t)}return null}clearCachedLocation(){this.currentLocation=null;try{localStorage.removeItem("user_location"),localStorage.removeItem("location_permission_granted"),localStorage.removeItem("location_permission_denied"),console.log("🧹 Location cache cleared - user can be prompted again")}catch(t){console.warn("Failed to clear cached location:",t)}}resetLocationPermission(){this.clearCachedLocation(),console.log("🔄 Location permission reset - dialog will show on next check")}async getBrowserPermissionState(){if(!this.isGeolocationSupported())return"unknown";try{if("permissions"in navigator)return(await navigator.permissions.query({name:"geolocation"})).state}catch(t){console.warn("Failed to check browser permission state:",t)}return"unknown"}async shouldShowLocationDialog(){if(!this.isGeolocationSupported())return!1;const t=this.getCachedLocation(),a=this.isPermissionGranted();if(t&&a||this.isPermissionDenied())return!1;const r=await this.getBrowserPermissionState();if(r==="granted")return!t;if(r==="denied"){try{localStorage.setItem("location_permission_denied","true")}catch(n){console.warn("Failed to cache permission denial:",n)}return!1}return r==="prompt"||r==="unknown"&&!t}async requestLocationPermission(){if(!this.isGeolocationSupported())return!1;try{const t=await this.getBrowserPermissionState();return t==="granted"?!0:t==="denied"?!1:(await this.getCurrentLocation(),!0)}catch{return!1}}isPermissionDenied(){try{return localStorage.getItem("location_permission_denied")==="true"}catch{return!1}}isPermissionGranted(){try{return localStorage.getItem("location_permission_granted")==="true"}catch{return!1}}}const Is=_t.getInstance();function eo({onLocationGranted:s,onLocationDenied:t,isOpen:a}){const[r,n]=l.useState(!1),[i,o]=l.useState(null),[m,h]=l.useState(a);l.useEffect(()=>{h(a)},[a]);const f=async()=>{n(!0),o(null);try{const b=await Is.getCurrentLocation(!0);s(b),h(!1)}catch(b){o(b),b.type==="permission_denied"&&t()}finally{n(!1)}},d=()=>{h(!1),t()},y=b=>{switch(b.type){case"permission_denied":return"Location access was denied. Please enable location permissions in your browser settings to get localized energy data.";case"position_unavailable":return"Your location could not be determined. Please check your internet connection and try again.";case"timeout":return"Location request timed out. Please try again.";default:return"An error occurred while getting your location. Please try again."}};return e.jsx(ht,{open:m,onOpenChange:()=>{},children:e.jsxs(nt,{className:"mx-2 sm:mx-3 max-w-xs sm:max-w-sm w-full p-4 sm:p-5 bg-gradient-to-br from-slate-900 via-blue-950/90 to-slate-800 border border-blue-500/20 shadow-2xl backdrop-blur-xl rounded-xl","data-testid":"dialog-location-permission",children:[e.jsxs(pt,{className:"pb-3 sm:pb-4 text-center",children:[e.jsx("div",{className:"mx-auto w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-br from-blue-500 to-cyan-400 rounded-full flex items-center justify-center mb-2 sm:mb-3 shadow-lg",children:e.jsx(Wt,{className:"h-4 w-4 sm:h-5 sm:w-5 text-white"})}),e.jsx(it,{className:"text-lg sm:text-xl font-bold bg-gradient-to-r from-blue-400 to-cyan-300 bg-clip-text text-transparent","data-testid":"text-dialog-title",children:"Share Your Location"}),e.jsx(Hs,{className:"text-slate-300 text-xs sm:text-sm leading-relaxed mt-1","data-testid":"text-dialog-description",children:"Get personalized energy trading and localized renewable data."})]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:gap-2.5",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 p-2.5 sm:p-3 bg-gradient-to-r from-blue-900/40 to-blue-800/30 rounded-lg border border-blue-500/20 hover:border-blue-400/30 transition-all duration-300",children:[e.jsx("div",{className:"w-6 h-6 sm:w-7 sm:h-7 bg-blue-500/20 rounded-md flex items-center justify-center flex-shrink-0",children:e.jsx(Ie,{className:"h-3 w-3 sm:h-3.5 sm:w-3.5 text-blue-400"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("p",{className:"text-xs sm:text-sm font-semibold text-blue-200 truncate",children:"Local Energy Network"})})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 p-2.5 sm:p-3 bg-gradient-to-r from-emerald-900/40 to-emerald-800/30 rounded-lg border border-emerald-500/20 hover:border-emerald-400/30 transition-all duration-300",children:[e.jsx("div",{className:"w-6 h-6 sm:w-7 sm:h-7 bg-emerald-500/20 rounded-md flex items-center justify-center flex-shrink-0",children:e.jsx(Ts,{className:"h-3 w-3 sm:h-3.5 sm:w-3.5 text-emerald-400"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("p",{className:"text-xs sm:text-sm font-semibold text-emerald-200 truncate",children:"Weather & Efficiency"})})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 p-2.5 sm:p-3 bg-gradient-to-r from-violet-900/40 to-violet-800/30 rounded-lg border border-violet-500/20 hover:border-violet-400/30 transition-all duration-300",children:[e.jsx("div",{className:"w-6 h-6 sm:w-7 sm:h-7 bg-violet-500/20 rounded-md flex items-center justify-center flex-shrink-0",children:e.jsx(ie,{className:"h-3 w-3 sm:h-3.5 sm:w-3.5 text-violet-400"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("p",{className:"text-xs sm:text-sm font-semibold text-violet-200 truncate",children:"Privacy Protected"})})]})]}),i&&e.jsxs(Dn,{className:"border-red-500/30 bg-gradient-to-r from-red-950/50 to-red-900/40 rounded-lg p-3","data-testid":"alert-location-error",children:[e.jsx(va,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-red-400"}),e.jsx(Mn,{className:"text-red-200 text-xs sm:text-sm",children:y(i)})]}),e.jsxs("div",{className:"flex flex-col gap-2 sm:gap-2.5 pt-1 sm:pt-2",children:[e.jsx(w,{onClick:f,disabled:r,className:"w-full h-9 sm:h-10 bg-gradient-to-r from-blue-600 to-cyan-500 hover:from-blue-700 hover:to-cyan-600 text-white font-semibold rounded-lg shadow-lg hover:shadow-xl transform hover:scale-[1.02] transition-all duration-200","data-testid":"button-allow-location",children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 sm:h-3.5 sm:w-3.5 border-2 border-white border-t-transparent mr-2"}),e.jsx("span",{className:"text-sm",children:"Getting Location..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Wt,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 mr-2"}),e.jsx("span",{className:"text-sm font-medium",children:"Allow Location"})]})}),e.jsx(w,{variant:"outline",onClick:d,disabled:r,className:"w-full h-8 sm:h-9 border-slate-600 bg-slate-800/50 hover:bg-slate-700/50 text-slate-300 hover:text-white rounded-lg transition-all duration-200","data-testid":"button-skip-location",children:e.jsx("span",{className:"text-xs sm:text-sm",children:"Skip for Now"})})]}),e.jsx("p",{className:"text-xs text-slate-400 text-center mt-2 sm:mt-3","data-testid":"text-privacy-note",children:"Change in browser settings anytime"})]})]})})}function to(){const[s,t]=l.useState("energy-dashboard"),[a,r]=l.useState(!1),[n,i]=l.useState(!1),[o,m]=l.useState(!1),[h,f]=l.useState(""),[d,y]=l.useState("warning"),[b,N]=l.useState(!1),[T,E]=l.useState(!1),[K,G]=l.useState(null),[fe,z]=l.useState(!1),[B,be]=l.useState(null),[j,M]=l.useState(!1),{user:C,healthStatus:Q}=ct(),R=ja(),{toast:W}=Zt(),[ae,Ae]=xs();l.useEffect(()=>{(async()=>{if(!Is.isGeolocationSupported()||!C){M(!0);return}try{if(await Is.shouldShowLocationDialog())console.log("🗺️ Location permission needed, showing dialog"),z(!0);else{const ne=Is.getCachedLocation();ne?(console.log("📍 Using cached location:",ne),be(ne)):console.log("🚫 Location permission handled, no dialog needed")}}catch(S){console.warn("Error checking location permission:",S)}finally{M(!0)}})()},[C]);const Ne=c=>{console.log("Location granted:",c),be(c),z(!1),R.invalidateQueries({queryKey:["/api/market/realtime"]}),W({title:"Location Access Granted",description:"Weather data will now be customized for your location to improve solar efficiency calculations."})},J=()=>{z(!1),W({title:"Location Access Declined",description:"Using general weather data. You can enable location access later in your browser settings.",variant:"destructive"})},{data:ee=[],isLoading:qe}=Ve({queryKey:["/api/energy-trades"],refetchInterval:C?2e4:!1,enabled:!!C}),{data:de=[],isLoading:Ee}=Ve({queryKey:["/api/trade-offers"],refetchInterval:C?2e4:!1,enabled:!!C}),{data:Je=[]}=Ve({queryKey:["/api/trade-acceptances"],refetchInterval:C?3e4:!1,enabled:!!C}),{data:H,error:He,isLoading:De}=Ve({queryKey:["/api/market/realtime",B?.latitude,B?.longitude],refetchInterval:2e4,retry:3,staleTime:0,gcTime:1e3,enabled:!!C&&!!B,queryFn:async()=>{if(!B)throw new Error("Location required for weather data");const c=new URLSearchParams({latitude:B.latitude.toString(),longitude:B.longitude.toString()}),S={},ne=localStorage.getItem("sessionId");ne&&(S["x-session-id"]=ne);const Fe=await fetch(`/api/market/realtime?${c}`,{credentials:"include",headers:S});if(Fe.status===400&&!B)throw new Error("Location required for weather data");if(!Fe.ok){const Oe=await Fe.json().catch(()=>({}));throw new Error(Oe.message||"Failed to fetch market data")}const Ft=await Fe.json();return console.log("✅ Market data received:",Ft),Ft}});console.log("🔍 Market query debug:",{marketData:H,marketError:He?.message,marketLoading:De,userLocation:B,locationPermissionChecked:j,user:!!C});const{data:he=[]}=Ve({queryKey:["/api/households"],refetchInterval:C?6e4:!1,enabled:!!C}),{data:x}=Ve({queryKey:["/api/analytics/network"],refetchInterval:C?6e4:!1,enabled:!!C,retry:!1}),p=async()=>{r(!0);try{await R.invalidateQueries({queryKey:["/api/energy-trades"]}),await R.invalidateQueries({queryKey:["/api/trade-offers"]}),await R.invalidateQueries({queryKey:["/api/trade-acceptances"]}),await R.invalidateQueries({queryKey:["/api/market/realtime"]}),await R.invalidateQueries({queryKey:["/api/analytics/network"]}),W({title:"Data Refreshed",description:"Latest energy market data has been loaded."})}catch{W({title:"Refresh Failed",description:"Unable to refresh data. Please try again.",variant:"destructive"})}finally{r(!1)}},k=Se({mutationFn:c=>je("POST","/api/energy-trades",c),onSuccess:()=>{R.invalidateQueries({queryKey:["/api/energy-trades"]}),R.invalidateQueries({queryKey:["/api/trade-offers"]}),N(!1),W({title:"Trade Created",description:"Your energy trade offer has been created successfully."})},onError:c=>{W({title:"Error",description:c.message||"Failed to create trade offer.",variant:"destructive"})}}),q=Se({mutationFn:({id:c,data:S})=>je("PUT",`/api/energy-trades/${c}`,S),onSuccess:()=>{R.invalidateQueries({queryKey:["/api/energy-trades"]}),R.invalidateQueries({queryKey:["/api/trade-offers"]}),E(!1),W({title:"Trade Updated",description:"Your energy trade has been updated successfully."})},onError:c=>{W({title:"Error",description:c.message||"Failed to update trade.",variant:"destructive"})}}),_=Se({mutationFn:c=>je("DELETE",`/api/energy-trades/${c}`),onSuccess:()=>{R.invalidateQueries({queryKey:["/api/energy-trades"]}),R.invalidateQueries({queryKey:["/api/trade-offers"]}),W({title:"Trade Deleted",description:"Your energy trade has been deleted successfully."})},onError:c=>{W({title:"Error",description:c.message||"Failed to delete trade.",variant:"destructive"})}}),P=Se({mutationFn:c=>je("DELETE",`/api/trade-acceptances/${c}`),onSuccess:async(c,S)=>{console.log("🗑️ Cancel mutation success, invalidating cache..."),R.setQueryData(["/api/trade-acceptances"],ne=>(ne||[]).filter(Fe=>Fe.id!==S)),await R.removeQueries({queryKey:["/api/trade-acceptances"]}),await R.removeQueries({queryKey:["/api/trade-offers"]}),await R.removeQueries({queryKey:["/api/energy-trades"]}),await R.refetchQueries({queryKey:["/api/trade-acceptances"]}),await R.refetchQueries({queryKey:["/api/trade-offers"]}),await R.refetchQueries({queryKey:["/api/energy-trades"]}),console.log("✅ Cache cleared and data refetched"),W({title:"Application Cancelled",description:"Your trade application has been cancelled successfully."})},onError:c=>{W({title:"Error",description:c.message||"Failed to cancel application.",variant:"destructive"})}}),v=(c,S)=>c.household?.name?c.household.name:S==="seller"?c.sellerHouseholdName||(c.sellerHouseholdId?`Household #${c.sellerHouseholdId}`:"Unknown Household"):c.buyerHouseholdName||(c.buyerHouseholdId?`Household #${c.buyerHouseholdId}`:"Unknown Household"),I=c=>Lt?c.tradeType==="sell"?c.sellerHouseholdId!==Lt:c.tradeType==="buy"?c.buyerHouseholdId!==Lt:!1:!1,L=c=>(Je||[]).some(S=>S.tradeId===c&&["applied","accepted","pending","awarded"].includes(S.status)),me=c=>(Je||[]).find(S=>S.tradeId===c&&["applied","accepted","pending","awarded"].includes(S.status)),Me=(c,S)=>{const ne=L(c),Fe=parseInt(String(S))||0;return Fe>0?{text:`${Fe} applied`,className:ne?"bg-blue-500/15 text-blue-400":"bg-emerald-500/15 text-emerald-400"}:{text:"0 applied",className:"bg-slate-500/10 text-slate-400"}},At=(c,S)=>{const ne=S||0;return c==="cancelled"||c==="completed"?{text:c,className:c==="completed"?"bg-emerald-500/15 text-emerald-400":"bg-muted text-gray-600"}:c==="rejected"?{text:"rejected",className:"bg-red-100 text-red-700"}:c==="pending"?ne>0?{text:"pending",className:"bg-yellow-100 text-yellow-700"}:{text:"available",className:"bg-emerald-500/15 text-emerald-400"}:{text:c,className:"bg-muted text-gray-600"}},jt=c=>{const S=me(c);S&&window.confirm("Are you sure you want to cancel your application for this trade?")&&P.mutate(S.id)},Ue=c=>{if(!Lt){W({title:"Error",description:"No household found. Please set up your household first.",variant:"destructive"});return}Ra(c),bs(!0)},Ze=Se({mutationFn:async c=>(await je("POST","/api/trade-acceptances",{tradeId:c.tradeId,acceptorHouseholdId:c.acceptorHouseholdId})).json(),onSuccess:c=>{W({title:"Trade Accepted!",description:c.message||"You have successfully accepted this trade offer. Contact information will be shared."}),bs(!1),Ra(null),R.invalidateQueries({queryKey:["/api/energy-trades"]}),R.invalidateQueries({queryKey:["/api/trade-offers"]}),R.invalidateQueries({queryKey:["/api/trade-acceptances"]})},onError:c=>{W({title:"Error",description:c.message||"Failed to accept trade offer.",variant:"destructive"})}}),Et=()=>{if(!Le||!Lt)return;const c=Le.trade.id;Ze.mutate({tradeId:c,acceptorHouseholdId:Lt})},dt=c=>{const S=he.map(ne=>ne.id);return c.tradeType==="sell"?c.sellerHouseholdId?S.includes(c.sellerHouseholdId):!1:c.tradeType==="buy"&&c.buyerHouseholdId?S.includes(c.buyerHouseholdId):!1},Mt=(()=>{if(Array.isArray(ee)&&ee.length>0){const c=ee.filter(Oe=>Oe.status==="pending"&&Oe.pricePerKwh>=3&&Oe.pricePerKwh<=20),S=c.filter(Oe=>Oe.tradeType==="sell"),ne=c.filter(Oe=>Oe.tradeType==="buy");let Fe=6;if(S.length>0){const Oe=S.reduce((Xs,Js)=>Xs+Math.round(Js.pricePerKwh),0);Fe=Math.round(Oe/S.length)}let Ft=7;if(ne.length>0){const Oe=ne.reduce((Xs,Js)=>Xs+Math.round(Js.pricePerKwh),0);Ft=Math.round(Oe/ne.length)}return{selling:Fe,buying:Ft,overall:Math.round((Fe+Ft)/2)}}return{selling:6,buying:7,overall:6}})(),u=Mt.overall,F=Math.max(3,Math.round(u*.7)),$=500,gs=Ct({sellerHouseholdId:Ls().optional(),buyerHouseholdId:Ls().optional(),energyAmount:Ht.number().min(1,"Energy amount must be at least 1 kWh"),pricePerKwh:Ht.number().min(F,`Price too low. Minimum allowed: ₹${F}/kWh`).max($,`Price too high. Maximum allowed: ₹${$}/kWh`),tradeType:Sa(["sell","buy"])}),pe=Ut({resolver:Yt(gs),defaultValues:{sellerHouseholdId:he[0]?.id||1,buyerHouseholdId:void 0,energyAmount:0,pricePerKwh:u,tradeType:"sell"}}),ve=Ut({resolver:Yt(gs),defaultValues:{sellerHouseholdId:he[0]?.id||1,buyerHouseholdId:void 0,energyAmount:0,pricePerKwh:u,tradeType:"sell"}}),ni=c=>{const S=he[0]?.id;if(!S){W({title:"Error",description:"No household found. Please set up your household first.",variant:"destructive"});return}const ne={...c,energyAmount:Math.round(c.energyAmount),pricePerKwh:Math.round(c.pricePerKwh),sellerHouseholdId:c.tradeType==="sell"?S:void 0,buyerHouseholdId:c.tradeType==="buy"?S:void 0};k.mutate(ne)},ii=c=>{if(!K)return;const S=he[0]?.id;if(!S){W({title:"Error",description:"No household found. Please set up your household first.",variant:"destructive"});return}const ne={...c,energyAmount:Math.round(c.energyAmount),pricePerKwh:Math.round(c.pricePerKwh),sellerHouseholdId:c.tradeType==="sell"?S:void 0,buyerHouseholdId:c.tradeType==="buy"?S:void 0};q.mutate({id:K.id,data:ne})},La=c=>{G(c),ve.reset({energyAmount:Math.round(c.energyAmount),pricePerKwh:Math.round(c.pricePerKwh),tradeType:c.tradeType}),E(!0)},Fa=c=>{window.confirm(`Are you sure you want to delete this ${c.tradeType} trade for ${c.energyAmount} kWh?`)&&_.mutate(c.id)},[Ys,li]=l.useState("all"),[Gs,oi]=l.useState("all"),[ke,Oa]=l.useState(null),[ci,fs]=l.useState(!1),[di,bs]=l.useState(!1),[Le,Ra]=l.useState(null),Lt=he?.[0]?.id;let mt=de.filter(c=>c.trade.tradeType==="sell"&&c.trade.status==="pending"),ut=de.filter(c=>c.trade.tradeType==="buy"&&c.trade.status==="pending");return Ys==="cheapest"?mt=mt.sort((c,S)=>c.trade.pricePerKwh-S.trade.pricePerKwh):Ys==="biggest"&&(mt=mt.sort((c,S)=>S.trade.energyAmount-c.trade.energyAmount)),Gs==="cheapest"?ut=ut.sort((c,S)=>S.trade.pricePerKwh-c.trade.pricePerKwh):Gs==="biggest"&&(ut=ut.sort((c,S)=>S.trade.energyAmount-c.trade.energyAmount)),l.useEffect(()=>{const S=new URLSearchParams(window.location.search).get("tab");S==="energy-trading"?t("energy-trading"):S==="energy-dashboard"?t("energy-dashboard"):S==="simulation"&&t("simulation")},[]),l.useEffect(()=>{Q&&C&&Q.status==="unhealthy"&&Q.message&&(f(Q.message),y("error"),m(!0),setTimeout(()=>{m(!1)},8e3))},[Q,C]),l.useEffect(()=>{localStorage.getItem("logoutSuccess")==="true"&&(localStorage.removeItem("logoutSuccess"),f("You have logged out successfully."),y("success"),m(!0),setTimeout(()=>{m(!1)},3e3))},[]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:[e.jsx(Tt,{currentPage:"dashboard",activeTab:s,onTabChange:c=>{t(c),window.history.pushState({},"",`/?tab=${c}`),window.scrollTo({top:0,behavior:"smooth"})}}),e.jsx("section",{className:"bg-gradient-to-br from-slate-800 to-slate-900 text-white pb-6 sm:pb-8 md:pb-10 lg:pb-12 xl:pb-16 pt-20",children:e.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 md:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center flex flex-col justify-center items-center min-h-[150px] sm:min-h-[160px] md:min-h-[170px] lg:min-h-[180px] xl:min-h-[190px] pt-6 sm:pt-8 md:pt-10",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-bold mb-3 sm:mb-4 md:mb-6 lg:mb-8",children:"SolarSense: Intelligent Energy Solutions"}),e.jsx("p",{className:"text-base sm:text-lg md:text-xl lg:text-2xl opacity-90 px-2 max-w-4xl mx-auto",children:"Decentralized energy trading platform for a sustainable future"})]})})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-900/40 via-blue-800/30 to-blue-900/40 border-b border-border shadow-sm",children:e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex bg-gradient-to-r from-slate-900/50 via-slate-800/30 to-slate-900/50 p-1 backdrop-blur-sm",children:[e.jsxs("button",{onClick:()=>{t("energy-dashboard"),window.history.pushState({},"","/?tab=energy-dashboard"),window.scrollTo({top:0,behavior:"smooth"})},className:`flex-1 py-3 sm:py-4 px-3 sm:px-4 md:px-6 text-center font-medium transition-all duration-300 text-sm sm:text-base flex flex-col items-center gap-1 sm:flex-row sm:justify-center sm:gap-2 rounded-lg ${s==="energy-dashboard"?"bg-gradient-to-r from-blue-600 to-cyan-500 text-white shadow-lg transform scale-[1.02]":"text-slate-300 hover:text-white hover:bg-slate-800/50"}`,children:[e.jsx(Bt,{className:"",size:16}),e.jsxs("div",{children:[e.jsx("span",{children:"Market"}),e.jsx("span",{className:"hidden sm:inline",children:" Dashboard"})]})]}),e.jsxs("button",{onClick:()=>{t("energy-trading"),window.history.pushState({},"","/?tab=energy-trading"),window.scrollTo({top:0,behavior:"smooth"})},className:`flex-1 py-3 sm:py-4 px-3 sm:px-4 md:px-6 text-center font-medium transition-all duration-300 text-sm sm:text-base flex flex-col items-center gap-1 sm:flex-row sm:justify-center sm:gap-2 rounded-lg ${s==="energy-trading"?"bg-gradient-to-r from-blue-600 to-cyan-500 text-white shadow-lg transform scale-[1.02]":"text-slate-300 hover:text-white hover:bg-slate-800/50"}`,children:[e.jsx(rt,{className:"",size:16}),e.jsxs("div",{children:[e.jsx("span",{children:"Trading"}),e.jsx("span",{className:"hidden sm:inline",children:" Center"})]})]}),e.jsxs("button",{onClick:()=>{t("simulation"),window.history.pushState({},"","/?tab=simulation"),window.scrollTo({top:0,behavior:"smooth"})},className:`flex-1 py-3 sm:py-4 px-3 sm:px-4 md:px-6 text-center font-medium transition-all duration-300 text-sm sm:text-base flex flex-col items-center gap-1 sm:flex-row sm:justify-center sm:gap-2 rounded-lg ${s==="simulation"?"bg-gradient-to-r from-blue-600 to-cyan-500 text-white shadow-lg transform scale-[1.02]":"text-slate-300 hover:text-white hover:bg-slate-800/50"}`,children:[e.jsx(st,{className:"",size:16}),e.jsxs("div",{children:[e.jsx("span",{children:"Simulation"}),e.jsx("span",{className:"hidden sm:inline",children:" Lab"})]})]})]})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-3 sm:px-4 md:px-6 lg:px-8 py-4 sm:py-6 md:py-8 relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-900/5 via-transparent to-purple-900/5 pointer-events-none rounded-lg"}),e.jsx("div",{className:"relative z-10",children:e.jsxs(_i,{mode:"wait",children:[s==="energy-dashboard"&&e.jsxs(ye.div,{initial:{opacity:0,x:-20,y:10},animate:{opacity:1,x:0,y:0},exit:{opacity:0,x:20,y:-10},transition:{duration:.4,ease:"easeInOut"},className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-800/50 via-slate-700/30 to-slate-800/50 p-4 sm:p-6 rounded-xl border border-slate-600/30 backdrop-blur-sm",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 sm:gap-0",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold bg-gradient-to-r from-blue-300 via-emerald-300 to-purple-300 bg-clip-text text-transparent",children:"Real-time Energy Market"}),e.jsxs(w,{onClick:p,disabled:a,size:"sm",variant:"outline","data-testid":"button-refresh",className:"w-full sm:w-auto border-slate-600 hover:bg-slate-700/50 bg-gradient-to-r from-slate-700/50 to-slate-600/50",children:[e.jsx(zt,{className:`mr-2 h-4 w-4 ${a?"animate-spin":""}`}),e.jsx("span",{className:"hidden sm:inline",children:a?"Updating...":"Refresh"}),e.jsx("span",{className:"sm:hidden",children:a?"Update":"Refresh"})]})]})}),e.jsxs(ye.div,{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-3 sm:gap-4",variants:{visible:{transition:{staggerChildren:.1}}},initial:"hidden",animate:"visible",children:[e.jsx(ye.div,{variants:{hidden:{opacity:0,y:20,scale:.95},visible:{opacity:1,y:0,scale:1}},transition:{duration:.5,ease:"easeOut"},children:e.jsxs(D,{className:"p-3 sm:p-4 bg-gradient-to-br from-emerald-950/40 via-emerald-900/25 to-emerald-800/30 border-emerald-700/40 relative overflow-hidden backdrop-blur-sm hover:scale-105 transition-transform duration-300",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-emerald-500/5 to-transparent pointer-events-none"}),e.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-emerald-400 mb-1 truncate",children:"Network Generation"}),e.jsx("p",{className:"text-lg sm:text-2xl font-bold text-emerald-200 truncate","data-testid":"text-total-generation",children:x?.network?.totalGenerationCapacity||"0 kW"}),e.jsx("p",{className:"text-xs text-emerald-300 truncate",children:"Solar capacity online"})]}),e.jsx("div",{className:"bg-gradient-to-br from-emerald-500/25 to-emerald-600/20 p-1.5 sm:p-2 rounded-full flex-shrink-0 ml-2 backdrop-blur-sm border border-emerald-400/20",children:e.jsx(is,{className:"h-4 w-4 sm:h-5 sm:w-5 text-emerald-400"})})]})]})}),e.jsx(ye.div,{variants:{hidden:{opacity:0,y:20,scale:.95},visible:{opacity:1,y:0,scale:1}},transition:{duration:.5,ease:"easeOut"},children:e.jsxs(D,{className:"p-3 sm:p-4 bg-gradient-to-br from-blue-950/40 via-blue-900/25 to-blue-800/30 border-blue-700/40 relative overflow-hidden backdrop-blur-sm hover:scale-105 transition-transform duration-300",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-blue-500/5 to-transparent pointer-events-none"}),e.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-blue-400 mb-1 truncate",children:"Energy Trades"}),e.jsx("p",{className:"text-lg sm:text-2xl font-bold text-blue-200 truncate","data-testid":"text-active-trades",children:de.length||0}),e.jsx("p",{className:"text-xs text-blue-300 truncate",children:"Active exchanges"})]}),e.jsx("div",{className:"bg-gradient-to-br from-blue-500/25 to-blue-600/20 p-1.5 sm:p-2 rounded-full flex-shrink-0 ml-2 backdrop-blur-sm border border-blue-400/20",children:e.jsx(ts,{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-400"})})]})]})}),e.jsx(ye.div,{variants:{hidden:{opacity:0,y:20,scale:.95},visible:{opacity:1,y:0,scale:1}},transition:{duration:.5,ease:"easeOut"},children:e.jsxs(D,{className:"p-3 sm:p-4 bg-gradient-to-br from-purple-950/40 via-purple-900/25 to-purple-800/30 border-purple-700/40 relative overflow-hidden backdrop-blur-sm hover:scale-105 transition-transform duration-300",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-purple-500/5 to-transparent pointer-events-none"}),e.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-purple-400 mb-1 truncate",children:"Average Price"}),e.jsxs("p",{className:"text-lg sm:text-2xl font-bold text-purple-200 truncate","data-testid":"text-average-price",children:[x?.trading?.averagePrice||"₹0","/kWh"]}),e.jsx("p",{className:"text-xs text-purple-300 truncate",children:"Current market rate"})]}),e.jsx("div",{className:"bg-gradient-to-br from-purple-500/25 to-purple-600/20 p-1.5 sm:p-2 rounded-full flex-shrink-0 ml-2 backdrop-blur-sm border border-purple-400/20",children:e.jsx(rt,{className:"h-4 w-4 sm:h-5 sm:w-5 text-purple-400"})})]})]})}),e.jsx(ye.div,{variants:{hidden:{opacity:0,y:20,scale:.95},visible:{opacity:1,y:0,scale:1}},transition:{duration:.5,ease:"easeOut"},children:e.jsxs(D,{className:"p-3 sm:p-4 bg-gradient-to-br from-green-950/40 via-emerald-900/25 to-green-800/30 border-green-700/40 relative overflow-hidden backdrop-blur-sm hover:scale-105 transition-transform duration-300",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-green-500/5 to-transparent pointer-events-none"}),e.jsxs("div",{className:"flex items-center justify-between relative z-10",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-green-400 mb-1 truncate",children:"Carbon Saved"}),e.jsx("p",{className:"text-lg sm:text-2xl font-bold text-green-200 truncate","data-testid":"text-carbon-saved",children:x?.trading?.carbonSaved?yn(parseFloat(x.trading.carbonSaved.replace(/[^\d.]/g,""))):"0 kg CO2"}),e.jsx("p",{className:"text-xs text-green-300 truncate",children:"CO₂ avoided today"})]}),e.jsx("div",{className:"bg-gradient-to-br from-green-500/25 to-green-600/20 p-1.5 sm:p-2 rounded-full flex-shrink-0 ml-2 backdrop-blur-sm border border-green-400/20",children:e.jsx(Bi,{className:"h-4 w-4 sm:h-5 sm:w-5 text-green-400"})})]})]})})]}),De?e.jsxs(D,{className:"p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold mb-4 text-center",children:"Loading Market Data..."}),e.jsxs("div",{className:"animate-pulse space-y-3",children:[e.jsx("div",{className:"h-3 sm:h-4 bg-muted rounded"}),e.jsx("div",{className:"h-3 sm:h-4 bg-muted rounded w-3/4"}),e.jsx("div",{className:"h-3 sm:h-4 bg-muted rounded w-1/2"})]})]}):H?e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs(D,{className:"p-4 sm:p-6 bg-gradient-to-br from-slate-900/60 via-blue-950/40 to-slate-800/60 border border-blue-500/20 backdrop-blur-sm shadow-xl",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-blue-500/20 rounded-full",children:e.jsx(st,{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-400"})}),e.jsx("span",{className:"hidden sm:inline bg-gradient-to-r from-blue-400 to-cyan-300 bg-clip-text text-transparent",children:"Live Market Activity"}),e.jsx("span",{className:"sm:hidden bg-gradient-to-r from-blue-400 to-cyan-300 bg-clip-text text-transparent",children:"Market Activity"}),e.jsx("span",{className:"bg-green-900/30 text-green-400 px-2 py-1 rounded-full text-xs font-medium",children:"Live Data"})]}),e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 sm:p-4 bg-gradient-to-r from-emerald-900/40 to-emerald-800/30 rounded-xl border border-emerald-500/30 hover:border-emerald-400/50 transition-all duration-300 hover:shadow-lg backdrop-blur-sm",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"font-medium text-emerald-200 text-sm sm:text-base flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"}),"Current Supply"]}),e.jsx("p",{className:"text-xs sm:text-sm text-emerald-300 truncate",children:"Available for trading"})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-lg sm:text-xl font-bold text-emerald-300 ml-2","data-testid":"text-current-supply",children:[H?.supply??"No data"," ",H?.supply?"kWh":""]})})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 sm:p-4 bg-gradient-to-r from-blue-900/40 to-blue-800/30 rounded-xl border border-blue-500/30 hover:border-blue-400/50 transition-all duration-300 hover:shadow-lg backdrop-blur-sm",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"font-medium text-blue-200 text-sm sm:text-base flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-pulse"}),"Current Demand"]}),e.jsx("p",{className:"text-xs sm:text-sm text-blue-300 truncate",children:"Energy needed now"})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-lg sm:text-xl font-bold text-blue-300 ml-2","data-testid":"text-current-demand",children:[H?.demand??"No data"," ",H?.demand?"kWh":""]})})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 sm:p-4 bg-gradient-to-r from-purple-900/40 to-purple-800/30 rounded-xl border border-purple-500/30 hover:border-purple-400/50 transition-all duration-300 hover:shadow-lg backdrop-blur-sm",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"font-medium text-purple-200 text-sm sm:text-base flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-pulse"}),"Grid Stability"]}),e.jsx("p",{className:"text-xs sm:text-sm text-purple-300 truncate",children:"Network balance score"})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-lg sm:text-xl font-bold text-purple-300 ml-2","data-testid":"text-grid-stability",children:[H?.gridStability??"No data",H?.gridStability?"%":""]})})]})]})]}),e.jsxs(D,{className:"p-4 sm:p-6 bg-gradient-to-br from-sky-950/60 via-blue-900/40 to-indigo-950/60 border border-sky-400/30 backdrop-blur-sm shadow-xl",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold mb-3 sm:mb-4 flex flex-col sm:flex-row sm:items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-sky-500/20 rounded-full",children:e.jsx(ft,{className:"h-4 w-4 sm:h-5 sm:w-5 text-sky-400"})}),e.jsx("span",{className:"hidden sm:inline bg-gradient-to-r from-sky-400 to-blue-300 bg-clip-text text-transparent",children:"Weather Impact"}),e.jsx("span",{className:"sm:hidden bg-gradient-to-r from-sky-400 to-blue-300 bg-clip-text text-transparent",children:"Weather"})]}),e.jsx("span",{className:"bg-green-900/30 text-green-400 px-2 py-1 rounded-full text-xs font-medium",children:"Live Weather API"})]}),e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 sm:p-4 bg-gradient-to-r from-sky-900/40 to-sky-800/30 rounded-xl border border-sky-500/30 hover:border-sky-400/50 transition-all duration-300 hover:shadow-lg backdrop-blur-sm",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"font-medium text-sky-200 text-sm sm:text-base flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-sky-400 rounded-full animate-pulse"}),"Current Conditions"]}),e.jsx("p",{className:"text-xs sm:text-sm text-sky-300 truncate",children:"Weather status"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-lg sm:text-xl font-bold text-sky-300 ml-2 capitalize","data-testid":"text-weather-condition",children:H?.weather?.condition?.replace("-"," ")||"No data"}),B&&e.jsxs("p",{className:"text-xs text-sky-400",children:[B.city,", ",B.state]})]})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 sm:p-4 bg-gradient-to-r from-orange-900/40 to-orange-800/30 rounded-xl border border-orange-500/30 hover:border-orange-400/50 transition-all duration-300 hover:shadow-lg backdrop-blur-sm",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"font-medium text-orange-200 text-sm sm:text-base flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full animate-pulse"}),"Temperature"]}),e.jsx("p",{className:"text-xs sm:text-sm text-orange-300 truncate",children:"Current temp"})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-lg sm:text-xl font-bold text-orange-300 ml-2","data-testid":"text-temperature",children:H?.weather?.temperature?`${H.weather.temperature}°C`:"No data"})})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 sm:p-4 bg-gradient-to-r from-emerald-900/40 to-emerald-800/30 rounded-xl border border-emerald-500/30 hover:border-emerald-400/50 transition-all duration-300 hover:shadow-lg backdrop-blur-sm",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"font-medium text-emerald-200 text-sm sm:text-base flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"}),"Solar Efficiency"]}),e.jsx("p",{className:"text-xs sm:text-sm text-emerald-300 truncate",children:"Power generation rate"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:`text-lg sm:text-xl font-bold ml-2 ${(H?.weather?.efficiency||0)<=0?"text-gray-400":"text-emerald-300"}`,"data-testid":"text-solar-efficiency",children:H?.weather?.efficiency!==void 0?`${Math.round(H.weather.efficiency)}%`:"No data"}),(H?.weather?.efficiency||0)<=0&&e.jsx("p",{className:"text-xs text-gray-400",children:"Night - No Solar"})]})]})]})]})]}):e.jsxs(D,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-center text-secondary-custom",children:"No Market Data Available"}),e.jsx("p",{className:"text-center text-muted-foreground",children:"Real-time market data will appear here when households are connected and trading energy."}),!C&&e.jsx("div",{className:"mt-4 p-3 bg-blue-500/10 dark:bg-blue-950/50 rounded-lg",children:e.jsx("p",{className:"text-sm text-blue-400 dark:text-blue-300 text-center",children:"Please log in to view authentic energy market data and connect your household"})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[e.jsxs(D,{className:"p-4 sm:p-6 bg-gradient-to-br from-indigo-950/40 via-indigo-900/25 to-indigo-800/30 border border-indigo-500/20 backdrop-blur-sm shadow-xl hover:shadow-2xl transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-indigo-500/20 rounded-full",children:e.jsx(Xr,{className:"h-4 w-4 sm:h-5 sm:w-5 text-indigo-400"})}),e.jsx("span",{className:"hidden sm:inline text-indigo-200",children:"Connected Households"}),e.jsx("span",{className:"sm:hidden text-indigo-200",children:"Households"})]}),e.jsx("div",{className:"w-2 h-2 bg-indigo-400 rounded-full animate-pulse"})]}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-indigo-300 mb-2","data-testid":"text-total-households",children:x?.network?.totalHouseholds||0}),e.jsxs("p",{className:"text-xs sm:text-sm text-indigo-400",children:[x?.network?.activeHouseholds||0," ","currently active"]})]}),e.jsxs(D,{className:"p-4 sm:p-6 bg-gradient-to-br from-emerald-950/40 via-emerald-900/25 to-emerald-800/30 border border-emerald-500/20 backdrop-blur-sm shadow-xl hover:shadow-2xl transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-emerald-500/20 rounded-full",children:e.jsx(ns,{className:"h-4 w-4 sm:h-5 sm:w-5 text-emerald-400"})}),e.jsx("span",{className:"hidden sm:inline text-emerald-200",children:"Battery Storage"}),e.jsx("span",{className:"sm:hidden text-emerald-200",children:"Storage"})]}),e.jsx("div",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"})]}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-emerald-300 mb-2","data-testid":"text-battery-capacity",children:he.length>0?`${he[0].batteryCapacity||0} kWh`:"0 kWh"}),e.jsx("p",{className:"text-xs sm:text-sm text-emerald-400",children:"Household battery capacity"})]}),e.jsxs(D,{className:"p-4 sm:p-6 bg-gradient-to-br from-cyan-950/40 via-cyan-900/25 to-cyan-800/30 border border-cyan-500/20 backdrop-blur-sm shadow-xl hover:shadow-2xl transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-cyan-500/20 rounded-full",children:e.jsx(zi,{className:"h-4 w-4 sm:h-5 sm:w-5 text-cyan-400"})}),e.jsx("span",{className:"hidden sm:inline text-cyan-200",children:"Network Efficiency"}),e.jsx("span",{className:"sm:hidden text-cyan-200",children:"Efficiency"})]}),e.jsx("div",{className:"w-2 h-2 bg-cyan-400 rounded-full animate-pulse"})]}),e.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-cyan-300 mb-2","data-testid":"text-network-efficiency",children:x?.efficiency?.networkEfficiency||"0%"}),e.jsxs("p",{className:"text-xs sm:text-sm text-cyan-400",children:["Avg. distance:"," ",x?.efficiency?.averageDistance||"0 km"]})]})]}),e.jsxs(D,{className:"p-6 bg-gradient-to-br from-slate-900/60 via-blue-950/40 to-slate-800/60 border border-blue-500/20 backdrop-blur-sm",children:[e.jsx("h3",{className:"text-xl font-semibold mb-6 bg-gradient-to-r from-blue-400 to-cyan-300 bg-clip-text text-transparent",children:"Getting Started with SolarSense"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-r from-blue-900/40 to-blue-800/30 rounded-xl border border-blue-500/20 hover:border-blue-400/30 transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500/20 rounded-lg flex items-center justify-center",children:e.jsx(bt,{className:"h-4 w-4 text-blue-400"})}),e.jsx("h4",{className:"font-semibold text-blue-200",children:"1. Register Your Household"})]}),e.jsx("p",{className:"text-sm text-slate-300",children:"Add your solar installation and battery details to join the energy trading network."})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-r from-emerald-900/40 to-emerald-800/30 rounded-xl border border-emerald-500/20 hover:border-emerald-400/30 transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-8 h-8 bg-emerald-500/20 rounded-lg flex items-center justify-center",children:e.jsx(st,{className:"h-4 w-4 text-emerald-400"})}),e.jsx("h4",{className:"font-semibold text-emerald-200",children:"2. Monitor Energy Flow"})]}),e.jsx("p",{className:"text-sm text-slate-300",children:"Track your energy production, consumption, and battery levels in real-time."})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-r from-purple-900/40 to-purple-800/30 rounded-xl border border-purple-500/20 hover:border-purple-400/30 transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-500/20 rounded-lg flex items-center justify-center",children:e.jsx(ts,{className:"h-4 w-4 text-purple-400"})}),e.jsx("h4",{className:"font-semibold text-purple-200",children:"3. Trade Energy"})]}),e.jsx("p",{className:"text-sm text-slate-300",children:"Buy and sell surplus energy with neighbors for optimal grid balance."})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-r from-violet-900/40 to-violet-800/30 rounded-xl border border-violet-500/20 hover:border-violet-400/30 transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-8 h-8 bg-violet-500/20 rounded-lg flex items-center justify-center",children:e.jsx(qi,{className:"h-4 w-4 text-violet-400"})}),e.jsx("h4",{className:"font-semibold text-violet-200",children:"4. AI Optimization"})]}),e.jsx("p",{className:"text-sm text-slate-300",children:"Let our AI optimize energy distribution and trading opportunities for you."})]})]})]})]},"energy-dashboard"),s==="energy-trading"&&e.jsxs(ye.div,{initial:{opacity:0,x:20,y:10},animate:{opacity:1,x:0,y:0},exit:{opacity:0,x:-20,y:-10},transition:{duration:.4,ease:"easeInOut"},className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-slate-900/60 via-blue-950/40 to-slate-800/60 rounded-xl p-3 sm:p-4 lg:p-6 border border-blue-500/20 backdrop-blur-sm shadow-2xl",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start gap-4 lg:gap-0",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:e.jsx("h2",{className:"text-xl sm:text-2xl lg:text-3xl font-bold text-white",children:"Energy Trading Marketplace"})}),e.jsx("p",{className:"text-sm sm:text-base text-slate-200 mb-3 sm:mb-4",children:"Connect directly with neighbors to trade renewable energy. Smart matching, instant transfers, fair pricing."}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 sm:gap-4 lg:gap-6 mt-4 sm:mt-6",children:[e.jsxs("div",{className:"text-center p-3 sm:p-4 bg-gradient-to-br from-blue-900/40 to-blue-800/30 rounded-xl border border-blue-500/20",children:[e.jsx("p",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-blue-300",children:mt.length}),e.jsx("p",{className:"text-xs text-blue-200",children:"Active Offers"})]}),e.jsxs("div",{className:"text-center p-3 sm:p-4 bg-gradient-to-br from-emerald-900/40 to-emerald-800/30 rounded-xl border border-emerald-500/20",children:[e.jsx("p",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-emerald-300",children:ut.length}),e.jsx("p",{className:"text-xs text-emerald-200",children:"Energy Requests"})]}),e.jsxs("div",{className:"text-center p-3 sm:p-4 bg-gradient-to-br from-purple-900/40 to-purple-800/30 rounded-xl border border-purple-500/20",children:[e.jsx("p",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-purple-300",children:x?.trading?.averagePrice||"₹0"}),e.jsx("p",{className:"text-xs text-purple-200",children:"Avg Price/kWh"})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 w-full lg:w-auto lg:flex-col",children:[e.jsxs(w,{onClick:()=>N(!0),"data-testid":"button-create-trade",className:"bg-blue-600 hover:bg-blue-700 text-white font-medium shadow-lg text-xs sm:text-sm px-3 py-2",children:[e.jsx(ca,{className:"mr-1 sm:mr-2 h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Create Trade"}),e.jsx("span",{className:"sm:hidden",children:"Create"})]}),e.jsxs(w,{variant:"outline",onClick:p,size:"sm","data-testid":"button-refresh-trades",className:"text-xs sm:text-sm px-3 py-2",disabled:a,children:[e.jsx(zt,{className:`mr-2 h-4 w-4 ${a?"animate-spin":""}`}),e.jsx("span",{className:"hidden sm:inline",children:a?"Updating...":"Refresh"}),e.jsx("span",{className:"sm:hidden",children:a?"Update":"Refresh"})]}),e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>Ae("/storage"),"data-testid":"button-your-trade",className:"text-xs sm:text-sm px-3 py-2",children:[e.jsx(ts,{className:"mr-1 sm:mr-2 h-3 w-3 sm:h-4 sm:w-4"}),(()=>{const c=Array.isArray(ee)?ee.length:0;return e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"hidden sm:inline",children:["Your Trades (",c,")"]}),e.jsxs("span",{className:"sm:hidden",children:["Trades (",c,")"]})]})})()]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs(D,{className:"p-3 sm:p-4 lg:p-6 bg-gradient-to-br from-emerald-950/40 via-emerald-900/25 to-emerald-800/30 border border-emerald-500/20 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 sm:mb-4 gap-3 sm:gap-0",children:[e.jsxs("h3",{className:"text-lg sm:text-xl font-semibold flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-emerald-500/15 rounded-full",children:e.jsx(Ie,{className:"h-4 w-4 sm:h-5 sm:w-5 text-emerald-300"})}),e.jsx("span",{className:"text-sm sm:text-base",children:"Energy Available"}),e.jsx("span",{className:"bg-emerald-500/15 text-emerald-200 px-2 py-1 rounded-full text-xs sm:text-sm font-medium",children:mt.length})]}),e.jsxs(ls,{value:Ys,onValueChange:c=>li(c),children:[e.jsx(Kt,{className:"w-full sm:w-40 text-xs sm:text-sm",children:e.jsx(os,{})}),e.jsxs(Qt,{children:[e.jsx(Pe,{value:"all",children:"All Offers"}),e.jsx(Pe,{value:"cheapest",children:"💰 Best Price"}),e.jsx(Pe,{value:"biggest",children:"⚡ Most Power"})]})]})]}),e.jsx("div",{className:"space-y-3",children:qe?e.jsx("div",{className:"space-y-3",children:[1,2,3].map(c=>e.jsxs("div",{className:"p-4 border border-slate-600/30 rounded-lg animate-pulse bg-slate-800/40",children:[e.jsx("div",{className:"h-4 bg-slate-700/50 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-slate-700/50 rounded w-1/2"})]},c))}):mt.length>0?mt.map(c=>e.jsx("div",{className:"p-3 sm:p-4 bg-gradient-to-r from-slate-800/50 to-slate-700/30 rounded-xl border border-emerald-500/30 hover:border-emerald-400/50 transition-all duration-300 hover:shadow-xl backdrop-blur-sm",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start gap-3 sm:gap-0",children:[e.jsxs("div",{className:"flex-1 w-full sm:w-auto",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-3 h-3 bg-emerald-500/100 rounded-full animate-pulse"}),e.jsxs("p",{className:"font-bold text-emerald-400 text-base sm:text-lg",children:[c.trade.energyAmount," kWh"]}),(()=>{const S=At(c.trade.status,c.acceptanceCount);return e.jsx("span",{className:`${S.className} px-2 py-1 rounded-full text-xs font-medium`,children:S.text})})(),(()=>{const S=Me(c.trade.id,c.acceptanceCount);return e.jsx("span",{className:`${S.className} px-2 py-1 rounded-full text-xs font-medium`,children:S.text})})()]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-secondary-custom mb-1",children:[e.jsx(Bt,{className:"h-4 w-4"}),e.jsx("span",{className:"truncate",children:c.household?.name||"Unknown Household"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1 sm:gap-2 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Wt,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Ludhiana, Punjab"}),e.jsx("span",{className:"sm:hidden",children:"Ludhiana"})]}),e.jsx("span",{className:"hidden sm:inline",children:"•"}),e.jsx("span",{children:new Date(c.trade.createdAt).toLocaleDateString()})]})]}),e.jsxs("div",{className:"w-full sm:w-auto sm:text-right",children:[e.jsxs("div",{className:"bg-emerald-500/10 p-2 sm:p-3 rounded-lg mb-3",children:[e.jsx("p",{className:"text-xs sm:text-sm text-secondary-custom",children:"Total"}),e.jsx("p",{className:"font-bold text-xl sm:text-2xl text-emerald-400",children:St(c.trade.energyAmount,c.trade.pricePerKwh)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Price per kWh:"," ",vt(c.trade.pricePerKwh)]})]}),dt(c.trade)?e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{size:"sm",variant:"outline",onClick:()=>La(c.trade),className:"w-full border-blue-300 text-blue-400","data-testid":`button-edit-offer-${c.trade.id}`,children:"✏️ Edit"}),e.jsx(w,{size:"sm",variant:"outline",onClick:()=>Fa(c.trade),disabled:_.isPending,className:"w-full border-red-300 text-red-700","data-testid":`button-delete-offer-${c.trade.id}`,children:"🗑️ Delete"})]}):L(c.trade.id)?e.jsx(w,{size:"sm",onClick:()=>jt(c.trade.id),disabled:P.isPending,className:"w-full bg-red-600 hover:bg-red-700 text-white","data-testid":"button-cancel-offer",children:"✕ Cancel Offer"}):I(c.trade)?e.jsxs(w,{size:"sm",onClick:()=>Ue(c),className:"w-full bg-green-600 hover:bg-green-700 text-white","data-testid":"button-accept-offer",children:[e.jsx(Nt,{className:"h-4 w-4 mr-1"}),"Accept Offer"]}):e.jsxs(w,{size:"sm",onClick:()=>{Oa(c),fs(!0)},className:"w-full h-8 bg-slate-700/60 hover:bg-slate-600/60 text-slate-200 border-slate-500/50",variant:"outline",children:[e.jsx(at,{className:"h-3 w-3 mr-1"}),"Details"]})]})]})},c.trade.id)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-500/15 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Ie,{className:"h-8 w-8 text-emerald-300"})}),e.jsx("h4",{className:"font-semibold text-primary-custom mb-2",children:"No Energy Offers Yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Be the first to sell surplus solar energy!"}),e.jsx(w,{onClick:()=>{pe.setValue("tradeType","sell"),N(!0)},size:"sm",variant:"outline",children:"Create First Offer"})]})})]}),e.jsxs(D,{className:"p-3 sm:p-4 lg:p-6 bg-gradient-to-br from-blue-950/40 via-blue-900/25 to-blue-800/30 border border-blue-500/20 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 sm:mb-4 gap-3 sm:gap-0",children:[e.jsxs("h3",{className:"text-lg sm:text-xl font-semibold flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-blue-500/15 rounded-full",children:e.jsx(ts,{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-300"})}),e.jsx("span",{className:"text-sm sm:text-base",children:"Energy Needed"}),e.jsx("span",{className:"bg-blue-500/15 text-blue-200 px-2 py-1 rounded-full text-xs sm:text-sm font-medium",children:ut.length})]}),e.jsxs(ls,{value:Gs,onValueChange:c=>oi(c),children:[e.jsx(Kt,{className:"w-full sm:w-40 text-xs sm:text-sm",children:e.jsx(os,{})}),e.jsxs(Qt,{children:[e.jsx(Pe,{value:"all",children:"All Requests"}),e.jsx(Pe,{value:"cheapest",children:"💰 Best Offer"}),e.jsx(Pe,{value:"biggest",children:"⚡ Most Power"})]})]})]}),e.jsx("div",{className:"space-y-3",children:qe?e.jsx("div",{className:"space-y-3",children:[1,2,3].map(c=>e.jsxs("div",{className:"p-4 border border-slate-600/30 rounded-lg animate-pulse bg-slate-800/40",children:[e.jsx("div",{className:"h-4 bg-slate-700/50 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-3 bg-slate-700/50 rounded w-1/2"})]},c))}):ut.length>0?ut.map(c=>e.jsx("div",{className:"p-3 sm:p-4 border-2 border-blue-500/30 rounded-xl hover:border-blue-400/50 transition-all duration-200 hover:shadow-md bg-gradient-to-r from-slate-800/50 to-slate-700/30 backdrop-blur-sm",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start gap-3 sm:gap-0",children:[e.jsxs("div",{className:"flex-1 w-full sm:w-auto",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500/100 rounded-full animate-pulse"}),e.jsxs("p",{className:"font-bold text-blue-400 text-base sm:text-lg",children:[c.trade.energyAmount," kWh"]}),(()=>{const S=At(c.trade.status,c.acceptanceCount);return e.jsx("span",{className:`${S.className} px-2 py-1 rounded-full text-xs font-medium`,children:S.text})})(),(()=>{const S=Me(c.trade.id,c.acceptanceCount);return e.jsx("span",{className:`${S.className} px-2 py-1 rounded-full text-xs font-medium`,children:S.text})})()]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-secondary-custom mb-1",children:[e.jsx(Bt,{className:"h-4 w-4"}),e.jsx("span",{className:"truncate",children:c.household?.name||"Unknown Household"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1 sm:gap-2 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Wt,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Ludhiana, Punjab"}),e.jsx("span",{className:"sm:hidden",children:"Ludhiana"})]}),e.jsx("span",{className:"hidden sm:inline",children:"•"}),e.jsx("span",{children:new Date(c.trade.createdAt).toLocaleDateString()})]})]}),e.jsxs("div",{className:"w-full sm:w-auto sm:text-right",children:[e.jsxs("div",{className:"bg-blue-500/10 p-2 sm:p-3 rounded-lg mb-3",children:[e.jsx("p",{className:"text-xs sm:text-sm text-secondary-custom",children:"Total willing to pay"}),e.jsx("p",{className:"font-bold text-xl sm:text-2xl text-blue-400",children:St(c.trade.energyAmount,c.trade.pricePerKwh)}),e.jsxs("p",{className:"text-xs text-blue-300",children:["Price per kWh:"," ",vt(c.trade.pricePerKwh)]})]}),dt(c.trade)?e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{size:"sm",variant:"outline",onClick:()=>La(c.trade),className:"w-full border-blue-300 text-blue-400","data-testid":`button-edit-request-${c.trade.id}`,children:"✏️ Edit"}),e.jsx(w,{size:"sm",variant:"outline",onClick:()=>Fa(c.trade),disabled:_.isPending,className:"w-full border-red-300 text-red-700","data-testid":`button-delete-request-${c.trade.id}`,children:"🗑️ Delete"})]}):L(c.trade.id)?e.jsx(w,{size:"sm",onClick:()=>jt(c.trade.id),disabled:P.isPending,className:"w-full bg-red-600 hover:bg-red-700 text-white","data-testid":"button-cancel-offer",children:"✕ Cancel Offer"}):I(c.trade)?e.jsxs(w,{size:"sm",onClick:()=>Ue(c),className:"w-full bg-blue-600 hover:bg-blue-700 text-white","data-testid":"button-fulfill-request",children:[e.jsx(Ie,{className:"h-4 w-4 mr-1"}),"Fulfill Request"]}):e.jsxs(w,{size:"sm",onClick:()=>{Oa(c),fs(!0)},className:"w-full h-8 bg-slate-700/60 hover:bg-slate-600/60 text-slate-200 border-slate-500/50",variant:"outline",children:[e.jsx(at,{className:"h-3 w-3 mr-1"}),"Details"]})]})]})},c.trade.id)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-500/15 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(ts,{className:"h-8 w-8 text-blue-300"})}),e.jsx("h4",{className:"font-semibold text-blue-200 mb-2",children:"No Energy Requests"}),e.jsx("p",{className:"text-sm text-blue-300 mb-4",children:"Be the first to request clean energy!"}),e.jsx(w,{onClick:()=>{pe.setValue("tradeType","buy"),N(!0)},size:"sm",variant:"outline",children:"Create First Request"})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs(D,{className:"p-3 sm:p-4 lg:p-6 bg-gradient-to-br from-purple-950/40 via-purple-900/25 to-pink-900/30 border border-purple-500/20 backdrop-blur-sm shadow-xl",children:[e.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-purple-500/20 rounded-full",children:e.jsx(rt,{className:"h-5 w-5 text-purple-400"})}),e.jsx("span",{className:"bg-gradient-to-r from-purple-400 to-pink-300 bg-clip-text text-transparent",children:"Market Insights"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gradient-to-r from-slate-800/50 to-slate-700/30 rounded-xl border border-slate-600/30 hover:border-slate-500/50 transition-all duration-300",children:[e.jsx("span",{className:"text-sm font-medium text-purple-200",children:"Peak Trading Hours"}),e.jsx("span",{className:"text-sm text-purple-300 font-semibold",children:"6PM - 10PM"})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gradient-to-r from-slate-800/50 to-slate-700/30 rounded-xl border border-slate-600/30 hover:border-slate-500/50 transition-all duration-300",children:[e.jsx("span",{className:"text-sm font-medium text-purple-200",children:"Current Market Rate"}),e.jsxs("span",{className:"text-sm text-purple-300 font-semibold",children:[x?.trading?.averagePrice||"₹0","/kWh"]})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gradient-to-r from-slate-800/50 to-slate-700/30 rounded-xl border border-slate-600/30 hover:border-slate-500/50 transition-all duration-300",children:[e.jsx("span",{className:"text-sm font-medium text-purple-200",children:"Grid Stability"}),e.jsxs("span",{className:`text-sm font-semibold ${(H?.gridStability||0)>70?"text-emerald-300":(H?.gridStability||0)>40?"text-yellow-400":"text-red-400"}`,children:[H?.gridStability||0,"%"]})]})]})]}),e.jsxs(D,{className:"p-3 sm:p-4 lg:p-6 bg-gradient-to-br from-slate-950/40 via-blue-950/25 to-slate-900/30 border border-blue-500/20 backdrop-blur-sm shadow-xl",children:[e.jsxs("h3",{className:"text-lg sm:text-xl font-semibold mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-blue-500/20 rounded-full",children:e.jsx(st,{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-400"})}),e.jsx("span",{className:"text-sm sm:text-base bg-gradient-to-r from-blue-400 to-cyan-300 bg-clip-text text-transparent",children:"How Trading Works"})]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 p-3 bg-gradient-to-r from-emerald-900/30 to-emerald-800/20 rounded-xl border border-emerald-500/20 hover:border-emerald-400/40 transition-all duration-300",children:[e.jsx("div",{className:"w-6 h-6 sm:w-8 sm:h-8 bg-emerald-500/20 rounded-full flex items-center justify-center text-emerald-400 font-bold text-xs sm:text-sm flex-shrink-0",children:"1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-xs sm:text-sm text-emerald-200",children:"Create Your Offer"}),e.jsx("p",{className:"text-xs text-emerald-400",children:"Set your energy amount and price"})]})]}),e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 p-3 bg-gradient-to-r from-blue-900/30 to-blue-800/20 rounded-xl border border-blue-500/20 hover:border-blue-400/40 transition-all duration-300",children:[e.jsx("div",{className:"w-6 h-6 sm:w-8 sm:h-8 bg-blue-500/20 rounded-full flex items-center justify-center text-blue-400 font-bold text-xs sm:text-sm flex-shrink-0",children:"2"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-xs sm:text-sm text-blue-200",children:"Smart Matching"}),e.jsx("p",{className:"text-xs text-blue-400",children:"AI finds the best local matches"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gradient-to-r from-purple-900/30 to-purple-800/20 rounded-xl border border-purple-500/20 hover:border-purple-400/40 transition-all duration-300",children:[e.jsx("div",{className:"w-6 h-6 sm:w-8 sm:h-8 bg-purple-500/20 rounded-full flex items-center justify-center text-purple-400 font-bold text-xs sm:text-sm flex-shrink-0",children:"3"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-xs sm:text-sm text-purple-200",children:"Instant Transfer"}),e.jsx("p",{className:"text-xs text-purple-400",children:"Automatic grid routing and billing"})]})]})]})]})]})]},"energy-trading"),s==="simulation"&&e.jsx(ye.div,{initial:{opacity:0,y:20,scale:.98},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.98},transition:{duration:.4,ease:"easeInOut"},className:"space-y-6",children:e.jsx(Xl,{})},"simulation")]})})," "]}),e.jsx(Tn,{}),e.jsx(ht,{open:b,onOpenChange:N,children:e.jsxs(nt,{className:"w-[calc(100vw-0.5rem)] sm:w-[90vw] max-w-md mx-auto my-1 sm:my-2 max-h-[95vh] overflow-y-auto z-50 p-4 sm:p-5 bg-slate-900 border border-slate-600/50 rounded-xl shadow-2xl",children:[e.jsxs(pt,{className:"pb-2",children:[e.jsxs(it,{className:"flex items-center gap-2 text-lg font-bold text-white dark:text-white",children:[e.jsx(ca,{className:"h-5 w-5 text-blue-400"}),"Quick Trade"]}),e.jsx(Hs,{className:"text-sm text-blue-200 dark:text-blue-200",children:"Create a new energy trade with local households"})]}),e.jsx(Os,{...pe,children:e.jsxs("form",{onSubmit:pe.handleSubmit(ni),className:"space-y-5 sm:space-y-6 pt-2 sm:pt-4",children:[e.jsxs("div",{className:"bg-gradient-to-r from-slate-800/50 to-slate-700/30 p-3 rounded-lg border border-slate-600/30",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-slate-300",children:"Market Rate:"}),e.jsxs("span",{className:"font-semibold text-blue-400",children:["₹",pe.watch("tradeType")==="sell"?Mt.selling:pe.watch("tradeType")==="buy"?Mt.buying:u,"/kWh"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm mt-1",children:[e.jsx("span",{className:"text-slate-300",children:"Range:"}),e.jsxs("span",{className:"font-semibold text-emerald-400",children:["₹",F,"-₹",$]})]})]}),e.jsx(We,{control:pe.control,name:"tradeType",render:({field:c})=>e.jsxs(Re,{children:[e.jsx(_e,{className:"text-sm font-medium text-slate-200",children:"Action Type"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(w,{type:"button",variant:c.value==="sell"?"default":"outline",size:"sm",className:`h-16 p-2 transition-all ${c.value==="sell"?"bg-emerald-600 hover:bg-emerald-700 text-white":"border-slate-600/50 hover:border-emerald-500 bg-slate-800/50 text-slate-300"}`,onClick:()=>c.onChange("sell"),"data-testid":"option-have-energy",children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx(Ie,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs font-medium",children:"SELL"})]})}),e.jsx(w,{type:"button",variant:c.value==="buy"?"default":"outline",size:"sm",className:`h-16 p-2 transition-all ${c.value==="buy"?"bg-blue-600 hover:bg-blue-700 text-white":"border-slate-600/50 hover:border-blue-500 bg-slate-800/50 text-slate-300"}`,onClick:()=>c.onChange("buy"),"data-testid":"option-need-energy",children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx(ns,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs font-medium",children:"BUY"})]})})]}),e.jsx(Be,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(We,{control:pe.control,name:"energyAmount",render:({field:c})=>e.jsxs(Re,{children:[e.jsx(_e,{className:"text-sm font-medium text-slate-200",children:"Amount (kWh)"}),e.jsx(Qe,{children:e.jsx(te,{type:"number",inputMode:"numeric",step:"1",min:"1",placeholder:"5","data-testid":"input-energy-amount",className:"h-9 bg-slate-800/70 border-slate-600/50 text-white placeholder:text-slate-400",...c,onChange:S=>c.onChange(parseInt(S.target.value)||0)})}),e.jsx(Be,{})]})}),e.jsx(We,{control:pe.control,name:"pricePerKwh",render:({field:c})=>e.jsxs(Re,{children:[e.jsx(_e,{className:"text-sm font-medium text-slate-200",children:"Price (₹/kWh)"}),e.jsx(Qe,{children:e.jsx(te,{type:"number",inputMode:"decimal",step:"0.1",min:"1",max:"500",placeholder:"6.0","data-testid":"input-price-per-kwh",className:"h-9 bg-slate-800/70 border-slate-600/50 text-white placeholder:text-slate-400",...c,onChange:S=>c.onChange(parseFloat(S.target.value)||0)})}),e.jsx(Be,{})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs(w,{type:"button",variant:"outline",size:"sm",onClick:()=>pe.setValue("pricePerKwh",F),className:"h-8 text-xs bg-slate-800/50 border-slate-600/50 hover:border-blue-500 text-slate-300","data-testid":"button-price-low",children:["Low: ₹",Math.round(F)]}),e.jsxs(w,{type:"button",variant:"outline",size:"sm",onClick:()=>pe.setValue("pricePerKwh",u),className:"h-8 text-xs bg-slate-800/50 border-slate-600/50 hover:border-emerald-500 text-slate-300","data-testid":"button-price-market",children:["Market: ₹",Math.round(u)]}),e.jsx(w,{type:"button",variant:"outline",size:"sm",onClick:()=>pe.setValue("pricePerKwh",9),className:"h-8 text-xs bg-slate-800/50 border-slate-600/50 hover:border-purple-500 text-slate-300","data-testid":"button-price-high",children:"High: ₹9"})]}),pe.watch("energyAmount")>0&&pe.watch("pricePerKwh")>0&&e.jsx("div",{className:"bg-gradient-to-r from-emerald-950/40 to-emerald-900/30 p-3 rounded-lg border border-emerald-500/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-slate-300",children:"Total Value:"}),e.jsxs("span",{className:"font-bold text-lg text-emerald-400",children:["₹",Math.round((pe.watch("energyAmount")||0)*(pe.watch("pricePerKwh")||0))]})]})}),e.jsxs("div",{className:"flex gap-2 pt-3",children:[e.jsx(w,{type:"button",variant:"outline",size:"sm",onClick:()=>N(!1),className:"flex-1 h-10 bg-slate-800/50 border-slate-600/50 text-slate-300 hover:border-red-500","data-testid":"button-cancel-trade",children:"Cancel"}),e.jsx(w,{type:"submit",size:"sm",disabled:k.isPending,className:`flex-1 h-10 font-medium text-white ${pe.watch("tradeType")==="sell"?"bg-emerald-600 hover:bg-emerald-700":"bg-blue-600 hover:bg-blue-700"}`,"data-testid":"button-submit-trade",children:k.isPending?e.jsxs(e.Fragment,{children:[e.jsx(zt,{className:"h-3 w-3 mr-1 animate-spin"}),"Creating..."]}):pe.watch("tradeType")==="sell"?"Sell Energy":pe.watch("tradeType")==="buy"?"Buy Energy":"Create Trade"})]})]})})]})}),e.jsx(ht,{open:di,onOpenChange:bs,children:e.jsxs(nt,{className:"w-[95vw] max-w-lg mx-auto my-4 max-h-[95vh] overflow-y-auto z-50 p-4 sm:p-6 bg-slate-900 border-slate-700",children:[e.jsx(pt,{children:e.jsxs(it,{className:"flex items-center gap-2 text-lg sm:text-xl font-bold text-slate-100",children:[e.jsx(Nt,{className:"h-5 w-5 sm:h-6 sm:w-6 text-emerald-400"}),"Accept Energy Trade"]})}),Le&&e.jsxs("div",{className:"space-y-4 sm:space-y-6 pt-4",children:[e.jsxs("div",{className:"bg-gradient-to-r from-emerald-950/40 to-emerald-900/30 p-3 sm:p-4 rounded-lg border border-emerald-500/20",children:[e.jsx("h4",{className:"font-semibold text-emerald-200 mb-3 text-sm sm:text-base",children:Le.trade.tradeType==="sell"?"🌟 Accept Energy Offer":"⚡ Fulfill Energy Request"}),e.jsxs("div",{className:"space-y-2 text-xs sm:text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-400",children:"Energy Amount:"}),e.jsxs("span",{className:"font-semibold text-slate-200",children:[Le.trade.energyAmount," kWh"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-400",children:"Price per kWh:"}),e.jsx("span",{className:"font-semibold text-slate-200",children:vt(Le.trade.pricePerKwh)})]}),e.jsxs("div",{className:"flex justify-between items-center border-t border-emerald-500/20 pt-2",children:[e.jsx("span",{className:"text-slate-300 font-medium",children:"Total Cost:"}),e.jsx("span",{className:"font-bold text-base sm:text-lg text-emerald-400",children:St(Le.trade.energyAmount,Le.trade.pricePerKwh)})]}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("span",{className:"text-slate-400 flex-shrink-0",children:Le.trade.tradeType==="sell"?"Seller:":"Buyer:"}),e.jsx("span",{className:"font-medium text-right ml-2 break-words text-slate-200",children:Le.trade.tradeType==="sell"?v(Le,"seller"):v(Le,"buyer")})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 p-3 sm:p-4 rounded-lg border border-slate-600/50",children:[e.jsxs("h5",{className:"font-semibold text-slate-200 mb-3 flex items-center gap-2 text-sm sm:text-base",children:[e.jsx(st,{className:"h-4 w-4"}),"What happens next?"]}),e.jsxs("div",{className:"space-y-2 text-xs sm:text-sm text-slate-300",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-emerald-400 mt-0.5",children:"•"}),e.jsx("span",{children:"Your contact information will be shared with the other party"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-emerald-400 mt-0.5",children:"•"}),e.jsx("span",{children:"You'll receive their contact details for energy transfer coordination"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-emerald-400 mt-0.5",children:"•"}),e.jsx("span",{children:"SolarSense facilitates secure peer-to-peer energy exchange"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-emerald-400 mt-0.5",children:"•"}),e.jsx("span",{children:"Trade completion is tracked for network transparency"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(w,{onClick:()=>bs(!1),variant:"outline",className:"w-full sm:flex-1 order-2 sm:order-1 bg-slate-800/50 border-slate-600/50 text-slate-300 hover:border-red-500","data-testid":"button-cancel-accept",children:"Cancel"}),e.jsx(w,{onClick:Et,disabled:Ze.isPending,className:"w-full sm:flex-1 bg-emerald-600 hover:bg-emerald-700 text-white order-1 sm:order-2","data-testid":"button-confirm-accept",children:Ze.isPending?"Processing...":Le.trade.tradeType==="sell"?"Accept Offer":"Fulfill Request"})]})]})]})}),e.jsx(ht,{open:ci,onOpenChange:fs,children:e.jsxs(nt,{className:"w-[95vw] max-w-md mx-auto my-8 max-h-[90vh] overflow-y-auto z-50",children:[e.jsx(pt,{children:e.jsxs(it,{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(Ws,{className:"h-5 w-5"}),"Contact Details"]})}),ke&&e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-2",children:ke.trade.tradeType==="sell"?"Energy Offer":"Energy Request"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Amount:"})," ",ke.trade.energyAmount," kWh"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Price:"})," ",vt(ke.trade.pricePerKwh),"/kWh"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Total Value:"})," ",St(ke.trade.energyAmount,ke.trade.pricePerKwh)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Created:"})," ",new Date(ke.trade.createdAt).toLocaleString()]})]}),e.jsxs("div",{className:"p-4 bg-blue-500/10 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"💌 Express Interest"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Click below to send an automated email expressing your interest in this trade. Your contact details will be shared with the other party."}),e.jsx(w,{className:"w-full",onClick:()=>{const c=`Energy Trade Interest - ${ke.trade.energyAmount} kWh`,S=`Hello,

I am interested in your energy ${ke.trade.tradeType==="sell"?"offer":"request"} of ${ke.trade.energyAmount} kWh at ₹${ke.trade.pricePerKwh}/kWh.

Please contact me if you are available and interested to proceed with this trade.

Best regards,
${C?.username||"Energy Trader"}`;window.open(`mailto:?subject=${encodeURIComponent(c)}&body=${encodeURIComponent(S)}`),W({title:"Email Opened",description:"Your email client has been opened with a pre-filled message. Send it to express your interest!"}),fs(!1)},"data-testid":"button-send-interest",children:"📧 Send Interest Email"})]}),e.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"📍 Location & Contact"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Area:"})," Ludhiana, Punjab",e.jsx("br",{}),e.jsx("strong",{children:"Household:"})," ",ke.trade?.tradeType==="sell"?v(ke,"seller"):v(ke,"buyer"),e.jsx("br",{}),e.jsx("strong",{children:"Contact:"})," Details shared upon mutual interest",e.jsx("br",{}),e.jsx("strong",{children:"Safety:"})," All trades are verified through SolarSense platform"]})]})]})]})}),e.jsx(ht,{open:T,onOpenChange:E,children:e.jsxs(nt,{className:"w-[95vw] max-w-md mx-auto my-8 max-h-[90vh] overflow-y-auto z-50",children:[e.jsx(pt,{children:e.jsxs(it,{className:"flex items-center gap-2 text-xl font-bold text-gray-800",children:[e.jsx($i,{className:"h-6 w-6"}),"Edit Energy Trade"]})}),e.jsx(Os,{...ve,children:e.jsxs("form",{onSubmit:ve.handleSubmit(ii),className:"space-y-6 pt-4",children:[e.jsxs("div",{className:"bg-blue-500/10 p-4 rounded-lg border border-blue-200",children:[e.jsxs("h4",{className:"font-semibold text-blue-200 mb-2 flex items-center gap-2",children:[e.jsx(rt,{className:"h-4 w-4"}),"💡 Current Market Rate"]}),e.jsxs("p",{className:"text-sm text-blue-400",children:["Market rate: ",e.jsx("strong",{children:"₹5/kWh"})," • Weather impact:"," ",e.jsx("strong",{children:"Stormy conditions reducing solar"})]})]}),e.jsx(We,{control:ve.control,name:"tradeType",render:({field:c})=>e.jsxs(Re,{children:[e.jsx(_e,{children:"What do you want to do?"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("div",{className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${c.value==="sell"?"border-emerald-500 bg-emerald-500/20 text-emerald-200":"border-slate-600/50 hover:border-slate-500/70 text-slate-300"}`,onClick:()=>c.onChange("sell"),"data-testid":"edit-option-have-energy",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:"⚡"}),e.jsx("div",{className:"font-semibold",children:"I HAVE"}),e.jsx("div",{className:"text-xs",children:"Surplus Energy"})]})}),e.jsx("div",{className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${c.value==="buy"?"border-blue-500 bg-blue-500/20 text-blue-200":"border-slate-600/50 hover:border-slate-500/70 text-slate-300"}`,onClick:()=>c.onChange("buy"),"data-testid":"edit-option-need-energy",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl mb-2",children:"🔋"}),e.jsx("div",{className:"font-semibold",children:"I NEED"}),e.jsx("div",{className:"text-xs",children:"Extra Power"})]})})]}),e.jsx(Be,{})]})}),e.jsx(We,{control:ve.control,name:"energyAmount",render:({field:c})=>e.jsxs(Re,{children:[e.jsx(_e,{children:ve.watch("tradeType")==="sell"?"How much energy do you have? (kWh)":ve.watch("tradeType")==="buy"?"How much energy do you need? (kWh)":"Energy Amount (kWh)"}),e.jsx(Qe,{children:e.jsx(te,{type:"number",step:"1",min:"1",placeholder:ve.watch("tradeType")==="sell"?"e.g., 5 (surplus to sell)":ve.watch("tradeType")==="buy"?"e.g., 3 (power needed)":"e.g., 5","data-testid":"edit-input-energy-amount",className:"w-full",...c,onChange:S=>c.onChange(parseInt(S.target.value)||0)})}),e.jsx(Be,{})]})}),e.jsx(We,{control:ve.control,name:"pricePerKwh",render:({field:c})=>e.jsxs(Re,{children:[e.jsx(_e,{className:"flex items-center gap-2",children:ve.watch("tradeType")==="sell"?"💰 Your Selling Price":ve.watch("tradeType")==="buy"?"💳 Maximum You'll Pay":"💱 Price per kWh"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx(Qe,{children:e.jsx(te,{type:"number",step:"0.1",min:"1",max:"500",placeholder:ve.watch("tradeType")==="sell"?"e.g., 5":ve.watch("tradeType")==="buy"?"e.g., 6":"e.g., 5","data-testid":"edit-input-price-per-kwh",className:"w-full",...c,onChange:S=>c.onChange(parseFloat(S.target.value)||0)})})}),e.jsx("div",{className:"flex items-center text-sm text-gray-600 bg-gray-50 px-3 rounded border",children:"₹/kWh"})]}),c.value>0&&e.jsxs("div",{className:"flex gap-2 text-xs",children:[e.jsx(w,{type:"button",variant:"outline",size:"sm",onClick:()=>c.onChange(3.8),className:"text-xs px-2 py-1",children:"Low: ₹3.8"}),e.jsx(w,{type:"button",variant:"outline",size:"sm",onClick:()=>c.onChange(5),className:"text-xs px-2 py-1",children:"Market: ₹5"}),e.jsx(w,{type:"button",variant:"outline",size:"sm",onClick:()=>c.onChange(5.2),className:"text-xs px-2 py-1",children:"Premium"})]}),c.value>0&&e.jsxs("div",{className:"text-xs text-gray-600 bg-gray-50 p-2 rounded",children:["💰 Total Value: ₹",Math.round((ve.watch("energyAmount")||0)*c.value)]})]}),e.jsx(Be,{})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-6",children:[e.jsx(w,{type:"button",variant:"outline",onClick:()=>E(!1),className:"flex-1 w-full text-red-600","data-testid":"button-cancel-edit-trade",children:"Cancel"}),e.jsx(w,{type:"submit",disabled:q.isPending,className:"flex-1 w-full","data-testid":"button-update-trade",children:q.isPending?"Updating...":ve.watch("tradeType")==="sell"?"Update Energy Offer":ve.watch("tradeType")==="buy"?"Update Energy Request":"Update Trade"})]})]})})]})}),e.jsx(eo,{isOpen:fe,onLocationGranted:Ne,onLocationDenied:J}),o&&e.jsx("div",{className:"fixed top-20 sm:top-24 md:top-28 right-2 sm:right-4 md:right-6 z-[10000] w-full max-w-xs sm:max-w-sm md:max-w-md px-2 sm:px-0",children:e.jsx(Aa,{type:d,title:d==="success"?"Logout Successful":"Server Notice",description:h,onClose:()=>m(!1)})})]})}function so(){const{user:s}=ct(),t=l.useRef(null),a=l.useRef(null),r=l.useRef(null),n=l.useRef(null),i=l.useRef(null),o=l.useRef(null),m=l.useRef(null),h=l.useRef(null),f=l.useRef(null),d=et(t,{once:!0,margin:"-100px"}),y=et(a,{once:!0,margin:"-100px"}),b=et(r,{once:!0,margin:"-100px"}),N=et(n,{once:!0,margin:"-100px"});et(i,{once:!0,margin:"-100px"});const T=et(o,{once:!0,margin:"-100px"}),E=et(m,{once:!0,margin:"-50px"}),K=et(h,{once:!0,margin:"-50px"}),G=et(f,{once:!0,margin:"-50px"});return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:[e.jsx(Tt,{currentPage:"about"}),e.jsxs("div",{className:"max-w-6xl mx-auto px-3 sm:px-4 lg:px-8 py-4 sm:py-6 md:py-8 lg:py-12 pt-20 sm:pt-24 md:pt-28 lg:pt-32",children:[e.jsxs(ye.div,{ref:t,className:"text-center mb-6 sm:mb-8 lg:mb-12",initial:{opacity:0,y:-50},animate:d?{opacity:1,y:0}:{opacity:0,y:-50},transition:{duration:.8,ease:"easeOut"},children:[e.jsx("h2",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent mb-3 sm:mb-4",children:"About SolarSense"}),e.jsx("p",{className:"text-sm sm:text-base lg:text-lg text-gray-300 max-w-2xl mx-auto px-2 sm:px-4 lg:px-0 leading-relaxed",children:"Intelligent Energy Solutions for a Sustainable Future. A decentralized, resilient, and equitable energy trading platform powered by AI."})]}),e.jsx(ye.div,{ref:a,initial:{opacity:0,x:-100},animate:y?{opacity:1,x:0}:{opacity:0,x:-100},transition:{duration:.8,ease:"easeOut"},children:e.jsxs(D,{className:"mb-4 sm:mb-6 lg:mb-8 bg-slate-800/50 border-slate-700/50 backdrop-blur-sm shadow-2xl",children:[e.jsx(se,{className:"pb-3 sm:pb-4 md:pb-6 px-4 sm:px-6",children:e.jsxs(le,{className:"flex items-center text-lg sm:text-xl lg:text-2xl text-gray-100",children:[e.jsx(Ie,{className:"mr-2 text-blue-400",size:20}),"What We Do"]})}),e.jsxs(U,{className:"pt-0 px-4 sm:px-6",children:[e.jsx("p",{className:"text-gray-300 mb-4 sm:mb-6 text-sm sm:text-base leading-relaxed",children:"SolarSense connects households with solar panels into a decentralized energy trading network. Our AI-powered platform intelligently manages energy flow, prevents grid overload, and ensures fair distribution—keeping the lights on even during challenging conditions. Using advanced machine learning algorithms, we predict energy generation, forecast demand, and facilitate automated trading between energy producers and consumers."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4 lg:gap-6",children:[e.jsx(ye.div,{ref:m,className:"relative",initial:{opacity:0,y:50},animate:E?{opacity:1,y:0}:{opacity:0,y:50},transition:{duration:.6,ease:"easeOut"},whileHover:{scale:1.05,y:-5},children:e.jsxs("div",{className:"bg-gradient-to-br from-blue-900/40 to-blue-800/40 rounded-lg p-4 sm:p-6 border border-blue-500/30 hover:shadow-lg hover:border-blue-400/50 transition-all duration-300 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-400 rounded-full mr-2 animate-pulse"}),e.jsx("h4",{className:"font-semibold text-gray-100",children:"Predictive Energy Generation"})]}),e.jsx("p",{className:"text-sm text-gray-300 mb-4",children:"ML algorithms predict solar output based on weather patterns, time of day, and seasonal variations, enabling optimal energy planning and trading decisions."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-4 text-xs text-blue-300",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-300 rounded-full mr-1"}),e.jsx("span",{children:"Weather Analysis"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full mr-1"}),e.jsx("span",{children:"Solar Forecasting"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mr-1"}),e.jsx("span",{children:"Demand Prediction"})]})]})]})}),e.jsx(ye.div,{ref:h,className:"relative",initial:{opacity:0,y:50},animate:K?{opacity:1,y:0}:{opacity:0,y:50},transition:{duration:.6,delay:.2,ease:"easeOut"},whileHover:{scale:1.05,y:-5},children:e.jsxs("div",{className:"bg-gradient-to-br from-green-900/40 to-green-800/40 rounded-lg p-4 sm:p-6 border border-green-500/30 hover:shadow-lg hover:border-green-400/50 transition-all duration-300 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full mr-2 animate-pulse"}),e.jsx("h4",{className:"font-semibold text-gray-100",children:"Intelligent Trading Network"})]}),e.jsx("p",{className:"text-sm text-gray-300 mb-4",children:"Automated matching of energy suppliers and consumers based on proximity, capacity, and pricing, creating a fair and efficient decentralized marketplace."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-4 text-xs text-green-300",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 bg-green-300 rounded-full mr-1"}),e.jsx("span",{children:"Smart Matching"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full mr-1"}),e.jsx("span",{children:"Fair Pricing"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-1"}),e.jsx("span",{children:"Local Trading"})]})]})]})}),e.jsx(ye.div,{ref:f,className:"relative",initial:{opacity:0,y:50},animate:G?{opacity:1,y:0}:{opacity:0,y:50},transition:{duration:.6,delay:.4,ease:"easeOut"},whileHover:{scale:1.05,y:-5},children:e.jsxs("div",{className:"bg-gradient-to-br from-purple-900/40 to-purple-800/40 rounded-lg p-4 sm:p-6 border border-purple-500/30 hover:shadow-lg hover:border-purple-400/50 transition-all duration-300 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("div",{className:"w-3 h-3 bg-purple-400 rounded-full mr-2 animate-pulse"}),e.jsx("h4",{className:"font-semibold text-gray-100",children:"Battery Optimization"})]}),e.jsx("p",{className:"text-sm text-gray-300 mb-4",children:"ML-driven charge and discharge strategies for maximum grid stability, ensuring optimal energy storage utilization across the network during peak and off-peak hours."}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-4 text-xs text-purple-300",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-300 rounded-full mr-1"}),e.jsx("span",{children:"Smart Charging"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-400 rounded-full mr-1"}),e.jsx("span",{children:"Grid Stability"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full mr-1"}),e.jsx("span",{children:"Peak Management"})]})]})]})})]})]})]})}),e.jsx(ye.div,{ref:r,initial:{opacity:0,x:100},animate:b?{opacity:1,x:0}:{opacity:0,x:100},transition:{duration:.8,ease:"easeOut"},children:e.jsxs(D,{className:"mb-4 sm:mb-6 lg:mb-8 bg-slate-800/50 border-slate-700/50 backdrop-blur-sm shadow-2xl",children:[e.jsx(se,{className:"pb-4 sm:pb-6",children:e.jsxs(le,{className:"flex items-center text-base sm:text-lg lg:text-xl text-gray-100",children:[e.jsx(Ts,{className:"mr-2 text-blue-400",size:18}),"Platform Capabilities"]})}),e.jsx(U,{className:"pt-0",children:e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-3 sm:gap-4 lg:gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative w-16 h-16 mx-auto mb-4",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-400 to-blue-600 rounded-lg transform rotate-3"}),e.jsx("div",{className:"relative bg-white rounded-lg p-3 shadow-sm border border-blue-200",children:e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-50 to-blue-100 rounded flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 font-bold text-lg",children:"AI"})})})]}),e.jsx("h4",{className:"font-semibold mb-2 text-gray-100",children:"Google Gemini AI"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Powered by Google's Gemini AI for intelligent energy optimization and real-time market insights"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative w-16 h-16 mx-auto mb-4",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-green-400 to-green-600 rounded-lg transform -rotate-3"}),e.jsx("div",{className:"relative bg-white rounded-lg p-3 shadow-sm border border-green-200",children:e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-green-50 to-green-100 rounded flex items-center justify-center",children:e.jsx(rt,{className:"h-6 w-6 text-green-600"})})})]}),e.jsx("h4",{className:"font-semibold mb-2 text-gray-100",children:"Real-time Analytics"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Live market data, energy flow monitoring, and performance metrics updated every 10 seconds"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative w-16 h-16 mx-auto mb-4",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-400 to-purple-600 rounded-lg transform rotate-1"}),e.jsx("div",{className:"relative bg-white rounded-lg p-3 shadow-sm border border-purple-200",children:e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-purple-50 to-purple-100 rounded flex items-center justify-center",children:e.jsx(Ws,{className:"h-6 w-6 text-purple-600"})})})]}),e.jsx("h4",{className:"font-semibold mb-2 text-gray-100",children:"AI Chat Assistant"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Interactive AI assistant providing energy optimization advice and trading strategies"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative w-16 h-16 mx-auto mb-4",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-400 to-indigo-600 rounded-lg transform -rotate-2"}),e.jsx("div",{className:"relative bg-white rounded-lg p-3 shadow-sm border border-indigo-200",children:e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-indigo-50 to-indigo-100 rounded flex items-center justify-center",children:e.jsx(Vi,{className:"h-6 w-6 text-indigo-600"})})})]}),e.jsx("h4",{className:"font-semibold mb-2 text-gray-100",children:"Grid Simulation"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Live demonstration platform with weather adaptation and outage response testing"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative w-16 h-16 mx-auto mb-4",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-400 to-amber-600 rounded-lg transform rotate-2"}),e.jsx("div",{className:"relative bg-white rounded-lg p-3 shadow-sm border border-amber-200",children:e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-amber-50 to-amber-100 rounded flex items-center justify-center",children:e.jsx(is,{className:"h-6 w-6 text-amber-600"})})})]}),e.jsx("h4",{className:"font-semibold mb-2 text-gray-100",children:"Weather Integration"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Real-time weather data integration for accurate solar generation forecasting"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative w-16 h-16 mx-auto mb-4",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-teal-400 to-teal-600 rounded-lg transform -rotate-1"}),e.jsx("div",{className:"relative bg-white rounded-lg p-3 shadow-sm border border-teal-200",children:e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-teal-50 to-teal-100 rounded flex items-center justify-center",children:e.jsx(ns,{className:"h-6 w-6 text-teal-600"})})})]}),e.jsx("h4",{className:"font-semibold mb-2 text-gray-100",children:"Battery Management"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Intelligent battery optimization with charge/discharge scheduling for maximum efficiency"})]})]})})]})}),e.jsx(ye.div,{ref:n,initial:{opacity:0,y:100},animate:N?{opacity:1,y:0}:{opacity:0,y:100},transition:{duration:.8,ease:"easeOut"},children:e.jsxs(D,{className:"mb-4 sm:mb-6 lg:mb-8 bg-slate-800/50 border-slate-700/50 backdrop-blur-sm shadow-2xl",children:[e.jsx(se,{className:"pb-4 sm:pb-6",children:e.jsxs(le,{className:"flex items-center text-base sm:text-lg lg:text-xl text-gray-100",children:[e.jsx(ft,{className:"mr-2 text-blue-400",size:18}),"Technology Stack"]})}),e.jsx(U,{className:"pt-0",children:e.jsxs("div",{className:"relative bg-gradient-to-br from-slate-900/80 to-slate-800/80 rounded-lg p-4 sm:p-6 border border-slate-600/50 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex flex-col items-center mb-6 sm:mb-8",children:[e.jsxs("div",{className:"text-center mb-3 sm:mb-4",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-100 mb-2",children:"Frontend Layer"}),e.jsx("div",{className:"w-20 sm:w-24 h-1 bg-gradient-to-r from-blue-400 to-blue-600 rounded mx-auto"})]}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-2 sm:gap-3",children:[e.jsxs("div",{className:"flex items-center bg-slate-800/80 rounded-full px-3 sm:px-4 py-1.5 sm:py-2 shadow-md border border-blue-400/50 transform hover:scale-105 transition-transform backdrop-blur-sm hover:border-blue-300/70",children:[e.jsx("div",{className:"w-2.5 sm:w-3 h-2.5 sm:h-3 bg-blue-400 rounded-full mr-1.5 sm:mr-2 animate-pulse"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-100",children:"React 18"})]}),e.jsxs("div",{className:"flex items-center bg-slate-800/80 rounded-full px-3 sm:px-4 py-1.5 sm:py-2 shadow-md border border-blue-500/50 transform hover:scale-105 transition-transform backdrop-blur-sm hover:border-blue-400/70",children:[e.jsx("div",{className:"w-2.5 sm:w-3 h-2.5 sm:h-3 bg-blue-500 rounded-full mr-1.5 sm:mr-2 animate-pulse",style:{animationDelay:"0.2s"}}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-100",children:"TypeScript"})]}),e.jsxs("div",{className:"flex items-center bg-slate-800/80 rounded-full px-3 sm:px-4 py-1.5 sm:py-2 shadow-md border border-cyan-400/50 transform hover:scale-105 transition-transform backdrop-blur-sm hover:border-cyan-300/70",children:[e.jsx("div",{className:"w-2.5 sm:w-3 h-2.5 sm:h-3 bg-cyan-400 rounded-full mr-1.5 sm:mr-2 animate-pulse",style:{animationDelay:"0.4s"}}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-100",children:"Tailwind CSS"})]}),e.jsxs("div",{className:"flex items-center bg-slate-800/80 rounded-full px-3 sm:px-4 py-1.5 sm:py-2 shadow-md border border-indigo-400/50 transform hover:scale-105 transition-transform backdrop-blur-sm hover:border-indigo-300/70",children:[e.jsx("div",{className:"w-2.5 sm:w-3 h-2.5 sm:h-3 bg-indigo-400 rounded-full mr-1.5 sm:mr-2 animate-pulse",style:{animationDelay:"0.6s"}}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-100",children:"shadcn/ui"})]})]})]}),e.jsx("div",{className:"flex justify-center mb-6 sm:mb-8",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-0.5 h-6 sm:h-8 bg-gradient-to-b from-blue-400 to-green-400"}),e.jsx("div",{className:"w-2.5 sm:w-3 h-2.5 sm:h-3 bg-green-400 rounded-full animate-bounce"}),e.jsx("div",{className:"w-0.5 h-6 sm:h-8 bg-gradient-to-b from-green-400 to-green-600"})]})}),e.jsxs("div",{className:"flex flex-col items-center mb-6 sm:mb-8",children:[e.jsxs("div",{className:"text-center mb-3 sm:mb-4",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-100 mb-2",children:"Backend Layer"}),e.jsx("div",{className:"w-20 sm:w-24 h-1 bg-gradient-to-r from-green-400 to-green-600 rounded mx-auto"})]}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-2 sm:gap-3",children:[e.jsxs("div",{className:"flex items-center bg-slate-800/80 rounded-full px-3 sm:px-4 py-1.5 sm:py-2 shadow-md border border-green-400/50 transform hover:scale-105 transition-transform backdrop-blur-sm hover:border-green-300/70",children:[e.jsx("div",{className:"w-2.5 sm:w-3 h-2.5 sm:h-3 bg-green-400 rounded-full mr-1.5 sm:mr-2 animate-pulse"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-100",children:"Node.js"})]}),e.jsxs("div",{className:"flex items-center bg-slate-800/80 rounded-full px-3 sm:px-4 py-1.5 sm:py-2 shadow-md border border-gray-400/50 transform hover:scale-105 transition-transform backdrop-blur-sm hover:border-gray-300/70",children:[e.jsx("div",{className:"w-2.5 sm:w-3 h-2.5 sm:h-3 bg-gray-400 rounded-full mr-1.5 sm:mr-2 animate-pulse",style:{animationDelay:"0.2s"}}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-100",children:"Express.js"})]}),e.jsxs("div",{className:"flex items-center bg-slate-800/80 rounded-full px-3 sm:px-4 py-1.5 sm:py-2 shadow-md border border-blue-400/50 transform hover:scale-105 transition-transform backdrop-blur-sm hover:border-blue-300/70",children:[e.jsx("div",{className:"w-2.5 sm:w-3 h-2.5 sm:h-3 bg-blue-400 rounded-full mr-1.5 sm:mr-2 animate-pulse",style:{animationDelay:"0.4s"}}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-100",children:"PostgreSQL"})]}),e.jsxs("div",{className:"flex items-center bg-slate-800/80 rounded-full px-3 sm:px-4 py-1.5 sm:py-2 shadow-md border border-blue-500/50 transform hover:scale-105 transition-transform backdrop-blur-sm hover:border-blue-400/70",children:[e.jsx("div",{className:"w-2.5 sm:w-3 h-2.5 sm:h-3 bg-blue-500 rounded-full mr-1.5 sm:mr-2 animate-pulse",style:{animationDelay:"0.6s"}}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-100",children:"Drizzle ORM"})]})]})]}),e.jsx("div",{className:"flex justify-center mb-6 sm:mb-8",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-0.5 h-6 sm:h-8 bg-gradient-to-b from-green-400 to-purple-400"}),e.jsx("div",{className:"w-2.5 sm:w-3 h-2.5 sm:h-3 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0.5s"}}),e.jsx("div",{className:"w-0.5 h-6 sm:h-8 bg-gradient-to-b from-purple-400 to-purple-600"})]})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"text-center mb-3 sm:mb-4",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-100 mb-2",children:"AI & Services"}),e.jsx("div",{className:"w-20 sm:w-24 h-1 bg-gradient-to-r from-purple-400 to-purple-600 rounded mx-auto"})]}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-2 sm:gap-3",children:[e.jsxs("div",{className:"flex items-center bg-slate-800/80 rounded-full px-3 sm:px-4 py-1.5 sm:py-2 shadow-md border border-purple-400/50 transform hover:scale-105 transition-transform backdrop-blur-sm hover:border-purple-300/70",children:[e.jsx("div",{className:"w-2.5 sm:w-3 h-2.5 sm:h-3 bg-purple-400 rounded-full mr-1.5 sm:mr-2 animate-pulse"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-100",children:"Google Gemini AI"})]}),e.jsxs("div",{className:"flex items-center bg-slate-800/80 rounded-full px-3 sm:px-4 py-1.5 sm:py-2 shadow-md border border-amber-400/50 transform hover:scale-105 transition-transform backdrop-blur-sm hover:border-amber-300/70",children:[e.jsx("div",{className:"w-2.5 sm:w-3 h-2.5 sm:h-3 bg-amber-400 rounded-full mr-1.5 sm:mr-2 animate-pulse",style:{animationDelay:"0.2s"}}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-100",children:"Weather API"})]}),e.jsxs("div",{className:"flex items-center bg-slate-800/80 rounded-full px-3 sm:px-4 py-1.5 sm:py-2 shadow-md border border-teal-400/50 transform hover:scale-105 transition-transform backdrop-blur-sm hover:border-teal-300/70",children:[e.jsx("div",{className:"w-2.5 sm:w-3 h-2.5 sm:h-3 bg-teal-400 rounded-full mr-1.5 sm:mr-2 animate-pulse",style:{animationDelay:"0.4s"}}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-gray-100",children:"ML Algorithms"})]})]})]})]})})]})}),e.jsx(ye.div,{className:"mb-4 sm:mb-6 lg:mb-8",initial:{opacity:0,x:-100},animate:{opacity:1,x:0},transition:{duration:.8,ease:"easeOut"},children:e.jsxs(D,{className:"bg-slate-800/50 border-slate-700/50 backdrop-blur-sm shadow-2xl",children:[e.jsx(se,{className:"pb-4 sm:pb-6",children:e.jsxs(le,{className:"flex items-center text-base sm:text-lg lg:text-xl text-gray-100",children:[e.jsx(Ts,{className:"mr-2 text-blue-400",size:18}),"Enhanced Security Features"]})}),e.jsxs(U,{className:"pt-0",children:[e.jsxs("div",{className:"bg-gradient-to-br from-red-900/40 to-blue-900/40 rounded-lg p-4 sm:p-6 border border-red-500/30 mb-6 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("div",{className:"w-3 h-3 bg-red-400 rounded-full mr-2 animate-pulse"}),e.jsx("h4",{className:"font-semibold text-gray-100",children:"Latest Security Enhancements"})]}),e.jsx("p",{className:"text-sm text-gray-300 mb-4",children:"Recent critical security improvements ensure maximum protection for user data and platform integrity with industry-standard encryption and validation protocols."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-900/40 to-emerald-900/40 rounded-lg p-4 sm:p-6 border border-green-500/30 backdrop-blur-sm hover:border-green-400/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx(Pt,{className:"h-5 w-5 text-green-400 mr-2"}),e.jsx("h4",{className:"font-semibold text-gray-100",children:"bcrypt Password Hashing"})]}),e.jsx("p",{className:"text-sm text-gray-300 mb-3",children:"Military-grade password protection with 12 salt rounds, replacing previous plain text storage for maximum security."}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx(X,{variant:"secondary",className:"text-xs bg-green-900/50 text-green-300 border-green-500/30",children:"12 Salt Rounds"}),e.jsx(X,{variant:"secondary",className:"text-xs bg-green-900/50 text-green-300 border-green-500/30",children:"Secure Storage"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-900/40 to-indigo-900/40 rounded-lg p-4 sm:p-6 border border-blue-500/30 backdrop-blur-sm hover:border-blue-400/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx(Wi,{className:"h-5 w-5 text-blue-400 mr-2"}),e.jsx("h4",{className:"font-semibold text-gray-100",children:"Input Validation & Sanitization"})]}),e.jsx("p",{className:"text-sm text-gray-300 mb-3",children:"Comprehensive backend validation using Zod schemas with input sanitization to prevent malicious data injection."}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx(X,{variant:"secondary",className:"text-xs bg-blue-900/50 text-blue-300 border-blue-500/30",children:"Zod Validation"}),e.jsx(X,{variant:"secondary",className:"text-xs bg-blue-900/50 text-blue-300 border-blue-500/30",children:"Data Sanitization"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-900/40 to-pink-900/40 rounded-lg p-4 sm:p-6 border border-purple-500/30 backdrop-blur-sm hover:border-purple-400/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx(Ds,{className:"h-5 w-5 text-purple-400 mr-2"}),e.jsx("h4",{className:"font-semibold text-gray-100",children:"Secure Session Management"})]}),e.jsx("p",{className:"text-sm text-gray-300 mb-3",children:"Cryptographically secure session IDs generated using crypto.randomBytes for enhanced authentication security."}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx(X,{variant:"secondary",className:"text-xs bg-purple-900/50 text-purple-300 border-purple-500/30",children:"Crypto.randomBytes"}),e.jsx(X,{variant:"secondary",className:"text-xs bg-purple-900/50 text-purple-300 border-purple-500/30",children:"Secure Sessions"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-amber-900/40 to-yellow-900/40 rounded-lg p-4 sm:p-6 border border-amber-500/30 backdrop-blur-sm hover:border-amber-400/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx(Xr,{className:"h-5 w-5 text-amber-400 mr-2"}),e.jsx("h4",{className:"font-semibold text-gray-100",children:"Duplicate Protection"})]}),e.jsx("p",{className:"text-sm text-gray-300 mb-3",children:"Advanced username and email duplicate checking with specific error messages to prevent account conflicts."}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx(X,{variant:"secondary",className:"text-xs bg-amber-900/50 text-amber-300 border-amber-500/30",children:"Username Check"}),e.jsx(X,{variant:"secondary",className:"text-xs bg-amber-900/50 text-amber-300 border-amber-500/30",children:"Email Validation"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-teal-900/40 to-cyan-900/40 rounded-lg p-4 sm:p-6 border border-teal-500/30 backdrop-blur-sm hover:border-teal-400/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx(Ts,{className:"h-5 w-5 text-teal-400 mr-2"}),e.jsx("h4",{className:"font-semibold text-gray-100",children:"Email Security"})]}),e.jsx("p",{className:"text-sm text-gray-300 mb-3",children:"Temporary email domain blocking and comprehensive email validation to ensure authentic user registration."}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx(X,{variant:"secondary",className:"text-xs bg-teal-900/50 text-teal-300 border-teal-500/30",children:"Domain Blocking"}),e.jsx(X,{variant:"secondary",className:"text-xs bg-teal-900/50 text-teal-300 border-teal-500/30",children:"Format Validation"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-slate-900/40 to-slate-800/40 rounded-lg p-4 sm:p-6 border border-slate-600/30 backdrop-blur-sm hover:border-slate-500/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx(Pt,{className:"h-5 w-5 text-slate-400 mr-2"}),e.jsx("h4",{className:"font-semibold text-gray-100",children:"Authentication Protection"})]}),e.jsx("p",{className:"text-sm text-gray-300 mb-3",children:"Complete authentication security with secure cookie handling, session persistence, and proper logout functionality."}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx(X,{variant:"secondary",className:"text-xs bg-slate-800/50 text-slate-300 border-slate-600/30",children:"Secure Cookies"}),e.jsx(X,{variant:"secondary",className:"text-xs bg-slate-800/50 text-slate-300 border-slate-600/30",children:"Session Security"})]})]})]})]})]})}),e.jsx(ye.div,{ref:o,className:"text-center",initial:{opacity:0,scale:.8},animate:T?{opacity:1,scale:1}:{opacity:0,scale:.8},transition:{duration:.6,ease:"easeOut"},children:e.jsx(w,{asChild:!0,size:"lg",className:"bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white px-6 sm:px-8 py-2 sm:py-3 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105",children:e.jsxs(Te,{href:"/",children:[e.jsx(da,{className:"mr-2 h-4 w-4"}),"Back to Energy Dashboard"]})})})]}),e.jsx(Tn,{})]})}const pa=l.forwardRef(({className:s,...t},a)=>e.jsx(Fr,{ref:a,className:A("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...t}));pa.displayName=Fr.displayName;const ao=l.forwardRef(({className:s,...t},a)=>e.jsx(Or,{ref:a,className:A("aspect-square h-full w-full",s),...t}));ao.displayName=Or.displayName;const ga=l.forwardRef(({className:s,...t},a)=>e.jsx(Rr,{ref:a,className:A("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...t}));ga.displayName=Rr.displayName;const Ln=6048e5,ro=864e5,Ga=Symbol.for("constructDateFrom");function yt(s,t){return typeof s=="function"?s(t):s&&typeof s=="object"&&Ga in s?s[Ga](t):s instanceof Date?new s.constructor(t):new Date(t)}function Xe(s,t){return yt(t||s,s)}let no={};function Ks(){return no}function cs(s,t){const a=Ks(),r=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,n=Xe(s,t?.in),i=n.getDay(),o=(i<r?7:0)+i-r;return n.setDate(n.getDate()-o),n.setHours(0,0,0,0),n}function Rs(s,t){return cs(s,{...t,weekStartsOn:1})}function Fn(s,t){const a=Xe(s,t?.in),r=a.getFullYear(),n=yt(a,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const i=Rs(n),o=yt(a,0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);const m=Rs(o);return a.getTime()>=i.getTime()?r+1:a.getTime()>=m.getTime()?r:r-1}function Xa(s){const t=Xe(s),a=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return a.setUTCFullYear(t.getFullYear()),+s-+a}function io(s,...t){const a=yt.bind(null,t.find(r=>typeof r=="object"));return t.map(a)}function Ja(s,t){const a=Xe(s,t?.in);return a.setHours(0,0,0,0),a}function lo(s,t,a){const[r,n]=io(a?.in,s,t),i=Ja(r),o=Ja(n),m=+i-Xa(i),h=+o-Xa(o);return Math.round((m-h)/ro)}function oo(s,t){const a=Fn(s,t),r=yt(s,0);return r.setFullYear(a,0,4),r.setHours(0,0,0,0),Rs(r)}function co(s){return s instanceof Date||typeof s=="object"&&Object.prototype.toString.call(s)==="[object Date]"}function mo(s){return!(!co(s)&&typeof s!="number"||isNaN(+Xe(s)))}function uo(s,t){const a=Xe(s,t?.in);return a.setFullYear(a.getFullYear(),0,1),a.setHours(0,0,0,0),a}const xo={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},ho=(s,t,a)=>{let r;const n=xo[s];return typeof n=="string"?r=n:t===1?r=n.one:r=n.other.replace("{{count}}",t.toString()),a?.addSuffix?a.comparison&&a.comparison>0?"in "+r:r+" ago":r};function ta(s){return(t={})=>{const a=t.width?String(t.width):s.defaultWidth;return s.formats[a]||s.formats[s.defaultWidth]}}const po={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},go={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},fo={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},bo={date:ta({formats:po,defaultWidth:"full"}),time:ta({formats:go,defaultWidth:"full"}),dateTime:ta({formats:fo,defaultWidth:"full"})},yo={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},jo=(s,t,a,r)=>yo[s];function ss(s){return(t,a)=>{const r=a?.context?String(a.context):"standalone";let n;if(r==="formatting"&&s.formattingValues){const o=s.defaultFormattingWidth||s.defaultWidth,m=a?.width?String(a.width):o;n=s.formattingValues[m]||s.formattingValues[o]}else{const o=s.defaultWidth,m=a?.width?String(a.width):s.defaultWidth;n=s.values[m]||s.values[o]}const i=s.argumentCallback?s.argumentCallback(t):t;return n[i]}}const wo={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},No={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},vo={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},So={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Po={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},To={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Co=(s,t)=>{const a=Number(s),r=a%100;if(r>20||r<10)switch(r%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd"}return a+"th"},ko={ordinalNumber:Co,era:ss({values:wo,defaultWidth:"wide"}),quarter:ss({values:No,defaultWidth:"wide",argumentCallback:s=>s-1}),month:ss({values:vo,defaultWidth:"wide"}),day:ss({values:So,defaultWidth:"wide"}),dayPeriod:ss({values:Po,defaultWidth:"wide",formattingValues:To,defaultFormattingWidth:"wide"})};function as(s){return(t,a={})=>{const r=a.width,n=r&&s.matchPatterns[r]||s.matchPatterns[s.defaultMatchWidth],i=t.match(n);if(!i)return null;const o=i[0],m=r&&s.parsePatterns[r]||s.parsePatterns[s.defaultParseWidth],h=Array.isArray(m)?Ao(m,y=>y.test(o)):Io(m,y=>y.test(o));let f;f=s.valueCallback?s.valueCallback(h):h,f=a.valueCallback?a.valueCallback(f):f;const d=t.slice(o.length);return{value:f,rest:d}}}function Io(s,t){for(const a in s)if(Object.prototype.hasOwnProperty.call(s,a)&&t(s[a]))return a}function Ao(s,t){for(let a=0;a<s.length;a++)if(t(s[a]))return a}function Eo(s){return(t,a={})=>{const r=t.match(s.matchPattern);if(!r)return null;const n=r[0],i=t.match(s.parsePattern);if(!i)return null;let o=s.valueCallback?s.valueCallback(i[0]):i[0];o=a.valueCallback?a.valueCallback(o):o;const m=t.slice(n.length);return{value:o,rest:m}}}const Do=/^(\d+)(th|st|nd|rd)?/i,Mo=/\d+/i,Lo={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Fo={any:[/^b/i,/^(a|c)/i]},Oo={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Ro={any:[/1/i,/2/i,/3/i,/4/i]},_o={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Bo={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},zo={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},qo={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},$o={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Vo={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Wo={ordinalNumber:Eo({matchPattern:Do,parsePattern:Mo,valueCallback:s=>parseInt(s,10)}),era:as({matchPatterns:Lo,defaultMatchWidth:"wide",parsePatterns:Fo,defaultParseWidth:"any"}),quarter:as({matchPatterns:Oo,defaultMatchWidth:"wide",parsePatterns:Ro,defaultParseWidth:"any",valueCallback:s=>s+1}),month:as({matchPatterns:_o,defaultMatchWidth:"wide",parsePatterns:Bo,defaultParseWidth:"any"}),day:as({matchPatterns:zo,defaultMatchWidth:"wide",parsePatterns:qo,defaultParseWidth:"any"}),dayPeriod:as({matchPatterns:$o,defaultMatchWidth:"any",parsePatterns:Vo,defaultParseWidth:"any"})},Ho={code:"en-US",formatDistance:ho,formatLong:bo,formatRelative:jo,localize:ko,match:Wo,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Uo(s,t){const a=Xe(s,t?.in);return lo(a,uo(a))+1}function Ko(s,t){const a=Xe(s,t?.in),r=+Rs(a)-+oo(a);return Math.round(r/Ln)+1}function On(s,t){const a=Xe(s,t?.in),r=a.getFullYear(),n=Ks(),i=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,o=yt(t?.in||s,0);o.setFullYear(r+1,0,i),o.setHours(0,0,0,0);const m=cs(o,t),h=yt(t?.in||s,0);h.setFullYear(r,0,i),h.setHours(0,0,0,0);const f=cs(h,t);return+a>=+m?r+1:+a>=+f?r:r-1}function Qo(s,t){const a=Ks(),r=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,n=On(s,t),i=yt(t?.in||s,0);return i.setFullYear(n,0,r),i.setHours(0,0,0,0),cs(i,t)}function Yo(s,t){const a=Xe(s,t?.in),r=+cs(a,t)-+Qo(a,t);return Math.round(r/Ln)+1}function Y(s,t){const a=s<0?"-":"",r=Math.abs(s).toString().padStart(t,"0");return a+r}const xt={y(s,t){const a=s.getFullYear(),r=a>0?a:1-a;return Y(t==="yy"?r%100:r,t.length)},M(s,t){const a=s.getMonth();return t==="M"?String(a+1):Y(a+1,2)},d(s,t){return Y(s.getDate(),t.length)},a(s,t){const a=s.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return a.toUpperCase();case"aaa":return a;case"aaaaa":return a[0];default:return a==="am"?"a.m.":"p.m."}},h(s,t){return Y(s.getHours()%12||12,t.length)},H(s,t){return Y(s.getHours(),t.length)},m(s,t){return Y(s.getMinutes(),t.length)},s(s,t){return Y(s.getSeconds(),t.length)},S(s,t){const a=t.length,r=s.getMilliseconds(),n=Math.trunc(r*Math.pow(10,a-3));return Y(n,t.length)}},Ot={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Za={G:function(s,t,a){const r=s.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return a.era(r,{width:"abbreviated"});case"GGGGG":return a.era(r,{width:"narrow"});default:return a.era(r,{width:"wide"})}},y:function(s,t,a){if(t==="yo"){const r=s.getFullYear(),n=r>0?r:1-r;return a.ordinalNumber(n,{unit:"year"})}return xt.y(s,t)},Y:function(s,t,a,r){const n=On(s,r),i=n>0?n:1-n;if(t==="YY"){const o=i%100;return Y(o,2)}return t==="Yo"?a.ordinalNumber(i,{unit:"year"}):Y(i,t.length)},R:function(s,t){const a=Fn(s);return Y(a,t.length)},u:function(s,t){const a=s.getFullYear();return Y(a,t.length)},Q:function(s,t,a){const r=Math.ceil((s.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return Y(r,2);case"Qo":return a.ordinalNumber(r,{unit:"quarter"});case"QQQ":return a.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return a.quarter(r,{width:"narrow",context:"formatting"});default:return a.quarter(r,{width:"wide",context:"formatting"})}},q:function(s,t,a){const r=Math.ceil((s.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return Y(r,2);case"qo":return a.ordinalNumber(r,{unit:"quarter"});case"qqq":return a.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return a.quarter(r,{width:"narrow",context:"standalone"});default:return a.quarter(r,{width:"wide",context:"standalone"})}},M:function(s,t,a){const r=s.getMonth();switch(t){case"M":case"MM":return xt.M(s,t);case"Mo":return a.ordinalNumber(r+1,{unit:"month"});case"MMM":return a.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return a.month(r,{width:"narrow",context:"formatting"});default:return a.month(r,{width:"wide",context:"formatting"})}},L:function(s,t,a){const r=s.getMonth();switch(t){case"L":return String(r+1);case"LL":return Y(r+1,2);case"Lo":return a.ordinalNumber(r+1,{unit:"month"});case"LLL":return a.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return a.month(r,{width:"narrow",context:"standalone"});default:return a.month(r,{width:"wide",context:"standalone"})}},w:function(s,t,a,r){const n=Yo(s,r);return t==="wo"?a.ordinalNumber(n,{unit:"week"}):Y(n,t.length)},I:function(s,t,a){const r=Ko(s);return t==="Io"?a.ordinalNumber(r,{unit:"week"}):Y(r,t.length)},d:function(s,t,a){return t==="do"?a.ordinalNumber(s.getDate(),{unit:"date"}):xt.d(s,t)},D:function(s,t,a){const r=Uo(s);return t==="Do"?a.ordinalNumber(r,{unit:"dayOfYear"}):Y(r,t.length)},E:function(s,t,a){const r=s.getDay();switch(t){case"E":case"EE":case"EEE":return a.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return a.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(r,{width:"short",context:"formatting"});default:return a.day(r,{width:"wide",context:"formatting"})}},e:function(s,t,a,r){const n=s.getDay(),i=(n-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Y(i,2);case"eo":return a.ordinalNumber(i,{unit:"day"});case"eee":return a.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return a.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(n,{width:"short",context:"formatting"});default:return a.day(n,{width:"wide",context:"formatting"})}},c:function(s,t,a,r){const n=s.getDay(),i=(n-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Y(i,t.length);case"co":return a.ordinalNumber(i,{unit:"day"});case"ccc":return a.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return a.day(n,{width:"narrow",context:"standalone"});case"cccccc":return a.day(n,{width:"short",context:"standalone"});default:return a.day(n,{width:"wide",context:"standalone"})}},i:function(s,t,a){const r=s.getDay(),n=r===0?7:r;switch(t){case"i":return String(n);case"ii":return Y(n,t.length);case"io":return a.ordinalNumber(n,{unit:"day"});case"iii":return a.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return a.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return a.day(r,{width:"short",context:"formatting"});default:return a.day(r,{width:"wide",context:"formatting"})}},a:function(s,t,a){const n=s.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return a.dayPeriod(n,{width:"narrow",context:"formatting"});default:return a.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(s,t,a){const r=s.getHours();let n;switch(r===12?n=Ot.noon:r===0?n=Ot.midnight:n=r/12>=1?"pm":"am",t){case"b":case"bb":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return a.dayPeriod(n,{width:"narrow",context:"formatting"});default:return a.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(s,t,a){const r=s.getHours();let n;switch(r>=17?n=Ot.evening:r>=12?n=Ot.afternoon:r>=4?n=Ot.morning:n=Ot.night,t){case"B":case"BB":case"BBB":return a.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return a.dayPeriod(n,{width:"narrow",context:"formatting"});default:return a.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(s,t,a){if(t==="ho"){let r=s.getHours()%12;return r===0&&(r=12),a.ordinalNumber(r,{unit:"hour"})}return xt.h(s,t)},H:function(s,t,a){return t==="Ho"?a.ordinalNumber(s.getHours(),{unit:"hour"}):xt.H(s,t)},K:function(s,t,a){const r=s.getHours()%12;return t==="Ko"?a.ordinalNumber(r,{unit:"hour"}):Y(r,t.length)},k:function(s,t,a){let r=s.getHours();return r===0&&(r=24),t==="ko"?a.ordinalNumber(r,{unit:"hour"}):Y(r,t.length)},m:function(s,t,a){return t==="mo"?a.ordinalNumber(s.getMinutes(),{unit:"minute"}):xt.m(s,t)},s:function(s,t,a){return t==="so"?a.ordinalNumber(s.getSeconds(),{unit:"second"}):xt.s(s,t)},S:function(s,t){return xt.S(s,t)},X:function(s,t,a){const r=s.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return tr(r);case"XXXX":case"XX":return wt(r);default:return wt(r,":")}},x:function(s,t,a){const r=s.getTimezoneOffset();switch(t){case"x":return tr(r);case"xxxx":case"xx":return wt(r);default:return wt(r,":")}},O:function(s,t,a){const r=s.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+er(r,":");default:return"GMT"+wt(r,":")}},z:function(s,t,a){const r=s.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+er(r,":");default:return"GMT"+wt(r,":")}},t:function(s,t,a){const r=Math.trunc(+s/1e3);return Y(r,t.length)},T:function(s,t,a){return Y(+s,t.length)}};function er(s,t=""){const a=s>0?"-":"+",r=Math.abs(s),n=Math.trunc(r/60),i=r%60;return i===0?a+String(n):a+String(n)+t+Y(i,2)}function tr(s,t){return s%60===0?(s>0?"-":"+")+Y(Math.abs(s)/60,2):wt(s,t)}function wt(s,t=""){const a=s>0?"-":"+",r=Math.abs(s),n=Y(Math.trunc(r/60),2),i=Y(r%60,2);return a+n+t+i}const sr=(s,t)=>{switch(s){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},Rn=(s,t)=>{switch(s){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},Go=(s,t)=>{const a=s.match(/(P+)(p+)?/)||[],r=a[1],n=a[2];if(!n)return sr(s,t);let i;switch(r){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",sr(r,t)).replace("{{time}}",Rn(n,t))},Xo={p:Rn,P:Go},Jo=/^D+$/,Zo=/^Y+$/,ec=["D","DD","YY","YYYY"];function tc(s){return Jo.test(s)}function sc(s){return Zo.test(s)}function ac(s,t,a){const r=rc(s,t,a);if(console.warn(r),ec.includes(s))throw new RangeError(r)}function rc(s,t,a){const r=s[0]==="Y"?"years":"days of the month";return`Use \`${s.toLowerCase()}\` instead of \`${s}\` (in \`${t}\`) for formatting ${r} to the input \`${a}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const nc=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ic=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,lc=/^'([^]*?)'?$/,oc=/''/g,cc=/[a-zA-Z]/;function tt(s,t,a){const r=Ks(),n=r.locale??Ho,i=r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,o=r.weekStartsOn??r.locale?.options?.weekStartsOn??0,m=Xe(s,a?.in);if(!mo(m))throw new RangeError("Invalid time value");let h=t.match(ic).map(d=>{const y=d[0];if(y==="p"||y==="P"){const b=Xo[y];return b(d,n.formatLong)}return d}).join("").match(nc).map(d=>{if(d==="''")return{isToken:!1,value:"'"};const y=d[0];if(y==="'")return{isToken:!1,value:dc(d)};if(Za[y])return{isToken:!0,value:d};if(y.match(cc))throw new RangeError("Format string contains an unescaped latin alphabet character `"+y+"`");return{isToken:!1,value:d}});n.localize.preprocessor&&(h=n.localize.preprocessor(m,h));const f={firstWeekContainsDate:i,weekStartsOn:o,locale:n};return h.map(d=>{if(!d.isToken)return d.value;const y=d.value;(sc(y)||tc(y))&&ac(y,t,String(s));const b=Za[y[0]];return b(m,y,n.localize,f)}).join("")}function dc(s){const t=s.match(lc);return t?t[1].replace(oc,"'"):s}const mc=[{title:"Installation Planning",prompt:"How do I plan the optimal solar panel installation for my roof?",icon:e.jsx(is,{className:"h-4 w-4"}),category:"installation"},{title:"Fault Detection",prompt:"How can I identify and troubleshoot solar panel defects?",icon:e.jsx(Xt,{className:"h-4 w-4"}),category:"fault"},{title:"Maintenance Tips",prompt:"What's the best maintenance schedule for solar panels?",icon:e.jsx(oa,{className:"h-4 w-4"}),category:"maintenance"},{title:"Performance Optimization",prompt:"How can I improve my solar panel system's performance?",icon:e.jsx(ie,{className:"h-4 w-4"}),category:"performance"},{title:"System Sizing",prompt:"How do I determine the right solar system size for my needs?",icon:e.jsx(Jr,{className:"h-4 w-4"}),category:"installation"},{title:"Weather Impact",prompt:"How do weather conditions affect solar panel performance?",icon:e.jsx(is,{className:"h-4 w-4"}),category:"performance"},{title:"Indian Helplines",prompt:"Please provide Indian solar energy helpline numbers for support and assistance",icon:e.jsx(Gr,{className:"h-4 w-4"}),category:"helpline"},{title:"Cost Analysis",prompt:"Help me understand solar panel costs, financing options, and ROI calculations",icon:e.jsx(oa,{className:"h-4 w-4"}),category:"cost"}];function uc(){const{user:s}=ct(),[t,a]=l.useState(""),[r,n]=l.useState(!1),[i,o]=l.useState(null),[m,h]=l.useState(()=>{if(typeof window<"u"){const x=localStorage.getItem("chatPageMessages");if(x)try{return!JSON.parse(x).some(q=>q.sender==="user")}catch{return!0}}return!0}),[f,d]=l.useState(()=>{if(typeof window<"u"){const x=localStorage.getItem("chatPageMessages");if(x)try{return!JSON.parse(x).some(q=>q.sender==="user")}catch{return!0}}return!0}),[y,b]=l.useState("checking"),[N,T]=l.useState(()=>{if(typeof window<"u"){const x=s?`chatPageMessages_${s.id}`:"chatPageMessages_guest",p=localStorage.getItem(x);if(p)try{return JSON.parse(p).map(k=>({...k,timestamp:new Date(k.timestamp)}))}catch(k){console.error("Error parsing saved chat messages:",k)}}return[{id:1,message:"Hello! I'm your SolarSense AI assistant. I'm here to help you with energy trading, household energy optimization, battery management, and decentralized energy distribution. How can I assist you today?",sender:"ai",timestamp:new Date,category:"greeting"}]}),[E,K]=l.useState(null),[G,fe]=l.useState({}),[z,B]=l.useState(!1),[be,j]=l.useState(null),[M,C]=l.useState(!1),[Q,R]=l.useState(!0),[W,ae]=l.useState(!1),Ae=l.useRef(null),Ne=l.useRef(null);l.useEffect(()=>{const x=s?`chatPageMessages_${s.id}`:"chatPageMessages_guest";localStorage.setItem(x,JSON.stringify(N))},[N,s]),l.useEffect(()=>{if(s){const x=`chatPageMessages_${s.id}`,p=localStorage.getItem(x);if(p)try{const k=JSON.parse(p).map(_=>({..._,timestamp:new Date(_.timestamp)}));T(k);const q=k.some(_=>_.sender==="user");d(!q),h(!q)}catch(k){console.error("Error loading user chat messages:",k)}}else T([{id:1,message:"Hello! I'm your SolarSense AI assistant. I'm here to help you with energy trading, household energy optimization, battery management, and decentralized energy distribution. How can I assist you today?",sender:"ai",timestamp:new Date,category:"greeting"}]),d(!0),h(!0)},[s]),l.useEffect(()=>{(async()=>{try{const p=await fetch("/api/health");p.ok&&(await p.json()).ai?.status==="online"?b("connected"):b("error")}catch{b("error")}})()},[]),l.useEffect(()=>{window.visualViewport&&document.body.classList.add("visual-viewport-supported");const x=()=>{if(window.visualViewport){const p=window.visualViewport.height<window.innerHeight;C(p),p?(document.documentElement.style.setProperty("--viewport-height",`${window.visualViewport.height}px`),document.body.classList.add("mobile-keyboard-open")):(document.documentElement.style.setProperty("--viewport-height","100vh"),document.body.classList.remove("mobile-keyboard-open"))}};if(window.visualViewport)return window.visualViewport.addEventListener("resize",x),x(),()=>{window.visualViewport?.removeEventListener("resize",x),document.body.classList.remove("visual-viewport-supported","mobile-keyboard-open")}},[]),l.useEffect(()=>{const x=Ae.current;if(!x)return;let p=!1,k,q=0;const _=()=>{const me=x.querySelector("[data-radix-scroll-area-viewport]")||x.querySelector(".scroll-area-viewport")||x;if(me){const{scrollTop:Me,scrollHeight:At,clientHeight:jt}=me,Ue=Math.abs(Me+jt-At)<=10,Ze=Me<q&&p;q=Me,Ue&&!Q?(R(!0),ae(!1)):Ze&&Q?(R(!1),ae(!0)):!Ue&&!Q?ae(!0):Ue&&Q&&ae(!1)}},P=()=>{p=!0,clearTimeout(k),k=setTimeout(()=>{p=!1},200)},v=()=>P(),I=me=>{Math.abs(me.deltaY)>3&&P()},L=x.querySelector("[data-radix-scroll-area-viewport]")||x.querySelector(".scroll-area-viewport")||x;if(L)return L.addEventListener("scroll",_,{passive:!0}),L.addEventListener("touchstart",v,{passive:!0}),L.addEventListener("wheel",I,{passive:!0}),()=>{L.removeEventListener("scroll",_),L.removeEventListener("touchstart",v),L.removeEventListener("wheel",I),clearTimeout(k)}},[Q]),l.useEffect(()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const x=window.SpeechRecognition||window.webkitSpeechRecognition,p=new x;p.continuous=!1,p.interimResults=!1,p.lang="en-US",p.onresult=k=>{const q=k.results[0][0].transcript;a(q),n(!1)},p.onerror=()=>{n(!1)},p.onend=()=>{n(!1)},o(p)}},[]);const J=Se({mutationFn:async x=>{const p=N.slice(-10).map(q=>`${q.sender==="user"?"User":"AI"}: ${q.message}`),k=await je("POST","/api/ai/chat",{message:x,conversationHistory:p});if(!k.ok)throw new Error(`HTTP error! status: ${k.status}`);return k.json()},onSuccess:x=>{b("connected");const p=Date.now()+1;T(k=>[...k,{id:p,message:x.response,sender:"ai",timestamp:new Date,category:x.category||"general"}]),K(p),R(!0)},onError:x=>{b("error"),console.error("AI Chat error:",x);let p="I'm having trouble connecting right now. ";x instanceof Error&&(x.message.includes("503")||x.message.includes("overloaded")||x.message.includes("UNAVAILABLE")?p="The AI service is currently experiencing high demand. Please wait a few minutes and try again. ":x.message.includes("timeout")?p="The request timed out. Please try again with a shorter message. ":x.message.includes("network")&&(p="Network connection failed. Please check your internet connection and try again. "));const k=N[N.length-1];if(k&&k.sender==="user"){const _=k.message.toLowerCase();_.includes("install")||_.includes("roof")?p+="For installation questions, I recommend focusing on roof assessment, system sizing, permits, and professional installation. ":_.includes("fault")||_.includes("problem")?p+="For troubleshooting, check for shading issues, dirty panels, loose connections, and inverter problems. ":_.includes("maintenance")||_.includes("clean")?p+="For maintenance, focus on regular cleaning, visual inspections, and performance monitoring. ":p+="I can help with installation planning, fault detection, maintenance, and performance optimization. "}else p+="I can help with installation planning, fault detection, maintenance, and performance optimization. ";p+="Please try your question again.";const q=Date.now()+1;T(_=>[..._,{id:q,message:p,sender:"ai",timestamp:new Date,category:"error"}]),K(q)}}),ee=(x=!0)=>{if(Ae.current){const p=Ae.current.querySelector("[data-radix-scroll-area-viewport]")||Ae.current.querySelector(".scroll-area-viewport")||Ae.current;if(p){const k=p.scrollHeight,q=p.clientHeight,_=k-q;_>0&&(x?p.scrollTo({top:_,behavior:"smooth"}):p.scrollTop=_)}}};l.useEffect(()=>{if(Q){const x=setTimeout(()=>ee(!1),50),p=setTimeout(()=>ee(!0),200);return()=>{clearTimeout(x),clearTimeout(p)}}},[N,G,Q]),l.useEffect(()=>{if(z&&Q){const x=setInterval(()=>{ee(!1)},100);return()=>clearInterval(x)}},[z,Q]),l.useEffect(()=>{if(E!==null){const x=N.find(p=>p.id===E);if(x&&x.sender==="ai"){const p=x.message;let k=0;B(!0);const q=()=>{if(k<p.length){fe(v=>({...v,[E]:p.substring(0,k+1)})),k++;const _=p[k-1],P=_===" "?2:_.match(/[.!?]/)?15:4;Ne.current=setTimeout(q,P)}else K(null),B(!1),fe(_=>{const P={..._};return delete P[E],P})};q()}}return()=>{Ne.current&&clearTimeout(Ne.current)}},[E,N]),l.useEffect(()=>{!f&&Q&&setTimeout(()=>{ee(!0)},300)},[f,Q]);const qe=()=>{if(Ne.current&&(clearTimeout(Ne.current),Ne.current=null),E!==null){const x=G[E];x&&T(p=>p.map(k=>k.id===E?{...k,message:x}:k))}K(null),B(!1),fe({})},de=x=>{if(x.preventDefault(),!t.trim()||J.isPending||z)return;const p={id:Date.now(),message:t.trim(),sender:"user",timestamp:new Date};T(k=>[...k,p]),a(""),R(!0),m&&setTimeout(()=>h(!1),1e3),f&&d(!1),J.mutate(t.trim())},Ee=x=>{x.preventDefault(),z?qe():de(x)},Je=x=>{if(J.isPending||z)return;const p={id:Date.now(),message:x.prompt,sender:"user",timestamp:new Date,category:x.category};T(k=>[...k,p]),m&&setTimeout(()=>h(!1),1e3),f&&d(!1),J.mutate(x.prompt)},H=()=>{i&&(r?(i.stop(),n(!1)):(i.start(),n(!0)))},He=()=>{const x=s?`chatPageMessages_${s.id}`:"chatPageMessages_guest";localStorage.removeItem(x),localStorage.removeItem("chatPageMessages"),T([{id:1,message:"Hello! I'm your SolarSense AI assistant. I'm here to help you with energy trading, household energy optimization, battery management, and decentralized energy distribution. How can I assist you today?",sender:"ai",timestamp:new Date,category:"greeting"}]),d(!0),h(!0),a(""),K(null),fe({}),B(!1),j(null),R(!0),Ne.current&&(clearTimeout(Ne.current),Ne.current=null)},De=async(x,p)=>{try{const k=x.replace(/\*\*(.*?)\*\*/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/`(.*?)`/g,"$1").replace(/```[\s\S]*?```/g,"").replace(/#{1,6}\s+(.*)/g,"$1").replace(/\[([^\]]+)\]\([^)]+\)/g,"$1").replace(/^\s*[-*+]\s+/gm,"").replace(/^\s*\d+\.\s+/gm,"").trim();await navigator.clipboard.writeText(k),j(p),setTimeout(()=>j(null),2e3)}catch(k){console.error("Failed to copy text:",k)}},he=(x,p)=>{if(x==="ai")switch(p){case"installation":return"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-500";case"fault":return"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-500";case"maintenance":return"bg-green-50 dark:bg-green-900/20 border-l-4 border-green-500";case"performance":return"bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500";case"welcome":return"bg-purple-50 dark:bg-purple-900/20 border-l-4 border-purple-500";case"error":return"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-500";default:return"bg-gray-50 dark:bg-gray-800 border-l-4 border-gray-300"}return"bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500"};return e.jsxs("div",{className:"min-h-screen bg-surface",children:[e.jsx(Tt,{currentPage:"chat"}),e.jsx("main",{className:"container mx-auto px-2 sm:px-4 md:px-6 lg:px-8 xl:px-12 py-0 pt-20",children:e.jsx("div",{className:"flex flex-col chat-container h-[calc(100svh-60px)] max-h-[calc(100svh-60px)] md:h-[calc(100vh-60px)] md:max-h-[calc(100vh-60px)]",children:e.jsx("div",{className:"flex-1 flex flex-col min-h-0 relative",children:e.jsxs(D,{className:"h-full flex flex-col shadow-lg border rounded-lg overflow-hidden max-w-full lg:max-w-6xl mx-auto w-full",children:[e.jsx(se,{className:"py-3 sm:py-3 md:py-4 px-4 sm:px-4 md:px-6 bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 rounded-lg overflow-hidden bg-gradient-to-br from-cyan-400 to-blue-500 flex items-center justify-center",children:e.jsx("img",{src:"/assets/robot-chat-bot-concept-illustration-vector_1752050227392.jpg",alt:"AI Assistant",className:"w-6 h-6 sm:w-8 sm:h-8 md:w-10 md:h-10 object-cover rounded-md"})}),e.jsxs("div",{children:[e.jsx(le,{className:"text-sm sm:text-base md:text-lg font-bold text-gray-900 dark:text-white",children:"SolarSense AI"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Solar panel expert ready to help"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(X,{variant:"secondary",className:`flex items-center gap-1 px-2 py-1 transition-all duration-300 ${y==="connected"?"bg-green-100 text-green-700 border-green-200":y==="error"?"bg-red-100 text-red-700 border-red-200":"bg-yellow-100 text-yellow-700 border-yellow-200"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${y==="connected"?"bg-green-500 animate-pulse":y==="error"?"bg-red-500":"bg-yellow-500 animate-bounce"}`}),e.jsx("span",{className:"text-xs font-medium",children:y==="connected"?"Online":y==="error"?"Offline":"Checking"})]}),N.some(x=>x.sender==="user")&&e.jsxs(w,{variant:"ghost",size:"sm",onClick:He,className:"h-8 px-2 text-xs text-blue-600 hover:text-blue-700 hover:bg-blue-50 dark:text-blue-400 dark:hover:text-blue-300 dark:hover:bg-blue-900/20",title:"Start new conversation",children:[e.jsx(Ws,{className:"h-3 w-3 mr-1"}),"New"]})]})]})}),e.jsx(U,{className:"flex-1 flex flex-col p-0 relative min-h-0",children:e.jsx(Ia,{className:"flex-1 px-3 sm:px-4 md:px-8 lg:px-12 pt-1 sm:pt-2 md:pt-3 transition-all duration-300 chat-scroll-area",ref:Ae,style:{overflowY:"auto"},children:e.jsxs("div",{className:"space-y-4 md:space-y-6 max-w-4xl mx-auto",children:[N.map(x=>e.jsxs("div",{className:`relative flex items-start gap-2 sm:gap-3 p-2 sm:p-3 md:p-4 rounded-lg group ${he(x.sender,x.category)}`,children:[e.jsx(pa,{className:"h-7 w-7 sm:h-8 sm:w-8 md:h-10 md:w-10 shrink-0",children:e.jsx(ga,{className:"bg-gradient-to-br from-cyan-400 to-blue-500 p-0 overflow-hidden",children:x.sender==="ai"?e.jsx("img",{src:"/assets/robot-chat-bot-concept-illustration-vector_1752050227392.jpg",alt:"AI Assistant",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center rounded-full",children:e.jsx("svg",{viewBox:"0 0 24 24",className:"h-6 w-6 text-white",fill:"currentColor",children:e.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})})})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 mb-1 sm:mb-2",children:[e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:x.sender==="ai"?"SolarSense AI":"You"}),x.category&&x.category!=="general"&&e.jsx(X,{variant:"secondary",className:"text-xs hidden sm:inline-flex",children:x.category}),e.jsx("span",{className:"text-xs text-muted-foreground",children:tt(x.timestamp,"HH:mm")})]}),e.jsxs("div",{className:"text-sm md:text-base leading-relaxed prose prose-sm md:prose-base max-w-none dark:prose-invert",children:[x.sender==="ai"?e.jsx(nn,{remarkPlugins:[ln],components:{p:({children:p})=>e.jsx("p",{className:"mb-3 last:mb-0 text-gray-800 dark:text-gray-200",children:p}),ul:({children:p})=>e.jsx("ul",{className:"mb-3 last:mb-0 ml-4 list-disc text-gray-800 dark:text-gray-200",children:p}),ol:({children:p})=>e.jsx("ol",{className:"mb-3 last:mb-0 ml-4 list-decimal text-gray-800 dark:text-gray-200",children:p}),li:({children:p})=>e.jsx("li",{className:"mb-2 text-gray-800 dark:text-gray-200",children:p}),strong:({children:p})=>e.jsx("strong",{className:"font-semibold text-gray-900 dark:text-gray-100",children:p}),em:({children:p})=>e.jsx("em",{className:"italic text-gray-800 dark:text-gray-200",children:p}),h1:({children:p})=>e.jsx("h1",{className:"text-lg sm:text-xl font-bold mb-3 mt-3 text-gray-900 dark:text-gray-100",children:p}),h2:({children:p})=>e.jsx("h2",{className:"text-base sm:text-lg font-semibold mb-3 mt-3 text-gray-900 dark:text-gray-100",children:p}),h3:({children:p})=>e.jsx("h3",{className:"text-sm sm:text-base font-semibold mb-2 mt-2 text-gray-900 dark:text-gray-100",children:p}),h4:({children:p})=>e.jsx("h4",{className:"text-sm sm:text-base font-semibold mb-2 mt-2 text-gray-900 dark:text-gray-100",children:p}),table:({children:p})=>e.jsx("div",{className:"overflow-x-auto mb-3 rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsx("table",{className:"min-w-full border-collapse text-xs",children:p})}),thead:({children:p})=>e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:p}),tbody:({children:p})=>e.jsx("tbody",{className:"bg-white dark:bg-gray-900",children:p}),tr:({children:p})=>e.jsx("tr",{className:"border-b border-gray-200 dark:border-gray-700",children:p}),th:({children:p})=>e.jsx("th",{className:"px-3 py-2 text-left font-semibold text-gray-900 dark:text-gray-100 border-r border-gray-200 dark:border-gray-700 last:border-r-0",children:p}),td:({children:p})=>e.jsx("td",{className:"px-3 py-2 text-gray-700 dark:text-gray-300 border-r border-gray-200 dark:border-gray-700 last:border-r-0",children:p}),code:({children:p,className:k})=>!k?.includes("language-")?e.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 py-0.5 rounded text-xs font-mono text-purple-600 dark:text-purple-400",children:p}):e.jsx("pre",{className:"bg-gray-100 dark:bg-gray-800 p-3 rounded text-xs font-mono overflow-x-auto mb-2 border border-gray-200 dark:border-gray-700",children:e.jsx("code",{className:"text-gray-800 dark:text-gray-200",children:p})}),blockquote:({children:p})=>e.jsx("blockquote",{className:"border-l-4 border-purple-500 pl-3 italic text-gray-600 dark:text-gray-400 mb-2 bg-gray-50 dark:bg-gray-800 py-2 rounded-r",children:p}),hr:()=>e.jsx("hr",{className:"my-3 border-gray-200 dark:border-gray-700"})},children:E===x.id?G[x.id]||"":x.message}):e.jsx("div",{className:"text-gray-800 dark:text-gray-200 whitespace-pre-wrap text-sm md:text-base leading-relaxed",children:x.message}),E===x.id&&e.jsx("span",{className:"inline-block w-2 h-4 bg-purple-500 animate-pulse ml-1 rounded-sm"})]})]}),x.sender==="ai"&&E!==x.id&&e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>De(x.message,x.id),className:"absolute bottom-2 right-2 h-6 w-6 p-0 bg-white/60 dark:bg-gray-800/60 hover:bg-white dark:hover:bg-gray-700 border border-gray-200/60 dark:border-gray-600/60 hover:border-gray-200 dark:hover:border-gray-600 shadow-sm hover:shadow-md transition-all duration-200 rounded-md backdrop-blur-sm opacity-0 group-hover:opacity-100",title:"Copy message",children:be===x.id?e.jsx(Na,{className:"h-3 w-3 text-green-600"}):e.jsx(Hr,{className:"h-3 w-3 text-gray-600 dark:text-gray-400"})})]},x.id)),J.isPending&&e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 p-2 sm:p-3 md:p-4 rounded-lg bg-purple-50 dark:bg-purple-900/20 border-l-4 border-purple-500",children:[e.jsx(pa,{className:"h-7 w-7 sm:h-8 sm:w-8 md:h-10 md:w-10 shrink-0",children:e.jsx(ga,{className:"bg-gradient-to-br from-cyan-400 to-blue-500 p-0 overflow-hidden",children:e.jsx("img",{src:"/assets/robot-chat-bot-concept-illustration-vector_1752050227392.jpg",alt:"AI Assistant",className:"w-full h-full object-cover"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 mb-1 sm:mb-2",children:[e.jsx("span",{className:"font-medium text-xs sm:text-sm",children:"SolarSense AI"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Analyzing..."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-bounce w-1.5 h-1.5 sm:w-2 sm:h-2 bg-purple-500 rounded-full"}),e.jsx("div",{className:"animate-bounce w-1.5 h-1.5 sm:w-2 sm:h-2 bg-purple-500 rounded-full",style:{animationDelay:"0.1s"}}),e.jsx("div",{className:"animate-bounce w-1.5 h-1.5 sm:w-2 sm:h-2 bg-purple-500 rounded-full",style:{animationDelay:"0.2s"}}),e.jsx("span",{className:"text-xs text-purple-600 ml-1 sm:ml-2",children:"Thinking about your solar question..."})]})]})]})]})})})]})})})}),W&&e.jsx("div",{className:"fixed bottom-24 right-4 z-40",children:e.jsx(w,{variant:"outline",size:"sm",onClick:()=>{R(!0),ee(!0)},className:"h-12 w-12 rounded-full bg-white/90 hover:bg-white border-2 border-gray-200 hover:border-gray-300 shadow-lg hover:shadow-xl transition-all duration-200 backdrop-blur-sm",title:"Scroll to bottom",children:e.jsx(wa,{className:"h-5 w-5 text-gray-600"})})}),e.jsxs("div",{className:"fixed bottom-0 left-0 right-0 z-50 mobile-fixed-bottom safe-bottom",children:[f&&e.jsx("div",{className:"mb-0 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 shadow-lg",children:e.jsxs("div",{className:"px-4 md:px-6 lg:px-8 py-4 bg-gray-50 dark:bg-gray-800/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center",children:[e.jsx(Jr,{className:"h-4 w-4 mr-2 text-purple-600 dark:text-purple-400"}),"Quick Start:"]}),e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>d(!1),className:"h-6 w-6 p-0 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full",children:e.jsx(ce,{className:"h-4 w-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"})})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-8 gap-2 sm:gap-3",children:mc.map((x,p)=>e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>Je(x),disabled:J.isPending||z,className:"flex items-center gap-1 sm:gap-1.5 text-xs px-2 py-2 h-auto text-left justify-start hover:bg-purple-50 hover:border-purple-300 hover:text-purple-700 dark:hover:bg-purple-900/20 dark:hover:border-purple-600 dark:hover:text-purple-300 transition-all duration-200 min-h-[36px] sm:min-h-[40px]",children:[e.jsx("span",{className:"flex-shrink-0 text-sm",children:x.icon}),e.jsx("span",{className:"font-medium leading-tight truncate text-xs sm:text-sm",children:x.title})]},p))})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 shadow-lg",children:e.jsx("div",{className:"px-4 md:px-6 lg:px-8 py-4",children:e.jsxs("form",{onSubmit:Ee,className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(te,{value:t,onChange:x=>a(x.target.value),placeholder:"Ask me anything about solar panels...",className:"pr-10 sm:pr-12 h-11 sm:h-12 text-sm border-2 border-gray-200 dark:border-gray-600 focus:border-purple-500 dark:focus:border-purple-400 transition-all duration-200",disabled:J.isPending||z,onKeyDown:x=>{x.key==="Enter"&&!x.shiftKey&&(x.preventDefault(),Ee(x))}}),J.isPending&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-purple-500"})})]}),i&&e.jsx(w,{type:"button",size:"sm",variant:"outline",className:`h-11 sm:h-12 px-2 sm:px-3 hover:bg-purple-600 hover:text-white hover:border-purple-600 transition-all duration-200 ${r?"bg-red-100 dark:bg-red-900/20 text-red-600 border-red-400":"text-gray-500 border-gray-300"}`,onClick:H,disabled:J.isPending||z,children:r?e.jsx(Ur,{className:"h-4 w-4"}):e.jsx(Kr,{className:"h-4 w-4"})}),e.jsx(w,{type:"submit",size:"sm",className:`h-11 sm:h-12 px-3 sm:px-4 transition-all duration-200 ${z?"bg-red-600 hover:bg-red-800 text-white dark:bg-red-500 dark:hover:bg-red-700":"bg-purple-600 hover:bg-purple-800 text-white dark:bg-purple-500 dark:hover:bg-purple-700"}`,disabled:!t.trim()&&!z||J.isPending,children:z?e.jsx(As,{className:"h-4 w-4"}):e.jsx(Qr,{className:"h-4 w-4"})})]})})})]})]})}const ar=Ct({energyAmount:Ht.number().int("Must be whole number").min(1,"Min 1 kWh"),pricePerKwh:Ht.number().int("Must be whole number").min(1,"Min ₹1/kWh"),tradeType:Sa(["sell","buy"],{required_error:"Required"})}),Ns=["contacted","applicant_rejected","awarded","owner_rejected","withdrawn"],xc={applied:{label:"Applied",variant:"secondary",icon:Zr,dotClass:"bg-yellow-500",showDetail:!1},awarded:{label:"Approved",variant:"default",icon:ie,dotClass:"bg-blue-500",showDetail:!0},owner_rejected:{label:"Declined",variant:"destructive",icon:ce,dotClass:"bg-red-500",showDetail:!1},contacted:{label:"Contact Shared",variant:"default",icon:ie,dotClass:"bg-green-500",showDetail:!0},applicant_rejected:{label:"Rejected",variant:"destructive",icon:ce,dotClass:"bg-red-500",showDetail:!1},withdrawn:{label:"Withdrawn",variant:"outline",icon:ce,dotClass:"bg-gray-500",showDetail:!1}},hc={label:"Unknown",variant:"outline",icon:Xt,dotClass:"bg-gray-500",showDetail:!1};function vs(s){return xc[s]??{...hc,label:s.charAt(0).toUpperCase()+s.slice(1)}}const pc={contacted:{applicant:{title:"Contact Details Shared",desc:"You shared contact details with the trade owner. Both parties can now coordinate the energy transfer.",color:"emerald",icon:ie},owner:{title:"Contact Details Shared",desc:"The applicant shared contact details. Both parties can now coordinate the energy transfer.",color:"emerald",icon:ie}},awarded:{applicant:{title:"Application Approved",desc:"The trade owner approved your application. Contact details have been automatically shared.",color:"blue",icon:ie},owner:{title:"Application Approved",desc:"You approved this application. Contact details have been automatically shared.",color:"blue",icon:ie}},applicant_rejected:{applicant:{title:"Trade Rejected",desc:"You rejected this trade after the owner accepted. It's now available for other applicants.",color:"red",icon:ce},owner:{title:"Rejected by Applicant",desc:"The applicant rejected after your approval. Your trade is now available for others.",color:"red",icon:ce}},owner_rejected:{applicant:{title:"Application Declined",desc:"The trade owner declined your application. Look for other available trades.",color:"red",icon:ce},owner:{title:"Application Declined",desc:"You declined this application. Your trade remains available.",color:"red",icon:ce}},withdrawn:{applicant:{title:"Application Withdrawn",desc:"You withdrew your application before the trade owner could respond.",color:"slate",icon:ce},owner:{title:"Application Withdrawn",desc:"The applicant withdrew before you could respond. Your trade remains available.",color:"slate",icon:ce}}},gc={emerald:{bg:"bg-emerald-900/20 border-emerald-600/50",title:"text-emerald-400",desc:"text-emerald-300"},blue:{bg:"bg-blue-900/20 border-blue-600/50",title:"text-blue-400",desc:"text-blue-300"},red:{bg:"bg-red-900/20 border-red-600/50",title:"text-red-400",desc:"text-red-300"},slate:{bg:"bg-slate-800/50 border-slate-600/50",title:"text-slate-300",desc:"text-slate-400"}};function rr(s,t,a,r){let n=t.find(o=>o.id===s);const i=a.find(o=>o.trade?.id===(n?.id??s));return n||(n=i?.trade??r),{trade:n,offerMatch:i}}const Ss=["/api/energy-trades","/api/trade-offers","/api/trade-acceptances","/api/my-trade-applications"];function fc(s){const t=ja(),{toast:a}=Zt(),r=(...T)=>T.forEach(E=>t.invalidateQueries({queryKey:[E],refetchType:"all"})),n=(T,E)=>a({title:T,description:E}),i=T=>a({title:"Error",description:T,variant:"destructive"}),o=Se({mutationFn:T=>je("POST","/api/energy-trades",{energyAmount:Math.round(T.energyAmount),pricePerKwh:Math.round(T.pricePerKwh),tradeType:T.tradeType}),onSuccess:()=>{r("/api/energy-trades","/api/trade-offers"),s.onCreateSuccess(),n("Trade Created","Your energy trade has been posted successfully.")},onError:()=>i("Failed to create trade. Please try again.")}),m=Se({mutationFn:({id:T,data:E})=>je("PUT",`/api/energy-trades/${T}`,{energyAmount:Math.round(E.energyAmount),pricePerKwh:Math.round(E.pricePerKwh),tradeType:E.tradeType}),onSuccess:()=>{r("/api/energy-trades","/api/trade-offers"),s.onEditSuccess(),n("Trade Updated","Your energy trade has been updated successfully.")},onError:()=>i("Failed to update trade. Please try again.")}),h=Se({mutationFn:T=>je("PATCH",`/api/energy-trades/${T}/cancel`),onMutate:async T=>{await t.cancelQueries({queryKey:["/api/energy-trades"]});const E=t.getQueryData(["/api/energy-trades"]);return t.setQueryData(["/api/energy-trades"],K=>K?.map(G=>G.id===T?{...G,status:"cancelled"}:G)),{prev:E}},onSuccess:()=>{r("/api/energy-trades","/api/trade-offers"),n("Trade Cancelled","Your energy trade has been cancelled.")},onError:(T,E,K)=>{K?.prev&&t.setQueryData(["/api/energy-trades"],K.prev),a({title:"Cancel Failed",description:T.message||"Failed to cancel trade.",variant:"destructive"})},onSettled:()=>r("/api/energy-trades","/api/trade-offers")}),f=Se({mutationFn:T=>je("POST",`/api/trade-acceptances/${T}/share-contact`),onSuccess:()=>{r("/api/trade-acceptances","/api/my-trade-applications"),n("Contact Shared","Contact information shared for energy delivery coordination.")},onError:()=>i("Failed to share contact. Please try again.")}),d=Se({mutationFn:T=>je("DELETE",`/api/trade-acceptances/${T}`),onSuccess:()=>{r(...Ss),n("Application Withdrawn","Your application has been successfully withdrawn.")},onError:()=>i("Failed to withdraw application. Please try again.")}),y=Se({mutationFn:T=>je("PATCH",`/api/trade-acceptances/${T}/owner-decision`,{decision:"reject"}),onSuccess:()=>{r(...Ss),n("Application Rejected","The application has been rejected.")},onError:()=>i("Failed to reject application. Please try again.")}),b=Se({mutationFn:T=>je("PATCH",`/api/trade-acceptances/${T}/owner-decision`,{decision:"accept"}),onSuccess:()=>{r(...Ss),n("Application Approved","Waiting for applicant to share contact or reject.")},onError:()=>i("Failed to approve application. Please try again.")}),N=Se({mutationFn:T=>je("PATCH",`/api/trade-acceptances/${T}/applicant-reject`),onSuccess:()=>{r(...Ss),n("Trade Rejected","This trade is now available for other applicants.")},onError:()=>i("Failed to reject trade. Please try again.")});return{createTrade:o,updateTrade:m,cancelTrade:h,shareContact:f,withdraw:d,decline:y,approve:b,applicantReject:N}}function bc({status:s}){return s==="completed"?e.jsx(ie,{className:"h-4 w-4"}):s==="cancelled"?e.jsx(Xt,{className:"h-4 w-4"}):e.jsx(Zr,{className:"h-4 w-4"})}const yc={completed:"default",pending:"secondary",cancelled:"destructive"};function nr({trade:s,variant:t,index:a,dataLoaded:r,cancelPending:n,onEdit:i,onCancel:o,onViewApplications:m}){const h=t==="sell"?"text-emerald-400":"text-blue-400",f=t==="sell"?"Listed:":"Requested:",d=(s.acceptanceCount??0)>0,y=d?"secondary":yc[s.status]??"outline",b=e.jsxs(e.Fragment,{children:[d?e.jsx(bt,{className:"h-3 w-3"}):e.jsx(bc,{status:s.status}),d?`${s.acceptanceCount} applied`:s.status]});return e.jsxs(D,{className:`p-3 sm:p-4 bg-slate-700/50 border-slate-600/50 card-stagger ${r?"opacity-100 translate-y-0":"opacity-0 translate-y-2"}`,style:{animationDelay:`${a*50}ms`},children:[e.jsxs("div",{className:"sm:hidden mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:`font-bold text-lg ${h}`,children:St(s.energyAmount,s.pricePerKwh)}),e.jsx(X,{variant:y,className:"flex items-center gap-1 text-xs",children:b})]}),e.jsxs("div",{className:"text-xs text-slate-400 mb-2",children:[f," ",tt(new Date(s.createdAt),"MMM dd, yyyy HH:mm")]}),d&&e.jsxs(X,{variant:"secondary",className:"flex items-center gap-1 text-xs mb-2",children:[e.jsx(bt,{className:"h-3 w-3"}),s.acceptanceCount," applied"]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"font-medium text-slate-200",children:Fs(s.energyAmount)}),e.jsxs("span",{className:"font-semibold text-slate-400",children:[vt(s.pricePerKwh),"/kWh"]})]})]}),e.jsxs("div",{className:"hidden sm:block mb-4",children:[e.jsxs("div",{className:"flex justify-between items-start gap-3 mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`font-bold text-xl ${h} mb-2`,children:St(s.energyAmount,s.pricePerKwh)}),e.jsxs("div",{className:"text-sm text-slate-400",children:[f," ",tt(new Date(s.createdAt),"MMM dd, yyyy HH:mm")]})]}),e.jsx(X,{variant:y,className:"flex items-center gap-1 text-xs",children:b})]}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("div",{className:"font-medium text-base text-slate-200",children:Fs(s.energyAmount)}),e.jsxs("div",{className:"font-semibold text-slate-400",children:[vt(s.pricePerKwh),"/kWh"]})]})]}),s.status==="pending"&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[d?e.jsxs(w,{variant:"secondary",size:"sm",onClick:m,className:"flex items-center justify-center gap-1 min-h-[44px] w-full sm:w-auto bg-blue-600/50 hover:bg-blue-600 text-slate-200 border-blue-500",children:[e.jsx(at,{className:"h-3 w-3"}),"Applications"]}):e.jsxs(w,{variant:"secondary",size:"sm",onClick:i,className:"flex items-center justify-center gap-1 min-h-[44px] w-full sm:w-auto bg-slate-600/50 hover:bg-slate-600 text-slate-200 border-slate-500",children:[e.jsx(en,{className:"h-3 w-3"}),"Edit"]}),e.jsxs(w,{variant:"destructive",size:"sm",onClick:o,disabled:n,className:"flex items-center justify-center gap-1 min-h-[44px] w-full sm:w-auto bg-red-600/20 hover:bg-red-600/30 text-red-400 border-red-500/50",children:[e.jsx(ce,{className:"h-3 w-3"}),"Cancel"]})]})]})}function jc({open:s,onOpenChange:t,form:a,onSubmit:r,isPending:n}){return e.jsx(ht,{open:s,onOpenChange:t,children:e.jsxs(nt,{className:"w-[95vw] sm:max-w-[500px] p-4 sm:p-6 max-h-[85vh] overflow-y-auto rounded-xl sm:rounded-2xl mx-2 sm:mx-0 bg-slate-900/95 backdrop-blur-xl border border-slate-600/40 shadow-2xl shadow-black/20",children:[e.jsxs(it,{className:"text-lg sm:text-xl font-bold bg-gradient-to-r from-blue-400 via-cyan-400 to-emerald-400 bg-clip-text text-transparent flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 sm:w-7 sm:h-7 rounded-xl bg-gradient-to-br from-blue-500 via-cyan-500 to-emerald-500 flex items-center justify-center shadow-lg",children:e.jsx(en,{className:"h-3 w-3 sm:h-4 sm:w-4 text-white"})}),"Edit Energy Trade"]}),e.jsx(Hs,{className:"text-slate-400 text-sm leading-relaxed border-b border-slate-700/50 pb-4 mb-4",children:"Update your trade details below."}),e.jsx(Os,{...a,children:e.jsxs("form",{id:"edit-trade-form",onSubmit:a.handleSubmit(r),className:"space-y-3 sm:space-y-4",children:[e.jsx(We,{control:a.control,name:"tradeType",render:({field:i})=>e.jsxs(Re,{children:[e.jsxs(_e,{className:"text-slate-200 font-semibold flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-5 h-5 rounded-md bg-blue-500/20 flex items-center justify-center",children:e.jsx(Nt,{className:"h-3 w-3 text-blue-400"})}),"Trade Type"]}),e.jsxs(ls,{onValueChange:i.onChange,value:i.value,children:[e.jsx(Qe,{children:e.jsx(Kt,{className:"h-11 bg-slate-800/70 border-slate-600/50 text-slate-100",children:e.jsx(os,{placeholder:"Choose type"})})}),e.jsxs(Qt,{className:"bg-slate-800/95 border-slate-600/50",children:[e.jsx(Pe,{value:"sell",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rt,{className:"h-4 w-4 text-green-400"}),"Sell Energy"]})}),e.jsx(Pe,{value:"buy",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Hi,{className:"h-4 w-4 text-blue-400"}),"Buy Energy"]})})]})]}),e.jsx(Be,{className:"text-red-400"})]})}),e.jsx(We,{control:a.control,name:"energyAmount",render:({field:i})=>e.jsxs(Re,{children:[e.jsxs(_e,{className:"text-slate-200 font-semibold flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-5 h-5 rounded-md bg-yellow-500/20 flex items-center justify-center",children:e.jsx(Ie,{className:"h-3 w-3 text-yellow-400"})}),"Energy Amount"]}),e.jsx(Qe,{children:e.jsxs("div",{className:"relative",children:[e.jsx(te,{type:"number",min:1,step:1,inputMode:"numeric",className:"h-11 bg-slate-800/70 border-slate-600/50 pl-9 pr-12 text-slate-100",onWheel:o=>o.target.blur(),placeholder:"Enter kWh",...i}),e.jsx(Ie,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-yellow-400/70"}),e.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 bg-slate-700/80 text-slate-200 px-2 py-0.5 rounded-md text-xs font-semibold",children:"kWh"})]})}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Whole numbers only, minimum 1 kWh"}),e.jsx(Be,{className:"text-red-400"})]})}),e.jsx(We,{control:a.control,name:"pricePerKwh",render:({field:i})=>e.jsxs(Re,{children:[e.jsxs(_e,{className:"text-slate-200 font-semibold flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-5 h-5 rounded-md bg-green-500/20 flex items-center justify-center",children:e.jsx(Rt,{className:"h-3 w-3 text-green-400"})}),"Price per kWh"]}),e.jsx(Qe,{children:e.jsxs("div",{className:"relative",children:[e.jsx(te,{type:"number",min:1,step:1,inputMode:"numeric",className:"h-11 bg-slate-800/70 border-slate-600/50 pl-9 pr-14 text-slate-100",onWheel:o=>o.target.blur(),placeholder:"Enter price",...i}),e.jsx(Rt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-green-400/70"}),e.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 bg-slate-700/80 text-slate-200 px-2 py-0.5 rounded-md text-xs font-semibold",children:"₹/kWh"})]})}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Set your rate in rupees per kWh"}),e.jsx(Be,{className:"text-red-400"})]})})]})}),e.jsxs("div",{className:"sticky bottom-0 bg-slate-900/80 border-t border-slate-600/40 pt-4 mt-6 pb-[calc(env(safe-area-inset-bottom)+12px)] flex flex-col-reverse sm:flex-row gap-2 w-full",children:[e.jsx(w,{type:"button",variant:"ghost",onClick:()=>t(!1),className:"w-full sm:w-auto text-slate-400 hover:text-slate-200",children:"Cancel"}),e.jsx(w,{type:"submit",form:"edit-trade-form",disabled:n||!a.formState.isDirty||!a.formState.isValid,className:"w-full sm:w-auto bg-gradient-to-r from-blue-600 via-cyan-600 to-emerald-600 hover:from-blue-700 hover:via-cyan-700 hover:to-emerald-700 text-white font-semibold shadow-xl",children:n?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(gt,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Updating..."})]}):"Update Trade"})]})]})})}function Ps({label:s,value:t,highlight:a,capitalize:r}){return e.jsxs("div",{className:`p-2 rounded border ${a?"bg-emerald-900/20 border-emerald-600/30":"bg-slate-700/30 border-slate-600/30"}`,children:[e.jsx("div",{className:a?"text-xs text-emerald-300":"text-xs text-slate-400",children:s}),e.jsx("div",{className:`${a?"font-semibold text-emerald-400":"font-medium text-slate-100"} ${r?"capitalize":""}`,children:t})]})}function ir({trade:s}){return s?e.jsxs("div",{className:"bg-slate-800/40 border border-slate-600/40 rounded-lg p-3",children:[e.jsxs("h3",{className:"font-medium text-slate-100 mb-2 flex items-center gap-2 text-sm",children:[e.jsx(Ie,{className:"h-4 w-4 text-emerald-400"}),"Trade Information"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 text-sm",children:[e.jsx(Ps,{label:"Energy",value:Fs(s.energyAmount||0)}),e.jsx(Ps,{label:"Price/kWh",value:vt(s.pricePerKwh||0)}),e.jsx(Ps,{label:"Total",value:St(s.energyAmount||0,s.pricePerKwh||0),highlight:!0}),e.jsx(Ps,{label:"Type",value:s.tradeType||"N/A",capitalize:!0})]})]}):null}function lr({title:s,items:t}){return e.jsxs("div",{className:"bg-blue-900/20 border border-blue-500/40 rounded-lg p-3",children:[e.jsxs("h3",{className:"font-medium text-blue-300 mb-2 flex items-center gap-2 text-sm",children:[e.jsx(bt,{className:"h-4 w-4 text-blue-400"}),s]}),e.jsx("div",{className:"space-y-2 text-sm",children:t.filter(a=>a.value).map(({label:a,value:r})=>e.jsxs("div",{className:"flex justify-between py-1 min-w-0",children:[e.jsxs("span",{className:"text-blue-400 flex-shrink-0",children:[a,":"]}),e.jsx("span",{className:"text-blue-100 font-medium break-words ml-2 min-w-0",children:r})]},a))})]})}function wc({open:s,onOpenChange:t,detail:a,energyTrades:r,availableTradesData:n}){if(!a)return null;let i=e.jsx("div",{className:"text-slate-400",children:"Trade details not available"});if(a.tradeId){let o=a.trade||r.find(d=>d.id===a.tradeId);const m=n.find(d=>d.trade?.id===(o?.id??a.tradeId));o||(o=m?.trade);const h=a.tradeOwner?.user||m?.user,f=a.tradeOwner?.household?.name||m?.household?.name||`Household ${o?.sellerHouseholdId||o?.buyerHouseholdId}`;i=e.jsxs("div",{className:"space-y-4",children:[e.jsx(ir,{trade:o}),e.jsx(lr,{title:"Contact Details",items:[{label:"Name",value:f},{label:"Location",value:`${h?.district||"N/A"}, ${h?.state||"N/A"}`},{label:"Phone",value:h?.phone},{label:"Email",value:h?.email}]})]})}else if(a.trade){const{applicant:o,applicantHousehold:m,trade:h}=a;i=e.jsxs("div",{className:"space-y-4",children:[e.jsx(ir,{trade:h}),e.jsx(lr,{title:"Applicant Details",items:[{label:"Name",value:o?.username||m?.name},{label:"Household",value:m?.name},{label:"Location",value:`${o?.district||"N/A"}, ${o?.state||"N/A"}`},{label:"Phone",value:o?.phone},{label:"Email",value:o?.email}]})]})}return e.jsx(ht,{open:s,onOpenChange:t,children:e.jsxs(nt,{className:"w-full max-w-[min(100vw-24px,40rem)] sm:max-w-2xl p-4 sm:p-6 overflow-hidden bg-slate-900/95 border-slate-700/60",children:[e.jsx(pt,{className:"pb-3 border-b border-slate-600/30",children:e.jsxs(it,{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(at,{className:"h-4 w-4 text-blue-400"}),e.jsx("span",{className:"text-slate-200",children:"Trade Details"})]})}),e.jsxs("div",{className:"max-h-[70vh] overflow-y-auto space-y-3 min-w-0",children:[i,e.jsx("div",{className:"flex justify-end pt-3 mt-3 border-t border-slate-600/30",children:e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>t(!1),className:"h-8 px-3 bg-slate-700/60 hover:bg-slate-600/60 text-slate-200 border-slate-500/50",children:[e.jsx(ce,{className:"h-3 w-3 mr-1"}),"Close"]})})]})]})})}function or({status:s,perspective:t}){const a=pc[s]?.[t];if(!a)return e.jsxs("div",{className:"bg-slate-800/50 border border-slate-600/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-300 mb-2",children:[e.jsx(Qi,{className:"h-4 w-4"}),e.jsxs("span",{className:"font-medium",children:["Status: ",s]})]}),e.jsx("p",{className:"text-sm text-slate-400",children:"Application status is being processed."})]});const r=gc[a.color],n=a.icon;return e.jsxs("div",{className:`border rounded-lg p-3 ${r.bg}`,children:[e.jsxs("div",{className:`flex items-center gap-2 ${r.title} mb-2`,children:[e.jsx(n,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:a.title})]}),e.jsx("p",{className:`text-sm ${r.desc}`,children:a.desc})]})}function Nc(){const{user:s,isLoading:t}=ct(),{toast:a}=Zt(),[,r]=xs(),[n,i]=l.useState("my-listings"),[o,m]=l.useState(null),[h,f]=l.useState(!1),[d,y]=l.useState(!1),[b,N]=l.useState(null),[T,E]=l.useState(!1),[K,G]=l.useState(!1),[fe,z]=l.useState(!1),{data:B=[],isLoading:be,error:j,refetch:M}=Ve({queryKey:["/api/energy-trades"],enabled:!!s,retry:2,retryDelay:1e3,staleTime:1e3*60*2,refetchInterval:n==="my-listings"||n==="my-requests"?1e3*45:!1,refetchOnWindowFocus:!0,refetchOnReconnect:!0}),{data:C=[],isLoading:Q,refetch:R}=Ve({queryKey:["/api/trade-offers"],enabled:!!s,retry:2,retryDelay:1e3,staleTime:1e3*60*3,refetchInterval:1e3*60,refetchOnWindowFocus:!0}),{data:W=[]}=Ve({queryKey:["/api/households"],enabled:!!s}),{data:ae=[],isLoading:Ae,refetch:Ne}=Ve({queryKey:["/api/trade-acceptances"],enabled:!!s,retry:2,retryDelay:1e3,staleTime:1e3*60*2,refetchOnWindowFocus:!0}),{data:J=[],isLoading:ee,refetch:qe}=Ve({queryKey:["/api/my-trade-applications"],enabled:!!s,retry:2,retryDelay:1e3,staleTime:1e3*60*2,refetchOnWindowFocus:!0}),de=l.useMemo(()=>W.map(u=>u.id),[W]),Ee=l.useMemo(()=>[...B].sort((u,F)=>new Date(F.createdAt).getTime()-new Date(u.createdAt).getTime()),[B]),Je=l.useMemo(()=>{const u=new Map;return J.forEach(F=>{const $=F.acceptance?.tradeId||F.tradeId;$&&u.set($,(u.get($)||0)+1)}),u},[J]),H=u=>u.map(F=>({...F,acceptanceCount:Je.get(F.id)||0})),He=l.useMemo(()=>H(Ee.filter(u=>u.tradeType==="sell"&&u.sellerHouseholdId&&de.includes(u.sellerHouseholdId))),[Ee,de,Je]),De=l.useMemo(()=>H(Ee.filter(u=>u.tradeType==="buy"&&u.buyerHouseholdId&&de.includes(u.buyerHouseholdId))),[Ee,de,Je]),he=l.useMemo(()=>{if(!s)return null;const u=Ee.filter($=>$.sellerHouseholdId&&de.includes($.sellerHouseholdId)||$.buyerHouseholdId&&de.includes($.buyerHouseholdId)).length,F=["awarded","contacted"];return{totalTrades:u+ae.length+J.length,activeSellListings:He.filter($=>$.status==="pending").length,activeBuyRequests:De.filter($=>$.status==="pending").length,completedTrades:ae.filter($=>F.includes($.status)).length+J.filter($=>F.includes($.acceptance?.status)).length,availableOffers:C.length}},[s,Ee,de,He,De,C,ae,J]);l.useEffect(()=>{G(!0)},[]),l.useEffect(()=>{!be&&!ee&&setTimeout(()=>z(!0),100)},[be,ee]);const{createTrade:x,updateTrade:p,cancelTrade:k,shareContact:q,withdraw:_,decline:P,approve:v,applicantReject:I}=fc({onCreateSuccess:()=>f(!1),onEditSuccess:()=>{y(!1),m(null)}}),L=Ut({resolver:Yt(ar),defaultValues:{energyAmount:0,pricePerKwh:0,tradeType:"sell"}}),me=Ut({resolver:Yt(ar),defaultValues:{energyAmount:0,pricePerKwh:0,tradeType:"sell"}}),Me=u=>{m(u),me.reset({energyAmount:u.energyAmount,pricePerKwh:u.pricePerKwh,tradeType:u.tradeType}),y(!0)},At=async()=>{try{await Promise.all([M(),R(),Ne(),qe()]),a({title:"Data Refreshed",description:"All trade data has been updated successfully."})}catch{a({title:"Refresh Failed",description:"Failed to refresh data. Please try again.",variant:"destructive"})}},jt=u=>Fs(u),Ue=be||Q||Ae||ee,Ze=ae.filter(u=>!Ns.includes(u.status)),Et=J.filter(u=>!Ns.includes(u.acceptance?.status)),dt=ae.filter(u=>Ns.includes(u.status)),Dt=J.filter(u=>Ns.includes(u.acceptance?.status)),Mt=he?[{icon:Rt,cls:"text-blue-400",title:"My Sell Listings",value:he.activeSellListings,sub:"Energy for sale"},{icon:Nt,cls:"text-emerald-400",title:"My Buy Requests",value:he.activeBuyRequests,sub:"Energy needed"},{icon:Ui,cls:"text-blue-400",title:"Available Offers",value:he.availableOffers,sub:"To accept"},{icon:ie,cls:"text-purple-400",title:"Completed Trades",value:he.completedTrades,sub:"Successful"},{icon:Ie,cls:"text-indigo-400",title:"Total Activity",value:he.totalTrades,sub:"All time"}]:[];return t?e.jsxs("div",{className:"min-h-screen bg-slate-900",children:[e.jsx(Tt,{}),e.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pt-20",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(gt,{className:"h-8 w-8 animate-spin text-emerald-400"})})})]}):s?e.jsxs("div",{className:"min-h-screen bg-slate-900",children:[e.jsx(Tt,{currentPage:"storage"}),e.jsxs("div",{className:`max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pt-20 transition-all duration-300 ease-out ${K?"opacity-100 translate-y-0":"opacity-0 translate-y-2"}`,children:[e.jsxs("div",{className:"mb-8 flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-100 mb-2",children:"Energy Trading Hub"}),e.jsx("p",{className:"text-slate-400 text-sm sm:text-base",children:"Manage your energy listings, requests, and trading history"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs(w,{variant:"outline",onClick:At,disabled:Ue,className:"flex items-center justify-center gap-2 min-h-[44px] flex-1 sm:flex-none btn-smooth",children:[e.jsx(zt,{className:`mr-2 h-4 w-4 ${Ue?"animate-spin":""}`}),e.jsx("span",{className:"hidden sm:inline",children:Ue?"Updating...":"Refresh"}),e.jsx("span",{className:"sm:hidden",children:Ue?"Update":"Refresh"})]}),e.jsxs(w,{variant:"outline",onClick:()=>r("/?tab=energy-trading"),className:"flex items-center justify-center gap-2 min-h-[44px] bg-blue-600 hover:bg-blue-700 text-white border-blue-600 hover:border-blue-700 flex-1 sm:flex-none btn-smooth",children:[e.jsx(rt,{className:"h-4 w-4"}),e.jsx("span",{children:"Trade Market"})]}),e.jsxs(ht,{open:h,onOpenChange:f,children:[e.jsx(Bl,{asChild:!0,children:e.jsxs(w,{className:"bg-emerald-600 hover:bg-emerald-700 text-white flex items-center justify-center gap-2 min-h-[44px] flex-1 sm:flex-none btn-smooth",children:[e.jsx(ca,{className:"h-4 w-4"}),e.jsx("span",{children:"Create Trade"})]})}),e.jsxs(nt,{className:"bg-slate-800/50 border-slate-600/50",children:[e.jsx(pt,{children:e.jsx(it,{className:"text-slate-200",children:"Create Energy Trade"})}),e.jsx(Os,{...L,children:e.jsxs("form",{onSubmit:L.handleSubmit(u=>x.mutate(u)),className:"space-y-4",children:[e.jsx(We,{control:L.control,name:"tradeType",render:({field:u})=>e.jsxs(Re,{children:[e.jsx(_e,{children:"Trade Type"}),e.jsxs(ls,{onValueChange:u.onChange,defaultValue:u.value,children:[e.jsx(Qe,{children:e.jsx(Kt,{children:e.jsx(os,{placeholder:"Select trade type"})})}),e.jsxs(Qt,{children:[e.jsx(Pe,{value:"sell",children:"Sell Energy"}),e.jsx(Pe,{value:"buy",children:"Buy Energy"})]})]}),e.jsx(Be,{})]})}),e.jsx(We,{control:L.control,name:"energyAmount",render:({field:u})=>e.jsxs(Re,{children:[e.jsx(_e,{children:"Energy Amount (kWh)"}),e.jsx(Qe,{children:e.jsx(te,{type:"number",step:"1",...u})}),e.jsx(Be,{})]})}),e.jsx(We,{control:L.control,name:"pricePerKwh",render:({field:u})=>e.jsxs(Re,{children:[e.jsx(_e,{children:"Price per kWh (₹)"}),e.jsx(Qe,{children:e.jsx(te,{type:"number",step:"1",...u})}),e.jsx(Be,{})]})}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(w,{type:"button",variant:"outline",onClick:()=>f(!1),className:"bg-slate-800/50 border-slate-600/50 text-slate-300 hover:border-red-500",children:"Cancel"}),e.jsx(w,{type:"submit",disabled:x.isPending,children:x.isPending?"Creating...":"Create Trade"})]})]})})]})]})]})]}),Mt.length>0&&e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-5 gap-3 sm:gap-4 mb-6",children:Mt.map(u=>e.jsxs(D,{className:"bg-slate-800/50 border-slate-600/50",children:[e.jsx(se,{className:"pb-2",children:e.jsxs(le,{className:"text-sm font-medium flex items-center gap-2 text-slate-200",children:[e.jsx(u.icon,{className:`h-4 w-4 ${u.cls}`}),u.title]})}),e.jsxs(U,{children:[e.jsx("div",{className:`text-2xl font-bold ${u.cls}`,children:u.value}),e.jsx("p",{className:"text-xs text-slate-400",children:u.sub})]})]},u.title))}),e.jsx(D,{className:"mb-6 bg-slate-800/50 border-slate-600/50",children:e.jsx(U,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Yr,{className:"h-4 w-4 sm:h-5 sm:w-5 text-emerald-400"}),e.jsx("span",{className:"font-medium text-sm sm:text-base text-slate-200",children:"Data Status:"})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-6 sm:ml-0",children:[!be&&!j&&B.length>0&&e.jsxs(X,{variant:"default",className:"text-xs sm:text-sm",children:["Connected • ",B.filter(u=>u.status==="pending").length," active trade",B.filter(u=>u.status==="pending").length!==1?"s":""]}),!be&&B.length===0&&e.jsx(X,{variant:"outline",className:"text-xs sm:text-sm",children:"No trades in system"}),j&&e.jsx(X,{variant:"destructive",className:"text-xs sm:text-sm",children:"Connection Error"}),be&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(gt,{className:"h-4 w-4 animate-spin"}),e.jsx(X,{variant:"secondary",className:"text-xs sm:text-sm",children:"Loading..."})]})]})]}),e.jsxs("div",{className:"text-xs sm:text-sm text-slate-400 ml-6 sm:ml-0","aria-live":"polite",children:["Last updated: ",tt(new Date,"HH:mm:ss")]})]})})}),e.jsxs(En,{value:n,onValueChange:u=>i(u),className:"w-full",children:[e.jsxs(Ea,{className:"grid w-full grid-cols-4 gap-1 sm:gap-2 text-xs sm:text-sm mb-6 bg-slate-800/50 border-slate-600/50",children:[e.jsxs(lt,{value:"my-listings",className:"flex items-center justify-center gap-2 text-xs sm:text-sm",children:[e.jsx(Rt,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Sell Listings"}),e.jsx("span",{className:"sm:hidden",children:"Sell"}),"(",He.length,")"]}),e.jsxs(lt,{value:"my-requests",className:"flex items-center justify-center gap-2 text-xs sm:text-sm",children:[e.jsx(Nt,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Buy Requests"}),e.jsx("span",{className:"sm:hidden",children:"Buy"}),"(",De.length,")"]}),e.jsxs(lt,{value:"applications",className:"flex items-center justify-center gap-2 text-xs sm:text-sm",children:[e.jsx(at,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Applications"}),e.jsx("span",{className:"sm:hidden",children:"Apps"}),"(",Ze.length+Et.length,")"]}),e.jsxs(lt,{value:"request-results",className:"flex items-center justify-center gap-2 text-xs sm:text-sm",children:[e.jsx(ie,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Results"}),e.jsx("span",{className:"sm:hidden",children:"Results"}),"(",dt.length+Dt.length,")"]})]}),e.jsx(ot,{value:"my-listings",forceMount:!0,className:"tab-panel","data-state":n==="my-listings"?"active":"inactive",children:e.jsxs(D,{className:"bg-slate-800/50 border-slate-600/50",children:[e.jsxs(se,{children:[e.jsxs(le,{className:"flex items-center gap-2 text-slate-200",children:[e.jsx(Rt,{className:"h-5 w-5 text-blue-400"}),"Energy You're Selling"]}),e.jsx("p",{className:"text-sm text-slate-400",children:"Energy listings you've posted for others to buy"})]}),e.jsx(U,{children:He.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Rt,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No sell listings yet"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Create energy listings to start selling surplus power"})]}):e.jsx("div",{className:"space-y-4",children:He.map((u,F)=>e.jsx(nr,{trade:u,variant:"sell",index:F,dataLoaded:fe,cancelPending:k.isPending,onEdit:()=>Me(u),onCancel:()=>k.mutate(u.id),onViewApplications:()=>i("applications")},u.id))})})]})}),e.jsx(ot,{value:"my-requests",forceMount:!0,className:"tab-panel","data-state":n==="my-requests"?"active":"inactive",children:e.jsxs(D,{className:"bg-slate-800/50 border-slate-600/50",children:[e.jsxs(se,{children:[e.jsxs(le,{className:"flex items-center gap-2 text-slate-200",children:[e.jsx(Nt,{className:"h-5 w-5 text-emerald-400"}),"Energy You're Requesting"]}),e.jsx("p",{className:"text-sm text-slate-400",children:"Active and manageable buy requests (edit or cancel here)"})]}),e.jsx(U,{children:De.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Nt,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No buy requests yet"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Create requests to purchase energy from other users"})]}):e.jsx("div",{className:"space-y-4",children:De.map((u,F)=>e.jsx(nr,{trade:u,variant:"buy",index:F,dataLoaded:fe,cancelPending:k.isPending,onEdit:()=>Me(u),onCancel:()=>k.mutate(u.id),onViewApplications:()=>i("applications")},u.id))})})]})}),e.jsx(ot,{value:"applications",forceMount:!0,className:"tab-panel","data-state":n==="applications"?"active":"inactive",children:e.jsxs(D,{className:"bg-slate-800/50 border-slate-600/50",children:[e.jsxs(se,{children:[e.jsxs(le,{className:"flex items-center gap-2 text-slate-200",children:[e.jsx(at,{className:"h-5 w-5 text-blue-400"}),"Applications"]}),e.jsx("p",{className:"text-sm text-slate-400",children:"Applications you submitted to others and applications others submitted to your trades"})]}),e.jsx(U,{children:Ae||ee?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(gt,{className:"h-12 w-12 text-slate-400 mx-auto mb-4 animate-spin"}),e.jsx("p",{className:"text-slate-400",children:"Loading applications..."})]}):ae.length===0&&J.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(at,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"No applications yet"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Apply to energy trades or wait for others to apply to your trades"})]}):e.jsxs("div",{className:"space-y-6",children:[Ze.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-slate-200 mb-3 flex items-center gap-2",children:[e.jsx(za,{className:"h-4 w-4 text-emerald-400"}),"Applications I Submitted (",Ze.length,")"]}),e.jsx("div",{className:"space-y-4",children:Ze.map(u=>{const{trade:F}=rr(u.tradeId,B,C,u.trade),$=vs(u.status);return e.jsxs(D,{className:"overflow-hidden border-l-4 border-l-blue-400 shadow-sm hover:shadow-md transition-shadow duration-200 bg-slate-700/50 border-slate-600/50",children:[e.jsxs(se,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"h-5 w-5 text-emerald-400"}),e.jsxs("h3",{className:"text-lg font-semibold text-slate-200",children:["Energy ",F?.tradeType==="sell"?"Sale":"Purchase",": ",jt(F?.energyAmount||0)]})]}),e.jsxs(X,{variant:$.variant,className:"flex items-center gap-1",children:[e.jsx($.icon,{className:"h-3 w-3"}),$.label]})]}),e.jsxs("div",{className:"text-sm text-slate-400 mt-1",children:["Applied: ",tt(new Date(u.acceptedAt),"MMM dd, yyyy HH:mm")]})]}),e.jsxs(U,{className:"py-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-slate-300 mb-3",children:[e.jsx(bt,{className:"h-4 w-4 text-emerald-400"}),e.jsx("span",{children:"Applicant Details"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Name:"}),e.jsx("div",{className:"font-medium text-slate-200",children:s?.username||"User"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Household:"}),e.jsx("div",{className:"font-medium text-slate-200",children:W[0]?.name||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Location:"}),e.jsxs("div",{className:"font-medium text-slate-200",children:[s?.district||"Not specified",s?.state&&`, ${s.state}`]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Contact:"}),e.jsx("div",{className:"font-medium text-slate-200",children:u.status==="awarded"?e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{children:s?.email||"Email not available"}),s?.phone&&e.jsx("div",{children:s.phone}),W[0]?.address&&e.jsxs("div",{className:"text-xs text-slate-400",children:["Address: ",W[0].address]})]}):"Hidden until approved"})]})]})]}),e.jsx(xa,{className:"pt-3 border-t border-slate-600/50",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 w-full text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Energy Amount:"}),e.jsx("div",{className:"font-semibold text-slate-200",children:F?.energyAmount||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Price:"}),e.jsxs("div",{className:"font-semibold text-emerald-400",children:[F?.pricePerKwh||0," /kwh"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Status:"}),e.jsxs("div",{className:"flex items-center gap-1 font-medium text-slate-200",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${$.dotClass}`}),$.label]})]})]})}),u.status==="applied"&&e.jsx("div",{className:"px-6 pb-4",children:e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>_.mutate(u.id),disabled:_.isPending,className:"text-red-600 border-red-300 hover:bg-red-50 w-full",children:[e.jsx(ce,{className:"h-3 w-3 mr-1"}),_.isPending?"Withdrawing...":"Withdraw Application"]})}),u.status==="awarded"&&e.jsxs("div",{className:"px-6 pb-4 flex gap-2",children:[e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>I.mutate(u.id),disabled:I.isPending,className:"text-red-600 border-red-300 hover:bg-red-50 flex-1",children:[e.jsx(ce,{className:"h-3 w-3 mr-1"}),I.isPending?"Rejecting...":"Decline"]}),e.jsxs(w,{size:"sm",onClick:()=>q.mutate(u.id),disabled:q.isPending,className:"bg-green-600 hover:bg-green-700 flex-1",children:[e.jsx(ie,{className:"h-3 w-3 mr-1"}),q.isPending?"Sharing...":"Share Contact"]})]})]},u.id)})})]}),Et.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-slate-200 mb-3 flex items-center gap-2",children:[e.jsx(da,{className:"h-4 w-4 text-emerald-400"}),"Applications to My Trades (",Et.length,")"]}),e.jsx("div",{className:"space-y-4",children:Et.map(u=>{const F=vs(u.acceptance.status);return e.jsxs(D,{className:"overflow-hidden border-l-4 border-l-emerald-400 shadow-sm hover:shadow-md transition-shadow duration-200 bg-slate-800/50 border-slate-600/50",children:[e.jsxs(se,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"h-5 w-5 text-emerald-400"}),e.jsxs("h3",{className:"text-lg font-semibold text-slate-200",children:["Energy ",u.trade?.tradeType==="sell"?"Sale":"Purchase",": ",jt(u.trade?.energyAmount||0)]})]}),e.jsxs(X,{variant:F.variant,className:"flex items-center gap-1",children:[e.jsx(F.icon,{className:"h-3 w-3"}),F.label]})]}),e.jsxs("div",{className:"text-sm text-slate-400 mt-1",children:["Applied: ",tt(new Date(u.acceptance.acceptedAt),"MMM dd, yyyy HH:mm")]})]}),e.jsxs(U,{className:"py-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-slate-300 mb-3",children:[e.jsx(bt,{className:"h-4 w-4 text-emerald-400"}),e.jsx("span",{children:"Applicant Details"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Name:"}),e.jsx("div",{className:"font-medium text-slate-200",children:u.applicant?.username||"User"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Household:"}),e.jsx("div",{className:"font-medium text-slate-200",children:u.applicantHousehold?.name||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Location:"}),e.jsxs("div",{className:"font-medium text-slate-200",children:[u.applicant?.district||"Not specified",u.applicant?.state&&`, ${u.applicant.state}`]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Contact:"}),e.jsx("div",{className:"font-medium text-slate-200",children:u.acceptance.status==="awarded"?e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{children:u.applicant?.email||"Email not available"}),u.applicant?.phone&&e.jsx("div",{children:u.applicant.phone}),u.applicantHousehold?.address&&e.jsxs("div",{className:"text-xs text-slate-400",children:["Address: ",u.applicantHousehold.address]})]}):"Hidden until approved"})]})]})]}),e.jsx(xa,{className:"pt-3 border-t border-slate-600/50",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 w-full text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Energy Amount:"}),e.jsx("div",{className:"font-semibold text-slate-200",children:u.trade?.energyAmount||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Price:"}),e.jsxs("div",{className:"font-semibold text-emerald-400",children:[u.trade?.pricePerKwh||0," /kwh"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Status:"}),e.jsxs("div",{className:"flex items-center gap-1 font-medium text-slate-200",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${F.dotClass}`}),F.label]})]})]})}),u.acceptance.status==="applied"&&e.jsxs("div",{className:"px-6 pb-4 flex gap-2",children:[e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>P.mutate(u.acceptance.id),disabled:P.isPending,className:"text-red-400 border-red-600/50 hover:bg-red-900/20 bg-slate-700/50 flex-1",children:[e.jsx(ce,{className:"h-3 w-3 mr-1"}),P.isPending?"Rejecting...":"Decline"]}),e.jsxs(w,{size:"sm",onClick:()=>v.mutate(u.acceptance.id),disabled:v.isPending,className:"bg-emerald-600 hover:bg-emerald-700 flex-1",children:[e.jsx(ie,{className:"h-3 w-3 mr-1"}),v.isPending?"Approving...":"Approve"]})]}),u.acceptance.status==="awarded"&&e.jsx("div",{className:"px-6 pb-4",children:e.jsxs("div",{className:"bg-emerald-900/20 border border-emerald-600/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-400",children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Application Approved"})]}),e.jsx("p",{className:"text-sm text-emerald-300 mt-1",children:"You approved this application. Waiting for applicant to share contact or reject."})]})}),u.acceptance.status==="owner_rejected"&&e.jsx("div",{className:"px-6 pb-4",children:e.jsxs("div",{className:"bg-red-900/20 border border-red-600/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-400",children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Application Rejected"})]}),e.jsx("p",{className:"text-sm text-red-300 mt-1",children:"You rejected this application. Trade remains available."})]})})]},u.acceptance.id)})})]})]})})]})}),e.jsx(ot,{value:"request-results",forceMount:!0,className:"tab-panel","data-state":n==="request-results"?"active":"inactive",children:e.jsxs(D,{className:"bg-slate-800/50 border-slate-600/50",children:[e.jsxs(se,{children:[e.jsxs(le,{className:"flex items-center gap-2 text-slate-200",children:[e.jsx(ie,{className:"h-5 w-5 text-emerald-400"}),"Your Results"]}),e.jsx("p",{className:"text-sm text-slate-400",children:"Completed trade interactions with contact details and outcomes"})]}),e.jsx(U,{children:dt.length===0&&Dt.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ie,{className:"h-12 w-12 text-slate-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-300",children:"No completed trade interactions yet"}),e.jsx("p",{className:"text-sm text-slate-400",children:"When applications are finalized (contact shared or rejected), they will appear here"})]}):e.jsxs("div",{className:"space-y-4",children:[dt.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-slate-200 mb-3 flex items-center gap-2",children:[e.jsx(za,{className:"h-4 w-4 text-emerald-400"}),"My Application Results (",dt.length,")"]}),e.jsx("div",{className:"space-y-3",children:dt.map(u=>{const{trade:F}=rr(u.tradeId,B,C,u.trade),$=vs(u.status),gs=u.status==="contacted"?"border-l-emerald-400":u.status==="awarded"?"border-l-blue-400":"border-l-red-400";return F?.sellerHouseholdId||F?.buyerHouseholdId,e.jsxs(D,{className:`p-3 border-l-4 bg-slate-800/50 border-slate-600/50 ${gs}`,children:[e.jsx("div",{className:"flex justify-between items-start mb-3",children:e.jsxs("div",{className:"flex-1 space-y-1",children:[F?e.jsx("div",{className:"flex items-center justify-between gap-3 mb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"font-medium text-base text-slate-200",children:F.tradeType==="sell"?"Energy Purchase":"Energy Sale"}),e.jsxs("div",{className:"text-sm text-slate-400",children:[F.energyAmount," at ",F.pricePerKwh," /kwh • ",tt(new Date(u.acceptedAt),"MMM dd, yyyy")]})]})}):e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"font-medium text-base text-slate-200",children:"Trade Application"}),e.jsxs("div",{className:"text-xs text-slate-400",children:["Reference: ",u.tradeId," • ",tt(new Date(u.acceptedAt),"MMM dd, yyyy")]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(X,{variant:$.variant,className:"flex items-center gap-1",children:[e.jsx($.icon,{className:"h-3 w-3"}),$.label]}),$.showDetail&&e.jsxs(w,{size:"sm",variant:"outline",className:"h-8 px-3 bg-slate-700/60 hover:bg-slate-600/60 text-slate-200 border-slate-500/50",onClick:()=>{N(u),E(!0)},children:[e.jsx(at,{className:"h-3 w-3 mr-1"}),"Details"]})]})]})}),e.jsx(or,{status:u.status,perspective:"applicant"})]},u.id)})})]}),Dt.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-slate-200 mb-3 flex items-center gap-2",children:[e.jsx(da,{className:"h-4 w-4 text-emerald-400"}),"My Trade Results (",Dt.length,")"]}),e.jsx("div",{className:"space-y-3",children:Dt.map(u=>{const F=vs(u.acceptance.status),$=u.acceptance.status==="contacted"?"border-l-emerald-400":u.acceptance.status==="awarded"?"border-l-blue-400":"border-l-red-400";return e.jsxs(D,{className:`p-3 border-l-4 bg-slate-800/50 border-slate-600/50 ${$}`,children:[e.jsx("div",{className:"flex justify-between items-start mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center justify-between gap-3 mb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"font-medium text-base text-slate-200",children:u.trade?.tradeType==="sell"?"Your Sell Listing":"Your Buy Request"}),e.jsxs("div",{className:"text-sm text-slate-400",children:[u.trade?.energyAmount," at ",u.trade?.pricePerKwh," /kwh • ",tt(new Date(u.acceptance.acceptedAt),"MMM dd, yyyy")]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(X,{variant:F.variant,className:"flex items-center gap-1",children:[e.jsx(F.icon,{className:"h-3 w-3"}),F.label]}),F.showDetail&&e.jsxs(w,{size:"sm",variant:"outline",className:"h-8 px-3 bg-slate-700/60 hover:bg-slate-600/60 text-slate-200 border-slate-500/50",onClick:()=>{N(u),E(!0)},children:[e.jsx(at,{className:"h-3 w-3 mr-1"}),"Details"]})]})]})}),e.jsx(or,{status:u.acceptance.status,perspective:"owner"})]},u.acceptance.id)})})]})]})})]})})]}),e.jsx(jc,{open:d,onOpenChange:y,form:me,onSubmit:u=>o&&p.mutate({id:o.id,data:u}),isPending:p.isPending}),e.jsx(wc,{open:T,onOpenChange:E,detail:b,energyTrades:B,availableTradesData:C})]})]}):e.jsxs("div",{className:"min-h-screen bg-slate-900",children:[e.jsx(Tt,{}),e.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pt-20",children:e.jsxs(D,{className:"max-w-md mx-auto bg-slate-800/50 border-slate-600/50",children:[e.jsx(se,{children:e.jsxs(le,{className:"flex items-center gap-2 text-slate-200",children:[e.jsx(Ki,{className:"h-5 w-5 text-emerald-400"}),"Authentication Required"]})}),e.jsxs(U,{children:[e.jsx("p",{className:"text-slate-400 mb-6",children:"Please log in to view your energy trading history and manage your listings."}),e.jsx(w,{onClick:()=>r("/login"),className:"bg-emerald-600 hover:bg-emerald-700 text-white",children:"Go to Login"})]})]})})]})}const g=Symbol.for("drizzle:entityKind");function ue(s,t){if(!s||typeof s!="object")return!1;if(s instanceof t)return!0;if(!Object.prototype.hasOwnProperty.call(t,g))throw new Error(`Class "${t.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let a=Object.getPrototypeOf(s).constructor;if(a)for(;a;){if(g in a&&a[g]===t[g])return!0;a=Object.getPrototypeOf(a)}return!1}class ds{constructor(t,a){this.table=t,this.config=a,this.name=a.name,this.keyAsName=a.keyAsName,this.notNull=a.notNull,this.default=a.default,this.defaultFn=a.defaultFn,this.onUpdateFn=a.onUpdateFn,this.hasDefault=a.hasDefault,this.primary=a.primaryKey,this.isUnique=a.isUnique,this.uniqueName=a.uniqueName,this.uniqueType=a.uniqueType,this.dataType=a.dataType,this.columnType=a.columnType,this.generated=a.generated,this.generatedIdentity=a.generatedIdentity}static[g]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(t){return t}mapToDriverValue(t){return t}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}class vc{static[g]="ColumnBuilder";config;constructor(t,a,r){this.config={name:t,keyAsName:t==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:a,columnType:r,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(t){return this.config.default=t,this.config.hasDefault=!0,this}$defaultFn(t){return this.config.defaultFn=t,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(t){return this.config.onUpdateFn=t,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(t){this.config.name===""&&(this.config.name=t)}}const $t=Symbol.for("drizzle:Name");class Sc{static[g]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(t,a){this.reference=()=>{const{name:r,columns:n,foreignColumns:i}=t();return{name:r,columns:n,foreignTable:i[0].table,foreignColumns:i}},a&&(this._onUpdate=a.onUpdate,this._onDelete=a.onDelete)}onUpdate(t){return this._onUpdate=t===void 0?"no action":t,this}onDelete(t){return this._onDelete=t===void 0?"no action":t,this}build(t){return new Pc(t,this)}}class Pc{constructor(t,a){this.table=t,this.reference=a.reference,this.onUpdate=a._onUpdate,this.onDelete=a._onDelete}static[g]="PgForeignKey";reference;onUpdate;onDelete;getName(){const{name:t,columns:a,foreignColumns:r}=this.reference(),n=a.map(m=>m.name),i=r.map(m=>m.name),o=[this.table[$t],...n,r[0].table[$t],...i];return t??`${o.join("_")}_fk`}}function Tc(s,...t){return s(...t)}function Cc(s,t){return`${s[$t]}_${t.join("_")}_unique`}function cr(s,t,a){for(let r=t;r<s.length;r++){const n=s[r];if(n==="\\"){r++;continue}if(n==='"')return[s.slice(t,r).replace(/\\/g,""),r+1];if(!a&&(n===","||n==="}"))return[s.slice(t,r).replace(/\\/g,""),r]}return[s.slice(t).replace(/\\/g,""),s.length]}function _n(s,t=0){const a=[];let r=t,n=!1;for(;r<s.length;){const i=s[r];if(i===","){(n||r===t)&&a.push(""),n=!0,r++;continue}if(n=!1,i==="\\"){r+=2;continue}if(i==='"'){const[h,f]=cr(s,r+1,!0);a.push(h),r=f;continue}if(i==="}")return[a,r+1];if(i==="{"){const[h,f]=_n(s,r+1);a.push(h),r=f;continue}const[o,m]=cr(s,r,!1);a.push(o),r=m}return[a,r]}function kc(s){const[t]=_n(s,1);return t}function Bn(s){return`{${s.map(t=>Array.isArray(t)?Bn(t):typeof t=="string"?`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${t}`).join(",")}}`}class V extends vc{foreignKeyConfigs=[];static[g]="PgColumnBuilder";array(t){return new Ac(this.config.name,this,t)}references(t,a={}){return this.foreignKeyConfigs.push({ref:t,actions:a}),this}unique(t,a){return this.config.isUnique=!0,this.config.uniqueName=t,this.config.uniqueType=a?.nulls,this}generatedAlwaysAs(t){return this.config.generated={as:t,type:"always",mode:"stored"},this}buildForeignKeys(t,a){return this.foreignKeyConfigs.map(({ref:r,actions:n})=>Tc((i,o)=>{const m=new Sc(()=>{const h=i();return{columns:[t],foreignColumns:[h]}});return o.onUpdate&&m.onUpdate(o.onUpdate),o.onDelete&&m.onDelete(o.onDelete),m.build(a)},r,n))}buildExtraConfigColumn(t){return new Ic(t,this.config)}}class O extends ds{constructor(t,a){a.uniqueName||(a.uniqueName=Cc(t,[a.name])),super(t,a),this.table=t}static[g]="PgColumn"}class Ic extends O{static[g]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(t){return this.indexConfig.opClass=t,this}}class sa{static[g]="IndexedColumn";constructor(t,a,r,n){this.name=t,this.keyAsName=a,this.type=r,this.indexConfig=n}name;keyAsName;type;indexConfig}class Ac extends V{static[g]="PgArrayBuilder";constructor(t,a,r){super(t,"array","PgArray"),this.config.baseBuilder=a,this.config.size=r}build(t){const a=this.config.baseBuilder.build(t);return new Da(t,this.config,a)}}class Da extends O{constructor(t,a,r,n){super(t,a),this.baseColumn=r,this.range=n,this.size=a.size}size;static[g]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(t){return typeof t=="string"&&(t=kc(t)),t.map(a=>this.baseColumn.mapFromDriverValue(a))}mapToDriverValue(t,a=!1){const r=t.map(n=>n===null?null:ue(this.baseColumn,Da)?this.baseColumn.mapToDriverValue(n,!0):this.baseColumn.mapToDriverValue(n));return a?r:Bn(r)}}const dr=Symbol.for("drizzle:isPgEnum");function Ec(s){return!!s&&typeof s=="function"&&dr in s&&s[dr]===!0}class zn{static[g]="Subquery";constructor(t,a,r,n=!1){this._={brand:"Subquery",sql:t,selectedFields:a,alias:r,isWith:n}}}const Dc={startActiveSpan(s,t){return t()}},Vt=Symbol.for("drizzle:ViewBaseConfig"),aa=Symbol.for("drizzle:Schema"),mr=Symbol.for("drizzle:Columns"),ur=Symbol.for("drizzle:ExtraConfigColumns"),ra=Symbol.for("drizzle:OriginalName"),na=Symbol.for("drizzle:BaseName"),_s=Symbol.for("drizzle:IsAlias"),xr=Symbol.for("drizzle:ExtraConfigBuilder"),qn=Symbol.for("drizzle:IsDrizzleTable");class ze{static[g]="Table";static Symbol={Name:$t,Schema:aa,OriginalName:ra,Columns:mr,ExtraConfigColumns:ur,BaseName:na,IsAlias:_s,ExtraConfigBuilder:xr};[$t];[ra];[aa];[mr];[ur];[na];[_s]=!1;[qn]=!0;[xr]=void 0;constructor(t,a,r){this[$t]=this[ra]=t,this[aa]=a,this[na]=r}}function $n(s){return typeof s=="object"&&s!==null&&qn in s}function Mc(s){return s!=null&&typeof s.getSQL=="function"}function Lc(s){const t={sql:"",params:[]};for(const a of s)t.sql+=a.sql,t.params.push(...a.params),a.typings?.length&&(t.typings||(t.typings=[]),t.typings.push(...a.typings));return t}class Ke{static[g]="StringChunk";value;constructor(t){this.value=Array.isArray(t)?t:[t]}getSQL(){return new Z([this])}}class Z{constructor(t){this.queryChunks=t}static[g]="SQL";decoder=Vn;shouldInlineParams=!1;append(t){return this.queryChunks.push(...t.queryChunks),this}toQuery(t){return Dc.startActiveSpan("drizzle.buildSQL",a=>{const r=this.buildQueryFromSourceParams(this.queryChunks,t);return a?.setAttributes({"drizzle.query.text":r.sql,"drizzle.query.params":JSON.stringify(r.params)}),r})}buildQueryFromSourceParams(t,a){const r=Object.assign({},a,{inlineParams:a.inlineParams||this.shouldInlineParams,paramStartIndex:a.paramStartIndex||{value:0}}),{casing:n,escapeName:i,escapeParam:o,prepareTyping:m,inlineParams:h,paramStartIndex:f}=r;return Lc(t.map(d=>{if(ue(d,Ke))return{sql:d.value.join(""),params:[]};if(ue(d,fa))return{sql:i(d.value),params:[]};if(d===void 0)return{sql:"",params:[]};if(Array.isArray(d)){const y=[new Ke("(")];for(const[b,N]of d.entries())y.push(N),b<d.length-1&&y.push(new Ke(", "));return y.push(new Ke(")")),this.buildQueryFromSourceParams(y,r)}if(ue(d,Z))return this.buildQueryFromSourceParams(d.queryChunks,{...r,inlineParams:h||d.shouldInlineParams});if(ue(d,ze)){const y=d[ze.Symbol.Schema],b=d[ze.Symbol.Name];return{sql:y===void 0||d[_s]?i(b):i(y)+"."+i(b),params:[]}}if(ue(d,ds)){const y=n.getColumnCasing(d);if(a.invokeSource==="indexes")return{sql:i(y),params:[]};const b=d.table[ze.Symbol.Schema];return{sql:d.table[_s]||b===void 0?i(d.table[ze.Symbol.Name])+"."+i(y):i(b)+"."+i(d.table[ze.Symbol.Name])+"."+i(y),params:[]}}if(ue(d,Fc)){const y=d[Vt].schema,b=d[Vt].name;return{sql:y===void 0||d[Vt].isAlias?i(b):i(y)+"."+i(b),params:[]}}if(ue(d,Hn)){if(ue(d.value,ba))return{sql:o(f.value++,d),params:[d],typings:["none"]};const y=d.value===null?null:d.encoder.mapToDriverValue(d.value);if(ue(y,Z))return this.buildQueryFromSourceParams([y],r);if(h)return{sql:this.mapInlineParam(y,r),params:[]};let b=["none"];return m&&(b=[m(d.encoder)]),{sql:o(f.value++,y),params:[y],typings:b}}return ue(d,ba)?{sql:o(f.value++,d),params:[d],typings:["none"]}:ue(d,Z.Aliased)&&d.fieldAlias!==void 0?{sql:i(d.fieldAlias),params:[]}:ue(d,zn)?d._.isWith?{sql:i(d._.alias),params:[]}:this.buildQueryFromSourceParams([new Ke("("),d._.sql,new Ke(") "),new fa(d._.alias)],r):Ec(d)?d.schema?{sql:i(d.schema)+"."+i(d.enumName),params:[]}:{sql:i(d.enumName),params:[]}:Mc(d)?d.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([d.getSQL()],r):this.buildQueryFromSourceParams([new Ke("("),d.getSQL(),new Ke(")")],r):h?{sql:this.mapInlineParam(d,r),params:[]}:{sql:o(f.value++,d),params:[d],typings:["none"]}}))}mapInlineParam(t,{escapeString:a}){if(t===null)return"null";if(typeof t=="number"||typeof t=="boolean")return t.toString();if(typeof t=="string")return a(t);if(typeof t=="object"){const r=t.toString();return a(r==="[object Object]"?JSON.stringify(t):r)}throw new Error("Unexpected param value: "+t)}getSQL(){return this}as(t){return t===void 0?this:new Z.Aliased(this,t)}mapWith(t){return this.decoder=typeof t=="function"?{mapFromDriverValue:t}:t,this}inlineParams(){return this.shouldInlineParams=!0,this}if(t){return t?this:void 0}}class fa{constructor(t){this.value=t}static[g]="Name";brand;getSQL(){return new Z([this])}}const Vn={mapFromDriverValue:s=>s},Wn={mapToDriverValue:s=>s};({...Vn,...Wn});class Hn{constructor(t,a=Wn){this.value=t,this.encoder=a}static[g]="Param";brand;getSQL(){return new Z([this])}}function Bs(s,...t){const a=[];(t.length>0||s.length>0&&s[0]!=="")&&a.push(new Ke(s[0]));for(const[r,n]of t.entries())a.push(n,new Ke(s[r+1]));return new Z(a)}(s=>{function t(){return new Z([])}s.empty=t;function a(h){return new Z(h)}s.fromList=a;function r(h){return new Z([new Ke(h)])}s.raw=r;function n(h,f){const d=[];for(const[y,b]of h.entries())y>0&&f!==void 0&&d.push(f),d.push(b);return new Z(d)}s.join=n;function i(h){return new fa(h)}s.identifier=i;function o(h){return new ba(h)}s.placeholder=o;function m(h,f){return new Hn(h,f)}s.param=m})(Bs||(Bs={}));(s=>{class t{constructor(r,n){this.sql=r,this.fieldAlias=n}static[g]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new t(this.sql,this.fieldAlias)}}s.Aliased=t})(Z||(Z={}));class ba{constructor(t){this.name=t}static[g]="Placeholder";getSQL(){return new Z([this])}}const Un=Symbol.for("drizzle:IsDrizzleView");class Fc{static[g]="View";[Vt];[Un]=!0;constructor({name:t,schema:a,selectedFields:r,query:n}){this[Vt]={name:t,originalName:t,schema:a,selectedFields:r,query:n,isExisting:!n,isAlias:!1}}getSQL(){return new Z([this])}}function Oc(s){return typeof s=="object"&&s!==null&&Un in s}ds.prototype.getSQL=function(){return new Z([this])};ze.prototype.getSQL=function(){return new Z([this])};zn.prototype.getSQL=function(){return new Z([this])};function Rc(s){return s[ze.Symbol.Columns]}function _c(s){return s[Vt].selectedFields}function we(s,t){return{name:typeof s=="string"&&s.length>0?s:"",config:typeof s=="object"?s:t}}class Qs extends V{static[g]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(t){if(t){const{name:a,...r}=t;this.config.generatedIdentity={type:"always",sequenceName:a,sequenceOptions:r}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(t){if(t){const{name:a,...r}=t;this.config.generatedIdentity={type:"byDefault",sequenceName:a,sequenceOptions:r}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}class Bc extends Qs{static[g]="PgBigInt53Builder";constructor(t){super(t,"number","PgBigInt53")}build(t){return new zc(t,this.config)}}class zc extends O{static[g]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(t){return typeof t=="number"?t:Number(t)}}class qc extends Qs{static[g]="PgBigInt64Builder";constructor(t){super(t,"bigint","PgBigInt64")}build(t){return new $c(t,this.config)}}class $c extends O{static[g]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(t){return BigInt(t)}}function Vc(s,t){const{name:a,config:r}=we(s,t);return r.mode==="number"?new Bc(a):new qc(a)}class Wc extends V{static[g]="PgBigSerial53Builder";constructor(t){super(t,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(t){return new Hc(t,this.config)}}class Hc extends O{static[g]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(t){return typeof t=="number"?t:Number(t)}}class Uc extends V{static[g]="PgBigSerial64Builder";constructor(t){super(t,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(t){return new Kc(t,this.config)}}class Kc extends O{static[g]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(t){return BigInt(t)}}function Qc(s,t){const{name:a,config:r}=we(s,t);return r.mode==="number"?new Wc(a):new Uc(a)}class Yc extends V{static[g]="PgBooleanBuilder";constructor(t){super(t,"boolean","PgBoolean")}build(t){return new Gc(t,this.config)}}class Gc extends O{static[g]="PgBoolean";getSQLType(){return"boolean"}}function Ma(s){return new Yc(s??"")}class Xc extends V{static[g]="PgCharBuilder";constructor(t,a){super(t,"string","PgChar"),this.config.length=a.length,this.config.enumValues=a.enum}build(t){return new Jc(t,this.config)}}class Jc extends O{static[g]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}function Zc(s,t={}){const{name:a,config:r}=we(s,t);return new Xc(a,r)}class ed extends V{static[g]="PgCidrBuilder";constructor(t){super(t,"string","PgCidr")}build(t){return new td(t,this.config)}}class td extends O{static[g]="PgCidr";getSQLType(){return"cidr"}}function sd(s){return new ed(s??"")}class ad extends V{static[g]="PgCustomColumnBuilder";constructor(t,a,r){super(t,"custom","PgCustomColumn"),this.config.fieldConfig=a,this.config.customTypeParams=r}build(t){return new rd(t,this.config)}}class rd extends O{static[g]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(t,a){super(t,a),this.sqlName=a.customTypeParams.dataType(a.fieldConfig),this.mapTo=a.customTypeParams.toDriver,this.mapFrom=a.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(t){return typeof this.mapFrom=="function"?this.mapFrom(t):t}mapToDriverValue(t){return typeof this.mapTo=="function"?this.mapTo(t):t}}function nd(s){return(t,a)=>{const{name:r,config:n}=we(t,a);return new ad(r,n,s)}}class hs extends V{static[g]="PgDateColumnBaseBuilder";defaultNow(){return this.default(Bs`now()`)}}class id extends hs{static[g]="PgDateBuilder";constructor(t){super(t,"date","PgDate")}build(t){return new ld(t,this.config)}}class ld extends O{static[g]="PgDate";getSQLType(){return"date"}mapFromDriverValue(t){return new Date(t)}mapToDriverValue(t){return t.toISOString()}}class od extends hs{static[g]="PgDateStringBuilder";constructor(t){super(t,"string","PgDateString")}build(t){return new cd(t,this.config)}}class cd extends O{static[g]="PgDateString";getSQLType(){return"date"}}function dd(s,t){const{name:a,config:r}=we(s,t);return r?.mode==="date"?new id(a):new od(a)}class md extends V{static[g]="PgDoublePrecisionBuilder";constructor(t){super(t,"number","PgDoublePrecision")}build(t){return new ud(t,this.config)}}class ud extends O{static[g]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(t){return typeof t=="string"?Number.parseFloat(t):t}}function xd(s){return new md(s??"")}class hd extends V{static[g]="PgInetBuilder";constructor(t){super(t,"string","PgInet")}build(t){return new pd(t,this.config)}}class pd extends O{static[g]="PgInet";getSQLType(){return"inet"}}function gd(s){return new hd(s??"")}class fd extends Qs{static[g]="PgIntegerBuilder";constructor(t){super(t,"number","PgInteger")}build(t){return new bd(t,this.config)}}class bd extends O{static[g]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(t){return typeof t=="string"?Number.parseInt(t):t}}function ge(s){return new fd(s??"")}class yd extends V{static[g]="PgIntervalBuilder";constructor(t,a){super(t,"string","PgInterval"),this.config.intervalConfig=a}build(t){return new jd(t,this.config)}}class jd extends O{static[g]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){const t=this.fields?` ${this.fields}`:"",a=this.precision?`(${this.precision})`:"";return`interval${t}${a}`}}function wd(s,t={}){const{name:a,config:r}=we(s,t);return new yd(a,r)}class Nd extends V{static[g]="PgJsonBuilder";constructor(t){super(t,"json","PgJson")}build(t){return new vd(t,this.config)}}class vd extends O{static[g]="PgJson";constructor(t,a){super(t,a)}getSQLType(){return"json"}mapToDriverValue(t){return JSON.stringify(t)}mapFromDriverValue(t){if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t}}function Sd(s){return new Nd(s??"")}class Pd extends V{static[g]="PgJsonbBuilder";constructor(t){super(t,"json","PgJsonb")}build(t){return new Td(t,this.config)}}class Td extends O{static[g]="PgJsonb";constructor(t,a){super(t,a)}getSQLType(){return"jsonb"}mapToDriverValue(t){return JSON.stringify(t)}mapFromDriverValue(t){if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t}}function Kn(s){return new Pd(s??"")}class Cd extends V{static[g]="PgLineBuilder";constructor(t){super(t,"array","PgLine")}build(t){return new kd(t,this.config)}}class kd extends O{static[g]="PgLine";getSQLType(){return"line"}mapFromDriverValue(t){const[a,r,n]=t.slice(1,-1).split(",");return[Number.parseFloat(a),Number.parseFloat(r),Number.parseFloat(n)]}mapToDriverValue(t){return`{${t[0]},${t[1]},${t[2]}}`}}class Id extends V{static[g]="PgLineABCBuilder";constructor(t){super(t,"json","PgLineABC")}build(t){return new Ad(t,this.config)}}class Ad extends O{static[g]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(t){const[a,r,n]=t.slice(1,-1).split(",");return{a:Number.parseFloat(a),b:Number.parseFloat(r),c:Number.parseFloat(n)}}mapToDriverValue(t){return`{${t.a},${t.b},${t.c}}`}}function Ed(s,t){const{name:a,config:r}=we(s,t);return!r?.mode||r.mode==="tuple"?new Cd(a):new Id(a)}class Dd extends V{static[g]="PgMacaddrBuilder";constructor(t){super(t,"string","PgMacaddr")}build(t){return new Md(t,this.config)}}class Md extends O{static[g]="PgMacaddr";getSQLType(){return"macaddr"}}function Ld(s){return new Dd(s??"")}class Fd extends V{static[g]="PgMacaddr8Builder";constructor(t){super(t,"string","PgMacaddr8")}build(t){return new Od(t,this.config)}}class Od extends O{static[g]="PgMacaddr8";getSQLType(){return"macaddr8"}}function Rd(s){return new Fd(s??"")}class _d extends V{static[g]="PgNumericBuilder";constructor(t,a,r){super(t,"string","PgNumeric"),this.config.precision=a,this.config.scale=r}build(t){return new Bd(t,this.config)}}class Bd extends O{static[g]="PgNumeric";precision;scale;constructor(t,a){super(t,a),this.precision=a.precision,this.scale=a.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}}function zd(s,t){const{name:a,config:r}=we(s,t);return new _d(a,r?.precision,r?.scale)}class qd extends V{static[g]="PgPointTupleBuilder";constructor(t){super(t,"array","PgPointTuple")}build(t){return new $d(t,this.config)}}class $d extends O{static[g]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(t){if(typeof t=="string"){const[a,r]=t.slice(1,-1).split(",");return[Number.parseFloat(a),Number.parseFloat(r)]}return[t.x,t.y]}mapToDriverValue(t){return`(${t[0]},${t[1]})`}}class Vd extends V{static[g]="PgPointObjectBuilder";constructor(t){super(t,"json","PgPointObject")}build(t){return new Wd(t,this.config)}}class Wd extends O{static[g]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(t){if(typeof t=="string"){const[a,r]=t.slice(1,-1).split(",");return{x:Number.parseFloat(a),y:Number.parseFloat(r)}}return t}mapToDriverValue(t){return`(${t.x},${t.y})`}}function Hd(s,t){const{name:a,config:r}=we(s,t);return!r?.mode||r.mode==="tuple"?new qd(a):new Vd(a)}function Ud(s){const t=[];for(let a=0;a<s.length;a+=2)t.push(Number.parseInt(s.slice(a,a+2),16));return new Uint8Array(t)}function hr(s,t){const a=new ArrayBuffer(8),r=new DataView(a);for(let n=0;n<8;n++)r.setUint8(n,s[t+n]);return r.getFloat64(0,!0)}function Qn(s){const t=Ud(s);let a=0;const r=t[a];a+=1;const n=new DataView(t.buffer),i=n.getUint32(a,r===1);if(a+=4,i&536870912&&(n.getUint32(a,r===1),a+=4),(i&65535)===1){const o=hr(t,a);a+=8;const m=hr(t,a);return a+=8,[o,m]}throw new Error("Unsupported geometry type")}class Kd extends V{static[g]="PgGeometryBuilder";constructor(t){super(t,"array","PgGeometry")}build(t){return new Qd(t,this.config)}}class Qd extends O{static[g]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(t){return Qn(t)}mapToDriverValue(t){return`point(${t[0]} ${t[1]})`}}class Yd extends V{static[g]="PgGeometryObjectBuilder";constructor(t){super(t,"json","PgGeometryObject")}build(t){return new Gd(t,this.config)}}class Gd extends O{static[g]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(t){const a=Qn(t);return{x:a[0],y:a[1]}}mapToDriverValue(t){return`point(${t.x} ${t.y})`}}function Xd(s,t){const{name:a,config:r}=we(s,t);return!r?.mode||r.mode==="tuple"?new Kd(a):new Yd(a)}class Jd extends V{static[g]="PgRealBuilder";constructor(t,a){super(t,"number","PgReal"),this.config.length=a}build(t){return new Zd(t,this.config)}}class Zd extends O{static[g]="PgReal";constructor(t,a){super(t,a)}getSQLType(){return"real"}mapFromDriverValue=t=>typeof t=="string"?Number.parseFloat(t):t}function em(s){return new Jd(s??"")}class tm extends V{static[g]="PgSerialBuilder";constructor(t){super(t,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(t){return new sm(t,this.config)}}class sm extends O{static[g]="PgSerial";getSQLType(){return"serial"}}function kt(s){return new tm(s??"")}class am extends Qs{static[g]="PgSmallIntBuilder";constructor(t){super(t,"number","PgSmallInt")}build(t){return new rm(t,this.config)}}class rm extends O{static[g]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=t=>typeof t=="string"?Number(t):t}function nm(s){return new am(s??"")}class im extends V{static[g]="PgSmallSerialBuilder";constructor(t){super(t,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(t){return new lm(t,this.config)}}class lm extends O{static[g]="PgSmallSerial";getSQLType(){return"smallserial"}}function om(s){return new im(s??"")}class cm extends V{static[g]="PgTextBuilder";constructor(t,a){super(t,"string","PgText"),this.config.enumValues=a.enum}build(t){return new dm(t,this.config)}}class dm extends O{static[g]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}function xe(s,t={}){const{name:a,config:r}=we(s,t);return new cm(a,r)}class mm extends hs{constructor(t,a,r){super(t,"string","PgTime"),this.withTimezone=a,this.precision=r,this.config.withTimezone=a,this.config.precision=r}static[g]="PgTimeBuilder";build(t){return new um(t,this.config)}}class um extends O{static[g]="PgTime";withTimezone;precision;constructor(t,a){super(t,a),this.withTimezone=a.withTimezone,this.precision=a.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}function xm(s,t={}){const{name:a,config:r}=we(s,t);return new mm(a,r.withTimezone??!1,r.precision)}class hm extends hs{static[g]="PgTimestampBuilder";constructor(t,a,r){super(t,"date","PgTimestamp"),this.config.withTimezone=a,this.config.precision=r}build(t){return new pm(t,this.config)}}class pm extends O{static[g]="PgTimestamp";withTimezone;precision;constructor(t,a){super(t,a),this.withTimezone=a.withTimezone,this.precision=a.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=t=>new Date(this.withTimezone?t:t+"+0000");mapToDriverValue=t=>t.toISOString()}class gm extends hs{static[g]="PgTimestampStringBuilder";constructor(t,a,r){super(t,"string","PgTimestampString"),this.config.withTimezone=a,this.config.precision=r}build(t){return new fm(t,this.config)}}class fm extends O{static[g]="PgTimestampString";withTimezone;precision;constructor(t,a){super(t,a),this.withTimezone=a.withTimezone,this.precision=a.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}function Ge(s,t={}){const{name:a,config:r}=we(s,t);return r?.mode==="string"?new gm(a,r.withTimezone??!1,r.precision):new hm(a,r?.withTimezone??!1,r?.precision)}class bm extends V{static[g]="PgUUIDBuilder";constructor(t){super(t,"string","PgUUID")}defaultRandom(){return this.default(Bs`gen_random_uuid()`)}build(t){return new ym(t,this.config)}}class ym extends O{static[g]="PgUUID";getSQLType(){return"uuid"}}function jm(s){return new bm(s??"")}class wm extends V{static[g]="PgVarcharBuilder";constructor(t,a){super(t,"string","PgVarchar"),this.config.length=a.length,this.config.enumValues=a.enum}build(t){return new Nm(t,this.config)}}class Nm extends O{static[g]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}function vm(s,t={}){const{name:a,config:r}=we(s,t);return new wm(a,r)}class Sm extends V{static[g]="PgBinaryVectorBuilder";constructor(t,a){super(t,"string","PgBinaryVector"),this.config.dimensions=a.dimensions}build(t){return new Pm(t,this.config)}}class Pm extends O{static[g]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}function Tm(s,t){const{name:a,config:r}=we(s,t);return new Sm(a,r)}class Cm extends V{static[g]="PgHalfVectorBuilder";constructor(t,a){super(t,"array","PgHalfVector"),this.config.dimensions=a.dimensions}build(t){return new km(t,this.config)}}class km extends O{static[g]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(t){return JSON.stringify(t)}mapFromDriverValue(t){return t.slice(1,-1).split(",").map(a=>Number.parseFloat(a))}}function Im(s,t){const{name:a,config:r}=we(s,t);return new Cm(a,r)}class Am extends V{static[g]="PgSparseVectorBuilder";constructor(t,a){super(t,"string","PgSparseVector"),this.config.dimensions=a.dimensions}build(t){return new Em(t,this.config)}}class Em extends O{static[g]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}}function Dm(s,t){const{name:a,config:r}=we(s,t);return new Am(a,r)}class Mm extends V{static[g]="PgVectorBuilder";constructor(t,a){super(t,"array","PgVector"),this.config.dimensions=a.dimensions}build(t){return new Lm(t,this.config)}}class Lm extends O{static[g]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(t){return JSON.stringify(t)}mapFromDriverValue(t){return t.slice(1,-1).split(",").map(a=>Number.parseFloat(a))}}function Fm(s,t){const{name:a,config:r}=we(s,t);return new Mm(a,r)}function Om(){return{bigint:Vc,bigserial:Qc,boolean:Ma,char:Zc,cidr:sd,customType:nd,date:dd,doublePrecision:xd,inet:gd,integer:ge,interval:wd,json:Sd,jsonb:Kn,line:Ed,macaddr:Ld,macaddr8:Rd,numeric:zd,point:Hd,geometry:Xd,real:em,serial:kt,smallint:nm,smallserial:om,text:xe,time:xm,timestamp:Ge,uuid:jm,varchar:vm,bit:Tm,halfvec:Im,sparsevec:Dm,vector:Fm}}const ya=Symbol.for("drizzle:PgInlineForeignKeys"),pr=Symbol.for("drizzle:EnableRLS");class ia extends ze{static[g]="PgTable";static Symbol=Object.assign({},ze.Symbol,{InlineForeignKeys:ya,EnableRLS:pr});[ya]=[];[pr]=!1;[ze.Symbol.ExtraConfigBuilder]=void 0}function Rm(s,t,a,r,n=s){const i=new ia(s,r,n),o=typeof t=="function"?t(Om()):t,m=Object.fromEntries(Object.entries(o).map(([d,y])=>{const b=y;b.setName(d);const N=b.build(i);return i[ya].push(...b.buildForeignKeys(N,i)),[d,N]})),h=Object.fromEntries(Object.entries(o).map(([d,y])=>{const b=y;b.setName(d);const N=b.buildExtraConfigColumn(i);return[d,N]})),f=Object.assign(i,m);return f[ze.Symbol.Columns]=m,f[ze.Symbol.ExtraConfigColumns]=h,a&&(f[ia.Symbol.ExtraConfigBuilder]=a),Object.assign(f,{enableRLS:()=>(f[ia.Symbol.EnableRLS]=!0,f)})}const It=(s,t,a)=>Rm(s,t,a,void 0);class _m{constructor(t,a){this.unique=t,this.name=a}static[g]="PgIndexBuilderOn";on(...t){return new la(t.map(a=>{if(ue(a,Z))return a;a=a;const r=new sa(a.name,!!a.keyAsName,a.columnType,a.indexConfig);return a.indexConfig=JSON.parse(JSON.stringify(a.defaultConfig)),r}),this.unique,!1,this.name)}onOnly(...t){return new la(t.map(a=>{if(ue(a,Z))return a;a=a;const r=new sa(a.name,!!a.keyAsName,a.columnType,a.indexConfig);return a.indexConfig=a.defaultConfig,r}),this.unique,!0,this.name)}using(t,...a){return new la(a.map(r=>{if(ue(r,Z))return r;r=r;const n=new sa(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),n}),this.unique,!0,this.name,t)}}class la{static[g]="PgIndexBuilder";config;constructor(t,a,r,n,i="btree"){this.config={name:n,columns:t,unique:a,only:r,method:i}}concurrently(){return this.config.concurrently=!0,this}with(t){return this.config.with=t,this}where(t){return this.config.where=t,this}build(t){return new Bm(this.config,t)}}class Bm{static[g]="PgIndex";config;constructor(t,a){this.config={...t,table:a}}}function Ye(s){return new _m(!1,s)}const re={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function oe(s,t){return t.includes(s.columnType)}function zm(s){return"enumValues"in s&&Array.isArray(s.enumValues)&&s.enumValues.length>0}const qm=sn([$e(),Ls(),an(),rl()]),$m=sn([qm,nl(ua()),rn(ua())]),Vm=il(s=>s instanceof Buffer);function Yn(s,t){const a=t?.zodInstance??ll,r=t?.coerce??{};let n;return zm(s)&&(n=s.enumValues.length?a.enum(s.enumValues):a.string()),n||(oe(s,["PgGeometry","PgPointTuple"])?n=a.tuple([a.number(),a.number()]):oe(s,["PgGeometryObject","PgPointObject"])?n=a.object({x:a.number(),y:a.number()}):oe(s,["PgHalfVector","PgVector"])?(n=a.array(a.number()),n=s.dimensions?n.length(s.dimensions):n):oe(s,["PgLine"])?n=a.tuple([a.number(),a.number(),a.number()]):oe(s,["PgLineABC"])?n=a.object({a:a.number(),b:a.number(),c:a.number()}):oe(s,["PgArray"])?(n=a.array(Yn(s.baseColumn,a)),n=s.size?n.length(s.size):n):s.dataType==="array"?n=a.array(a.any()):s.dataType==="number"?n=Wm(s,a,r):s.dataType==="bigint"?n=Hm(s,a,r):s.dataType==="boolean"?n=r===!0||r.boolean?a.coerce.boolean():a.boolean():s.dataType==="date"?n=r===!0||r.date?a.coerce.date():a.date():s.dataType==="string"?n=Um(s,a,r):s.dataType==="json"?n=$m:s.dataType==="custom"?n=a.any():s.dataType==="buffer"&&(n=Vm)),n||(n=a.any()),n}function Wm(s,t,a){let r=s.getSQLType().includes("unsigned"),n,i,o=!1;oe(s,["MySqlTinyInt","SingleStoreTinyInt"])?(n=r?0:re.INT8_MIN,i=r?re.INT8_UNSIGNED_MAX:re.INT8_MAX,o=!0):oe(s,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(n=r?0:re.INT16_MIN,i=r?re.INT16_UNSIGNED_MAX:re.INT16_MAX,o=!0):oe(s,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(n=r?0:re.INT24_MIN,i=r?re.INT24_UNSIGNED_MAX:re.INT24_MAX,o=oe(s,["MySqlMediumInt","SingleStoreMediumInt"])):oe(s,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(n=r?0:re.INT32_MIN,i=r?re.INT32_UNSIGNED_MAX:re.INT32_MAX,o=!0):oe(s,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(n=r?0:re.INT48_MIN,i=r?re.INT48_UNSIGNED_MAX:re.INT48_MAX):oe(s,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(r=r||oe(s,["MySqlSerial","SingleStoreSerial"]),n=r?0:Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,o=!0):oe(s,["MySqlYear","SingleStoreYear"])?(n=1901,i=2155,o=!0):(n=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER);let m=a===!0||a?.number?t.coerce.number():t.number();return m=m.min(n).max(i),o?m.int():m}function Hm(s,t,a){const r=s.getSQLType().includes("unsigned"),n=r?0n:re.INT64_MIN,i=r?re.INT64_UNSIGNED_MAX:re.INT64_MAX;return(a===!0||a?.bigint?t.coerce.bigint():t.bigint()).min(n).max(i)}function Um(s,t,a){if(oe(s,["PgUUID"]))return t.string().uuid();let r,n,i=!1;oe(s,["PgVarchar","SQLiteText"])?r=s.length:oe(s,["MySqlVarChar","SingleStoreVarChar"])?r=s.length??re.INT16_UNSIGNED_MAX:oe(s,["MySqlText","SingleStoreText"])&&(s.textType==="longtext"?r=re.INT32_UNSIGNED_MAX:s.textType==="mediumtext"?r=re.INT24_UNSIGNED_MAX:s.textType==="text"?r=re.INT16_UNSIGNED_MAX:r=re.INT8_UNSIGNED_MAX),oe(s,["PgChar","MySqlChar","SingleStoreChar"])&&(r=s.length,i=!0),oe(s,["PgBinaryVector"])&&(n=/^[01]+$/,r=s.dimensions);let o=a===!0||a?.string?t.coerce.string():t.string();return o=n?o.regex(n):o,r&&i?o.length(r):r?o.max(r):o}function Gn(s){return $n(s)?Rc(s):_c(s)}function Xn(s,t,a,r){const n={};for(const[i,o]of Object.entries(s)){if(!ue(o,ds)&&!ue(o,Z)&&!ue(o,Z.Aliased)&&typeof o=="object"){const y=$n(o)||Oc(o)?Gn(o):o;n[i]=Xn(y,t[i]??{},a,r);continue}const m=t[i];if(m!==void 0&&typeof m!="function"){n[i]=m;continue}const h=ue(o,ds)?o:void 0,f=h?Yn(h,r):ua(),d=typeof m=="function"?m(f):f;a.never(h)||(n[i]=d,h&&(a.nullable(h)&&(n[i]=n[i].nullable()),a.optional(h)&&(n[i]=n[i].optional())))}return Ct(n)}const Km={never:s=>s?.generated?.type==="always"||s?.generatedIdentity?.type==="always",optional:s=>!s.notNull||s.notNull&&s.hasDefault,nullable:s=>!s.notNull},es=(s,t)=>{const a=Gn(s);return Xn(a,{},Km)},ps=It("users",{id:kt("id").primaryKey(),username:xe("username").notNull().unique(),email:xe("email").notNull().unique(),password:xe("password").notNull(),phone:xe("phone"),state:xe("state"),district:xe("district"),householdName:xe("household_name"),createdAt:Ge("created_at").defaultNow().notNull()}),ms=It("households",{id:kt("id").primaryKey(),userId:ge("user_id").notNull().references(()=>ps.id,{onDelete:"cascade"}),name:xe("name").notNull(),address:xe("address").notNull(),solarCapacity:ge("solar_capacity_watts").notNull(),batteryCapacity:ge("battery_capacity_kwh").notNull(),currentBatteryLevel:ge("current_battery_percent").notNull().default(50),isOnline:Ma("is_online").notNull().default(!0),coordinates:Kn("coordinates"),createdAt:Ge("created_at").defaultNow().notNull()},s=>[Ye("households_user_id_idx").on(s.userId)]),Qm=It("energy_readings",{id:kt("id").primaryKey(),householdId:ge("household_id").notNull().references(()=>ms.id,{onDelete:"cascade"}),timestamp:Ge("timestamp").defaultNow().notNull(),solarGeneration:ge("solar_generation_watts").notNull(),energyConsumption:ge("energy_consumption_watts").notNull(),batteryLevel:ge("battery_level_percent").notNull(),weatherCondition:xe("weather_condition"),temperature:ge("temperature_celsius")},s=>[Ye("readings_household_ts_idx").on(s.householdId,s.timestamp)]),Jn=It("energy_trades",{id:kt("id").primaryKey(),sellerHouseholdId:ge("seller_household_id").references(()=>ms.id,{onDelete:"set null"}),buyerHouseholdId:ge("buyer_household_id").references(()=>ms.id,{onDelete:"set null"}),energyAmount:ge("energy_amount_kwh").notNull(),pricePerKwh:ge("price_per_kwh_rupees").notNull(),status:xe("status").notNull().default("pending"),tradeType:xe("trade_type").notNull(),createdAt:Ge("created_at").defaultNow().notNull(),completedAt:Ge("completed_at")},s=>[Ye("trades_seller_idx").on(s.sellerHouseholdId),Ye("trades_buyer_idx").on(s.buyerHouseholdId),Ye("trades_status_idx").on(s.status)]),Ym=It("trade_acceptances",{id:kt("id").primaryKey(),tradeId:ge("trade_id").notNull().references(()=>Jn.id,{onDelete:"cascade"}),acceptorUserId:ge("acceptor_user_id").notNull().references(()=>ps.id,{onDelete:"cascade"}),acceptorHouseholdId:ge("acceptor_household_id").notNull().references(()=>ms.id,{onDelete:"cascade"}),status:xe("status").notNull().default("applied"),contactShared:Ma("contact_shared").notNull().default(!1),acceptedAt:Ge("accepted_at").defaultNow().notNull(),completedAt:Ge("completed_at")},s=>[Ye("acceptances_trade_idx").on(s.tradeId),Ye("acceptances_user_idx").on(s.acceptorUserId)]),Gm=It("chat_messages",{id:kt("id").primaryKey(),userId:ge("user_id").references(()=>ps.id,{onDelete:"set null"}),sessionId:xe("session_id"),username:xe("username").notNull(),message:xe("message").notNull(),type:xe("type").notNull().default("user"),category:xe("category").default("general"),createdAt:Ge("created_at").defaultNow().notNull()},s=>[Ye("chat_user_idx").on(s.userId),Ye("chat_session_idx").on(s.sessionId)]);It("user_sessions",{sessionId:xe("session_id").primaryKey(),userId:ge("user_id").references(()=>ps.id,{onDelete:"cascade"}).notNull(),createdAt:Ge("created_at").defaultNow().notNull(),expiresAt:Ge("expires_at").notNull()},s=>[Ye("sessions_user_idx").on(s.userId),Ye("sessions_expires_idx").on(s.expiresAt)]);es(ps).pick({username:!0,email:!0,password:!0,phone:!0,state:!0,district:!0,householdName:!0});const Xm=Ct({email:$e().email("Please enter a valid email address"),password:$e().min(1,"Password is required")}),Jm=["10minutemail.com","10minutemail.net","guerrillamail.com","guerrillamail.org","guerrillamail.net","guerrillamail.biz","guerrillamail.de","guerrillamailblock.com","sharklasers.com","grr.la","guerrillamailblock.com","pokemail.net","spam4.me","tempmail.org","tempail.com","temp-mail.org","yopmail.com","yopmail.fr","yopmail.net","cool.fr.nf","jetable.fr.nf","nospam.ze.tc","nomail.xl.cx","mega.zik.dj","speed.1s.fr","courriel.fr.nf","moncourrier.fr.nf","monemail.fr.nf","monmail.fr.nf","mailinator.com","mailinator.net","mailinator.org","mailinator2.com","mailinator.gq","safetymail.info","throwaway.email","fakemailgenerator.com","trashmail.com","trashmail.org","trashmail.net","trashmail.ws","trashmailer.com","temporaryemail.net","temporaryforwarding.com","20minutemail.com","emailondeck.com","maildrop.cc","tempinbox.com","tempemailaddress.com","tempemail.com","tempmailaddress.com","getairmail.com","airmail.cc","mytrashmail.com","mintemail.com","spamgourmet.com","mailcatch.com","mohmal.com","nada.email","getnada.com","dispostable.com","emailfake.com","emailto.de","emkei.cz","fake-mail.ml","fakemail.net","getnada.com","incognitomail.org","inboxkitten.com","mailnesia.com"],Zm=Ct({username:$e().min(3,"Username must be at least 3 characters"),email:$e().email("Please enter a valid email address").refine(s=>{const t=s.split("@")[1]?.toLowerCase();return!Jm.includes(t)},"Please use a valid personal or business email address. Temporary email addresses are not allowed."),password:$e().min(8,"Password must be at least 8 characters").regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/,"Password must contain at least one uppercase letter, one lowercase letter, and one number"),confirmPassword:$e().min(1,"Please confirm your password"),phone:$e().min(10,"Phone number must be at least 10 digits"),state:$e().min(1,"State is required"),district:$e().min(1,"District is required"),householdName:$e().min(1,"Household name is required"),address:$e().min(1,"Address is required"),solarCapacity:Ht.number().min(1e3,"Solar capacity must be at least 1000 watts"),batteryCapacity:Ht.number().int("Battery capacity must be a whole number").min(1,"Battery capacity must be at least 1 kWh"),dataAccuracyConfirmed:an().refine(s=>s===!0,{message:"You must confirm that the provided details are accurate"})}).refine(s=>s.password===s.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});es(ms).pick({userId:!0,name:!0,address:!0,solarCapacity:!0,batteryCapacity:!0,currentBatteryLevel:!0,coordinates:!0});es(Qm).pick({householdId:!0,solarGeneration:!0,energyConsumption:!0,batteryLevel:!0,weatherCondition:!0,temperature:!0});es(Jn).pick({sellerHouseholdId:!0,buyerHouseholdId:!0,energyAmount:!0,pricePerKwh:!0,tradeType:!0}).partial({sellerHouseholdId:!0,buyerHouseholdId:!0}).refine(s=>!(s.tradeType==="sell"&&!s.sellerHouseholdId||s.tradeType==="buy"&&!s.buyerHouseholdId),{message:"Either seller or buyer household ID must be provided based on trade type"});es(Gm).pick({userId:!0,sessionId:!0,username:!0,message:!0,type:!0,category:!0});es(Ym).pick({tradeId:!0,acceptorUserId:!0,acceptorHouseholdId:!0,status:!0});Ct({condition:Sa(["sunny","partly-cloudy","cloudy","overcast","rainy","stormy"])});Ct({householdIds:rn(Ls().int().positive()).optional().default([])});function eu(){const{user:s,loginMutation:t}=ct(),[,a]=xs(),[r,n]=l.useState(!1),[i,o]=l.useState(""),[m,h]=l.useState("error"),[f,d]=l.useState(!1),{register:y,handleSubmit:b,formState:{errors:N}}=Ut({resolver:Yt(Xm)});l.useEffect(()=>{if(t.isError){const E=t.error?.message||"";E.includes("Server is currently unavailable")||E.includes("Failed to fetch")?(o("Server is down. Please try again later."),h("error"),n(!0),setTimeout(()=>{n(!1)},5e3)):(o("Invalid email or password. Please check your credentials and try again."),h("error"),n(!0),setTimeout(()=>{n(!1)},5e3))}},[t.isError,t.error]),l.useEffect(()=>{t.isSuccess&&(o("You have logged in successfully!"),h("success"),n(!0),setTimeout(()=>{n(!1),a("/")},2500))},[t.isSuccess,a]),l.useEffect(()=>{s&&!t.isPending&&!t.isError&&!t.isSuccess&&a("/")},[s,a,t.isPending,t.isError,t.isSuccess]);const T=E=>{n(!1),t.mutate(E)};return e.jsxs(e.Fragment,{children:[r&&e.jsx("div",{className:"fixed top-20 sm:top-24 md:top-28 right-2 sm:right-4 md:right-6 z-[10000] w-full max-w-xs sm:max-w-sm md:max-w-md px-2 sm:px-0",children:e.jsx(Aa,{type:m,title:m==="success"?"Login Successful":"Login Failed",description:i,onClose:()=>n(!1)})}),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-800 to-slate-900 p-3 sm:p-4 md:p-6 pt-20",children:e.jsxs("div",{className:"w-full max-w-6xl grid md:grid-cols-2 gap-4 sm:gap-6 md:gap-8 items-center",children:[e.jsx("div",{className:"flex justify-center md:justify-end order-2 md:order-1 p-4",children:e.jsxs(D,{className:"w-full max-w-sm sm:max-w-md bg-muted backdrop-blur-sm border border-border shadow-2xl",children:[e.jsxs(se,{className:"space-y-1 text-center px-4 sm:px-6 py-4 sm:py-6",children:[e.jsx("div",{className:"flex items-center justify-center space-x-2 mb-3 sm:mb-4",children:e.jsx("div",{className:"p-1.5 sm:p-2 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full",children:e.jsx(ft,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})})}),e.jsx(le,{className:"text-xl sm:text-2xl font-semibold text-primary-custom",children:"Welcome Back"}),e.jsx(ka,{className:"text-sm sm:text-base text-secondary-custom",children:"Sign in to your account to continue"})]}),e.jsx(U,{className:"px-4 sm:px-6 pb-4 sm:pb-6",children:e.jsxs("form",{onSubmit:b(T),className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"email",className:"text-sm font-medium text-primary-custom",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ms,{className:"absolute left-3 top-3 h-4 w-4 text-blue-200"}),e.jsx(te,{id:"email",type:"email",placeholder:"Enter your email",className:"pl-10 h-10 sm:h-11 text-sm sm:text-base bg-gradient-to-r from-blue-800 to-blue-700 border-blue-600 text-white placeholder:text-blue-200 focus:border-blue-500 focus:ring-blue-500 transition-all duration-200",...y("email")})]}),N.email&&e.jsx("p",{className:"text-sm text-red-600",children:N.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"password",className:"text-sm font-medium text-primary-custom",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Pt,{className:"absolute left-3 top-3 h-4 w-4 text-blue-200"}),e.jsx(te,{id:"password",type:f?"text":"password",placeholder:"Enter your password",className:"pl-10 pr-10 h-10 sm:h-11 text-sm sm:text-base bg-gradient-to-r from-blue-800 to-blue-700 border-blue-600 text-white placeholder:text-blue-200 focus:border-blue-500 focus:ring-blue-500 transition-all duration-200",...y("password")}),e.jsx("button",{type:"button",onClick:()=>d(!f),className:"absolute right-3 top-3 text-blue-200 hover:text-white transition-colors duration-200",children:f?e.jsx(ma,{className:"h-4 w-4"}):e.jsx(Ds,{className:"h-4 w-4"})})]}),N.password&&e.jsx("p",{className:"text-sm text-red-600",children:N.password.message})]}),e.jsx(w,{type:"submit",disabled:t.isPending,className:"w-full h-10 sm:h-11 text-sm sm:text-base bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white font-medium transition-all duration-200 shadow-lg hover:shadow-xl touch-manipulation",children:t.isPending?e.jsxs(e.Fragment,{children:[e.jsx(gt,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing in..."]}):"Sign In"}),e.jsx("div",{className:"text-center pt-2",children:e.jsxs("p",{className:"text-xs sm:text-sm text-secondary-custom",children:["Don't have an account?"," ",e.jsx(Te,{href:"/signup",children:e.jsx("span",{className:"text-primary hover:text-accent font-medium cursor-pointer transition-colors duration-200",children:"Sign up here"})})]})})]})})]})}),e.jsxs("div",{className:"hidden md:flex flex-col justify-center space-y-4 sm:space-y-6 p-4 sm:p-6 lg:p-8 order-1 md:order-2",children:[e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"Join SolarSense"}),e.jsx("p",{className:"text-base sm:text-lg lg:text-xl text-secondary-custom leading-relaxed",children:"Connect to the intelligent energy trading network and optimize your solar energy usage."})]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-primary/20 rounded-full mt-1",children:e.jsx(ft,{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold text-primary-custom",children:"Energy Trading Dashboard"}),e.jsx("p",{className:"text-xs sm:text-sm text-secondary-custom",children:"Monitor real-time energy trades, track your household's generation and consumption"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-accent/20 rounded-full mt-1",children:e.jsx(Yi,{className:"h-4 w-4 sm:h-5 sm:w-5 text-accent"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold text-primary-custom",children:"AI-Powered Optimization"}),e.jsx("p",{className:"text-xs sm:text-sm text-secondary-custom",children:"Get intelligent recommendations for energy trading and battery management"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-primary/20 rounded-full mt-1",children:e.jsx(Pt,{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold text-primary-custom",children:"Network Analytics"}),e.jsx("p",{className:"text-xs sm:text-sm text-secondary-custom",children:"Access detailed insights on grid stability, trading volumes, and carbon savings"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-accent/20 rounded-full mt-1",children:e.jsx(Ms,{className:"h-4 w-4 sm:h-5 sm:w-5 text-accent"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold text-primary-custom",children:"Energy Trading History"}),e.jsx("p",{className:"text-xs sm:text-sm text-secondary-custom",children:"Track your trading performance and energy optimization over time"})]})]})]})]})]})})]})}const Zn=l.forwardRef(({className:s,...t},a)=>e.jsx(_r,{ref:a,className:A("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...t,children:e.jsx(ki,{className:A("flex items-center justify-center text-current"),children:e.jsx(Na,{className:"h-4 w-4"})})}));Zn.displayName=_r.displayName;function tu(){const{user:s,registerMutation:t}=ct(),[,a]=xs(),[r,n]=l.useState(!1),[i,o]=l.useState(""),[m,h]=l.useState("error"),[f,d]=l.useState(!1),[y,b]=l.useState(!1),[N,T]=l.useState(""),[E,K]=l.useState(!1),G=C=>{const Q=/[A-Z]/.test(C),R=/[a-z]/.test(C),W=/\d/.test(C),ae=C.length>=8;return Q&&R&&W&&ae},fe=C=>{const Q=C.target.value;T(Q),Q.length>0&&!G(Q)?K(!0):K(!1)},{register:z,handleSubmit:B,control:be,formState:{errors:j}}=Ut({resolver:Yt(Zm)});l.useEffect(()=>{if(t.isError){const C=t.error?.message||"";C.includes("Server is currently unavailable")||C.includes("Failed to fetch")?(o("Server is down. Please try again later."),h("error"),n(!0),setTimeout(()=>{n(!1)},5e3)):(C.includes("Email already registered")?o("This email is already registered. Please use a different email or try logging in instead."):C.includes("Username already taken")?o("This username is already taken. Please choose a different username."):o("Registration failed. Please check your information and try again."),h("error"),n(!0),setTimeout(()=>{n(!1)},5e3))}},[t.isError,t.error]),l.useEffect(()=>{t.isSuccess&&(o("Account created successfully! Welcome to SolarSense AI."),h("success"),n(!0),setTimeout(()=>{n(!1),a("/")},2500))},[t.isSuccess,a]),l.useEffect(()=>{s&&!t.isPending&&!t.isError&&!t.isSuccess&&a("/")},[s,a,t.isPending,t.isError,t.isSuccess]);const M=C=>{t.mutate(C)};return e.jsxs(e.Fragment,{children:[r&&e.jsx("div",{className:"fixed top-20 sm:top-24 md:top-28 right-2 sm:right-4 md:right-6 z-[10000] w-full max-w-xs sm:max-w-sm md:max-w-md px-2 sm:px-0",children:e.jsx(Aa,{type:m,title:m==="success"?"Account Created":"Registration Failed",description:i,onClose:()=>n(!1)})}),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-800 to-slate-900 p-3 sm:p-4 md:p-6",style:{paddingTop:"3.75rem"},children:e.jsxs("div",{className:"w-full max-w-6xl grid md:grid-cols-2 gap-4 sm:gap-6 md:gap-8 items-start",children:[e.jsxs("div",{className:"hidden md:flex flex-col justify-start space-y-4 sm:space-y-6 p-4 sm:p-6 lg:p-8 order-1 md:order-1",children:[e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:"Join the Energy Revolution"}),e.jsx("p",{className:"text-base sm:text-lg lg:text-xl text-secondary-custom leading-relaxed",children:"Connect with neighbors, trade solar energy, and help build a sustainable future with AI-powered grid optimization."})]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-secondary/20 rounded-full mt-1",children:e.jsx(ft,{className:"h-4 w-4 sm:h-5 sm:w-5 text-secondary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold text-primary-custom",children:"Real Energy Trading"}),e.jsx("p",{className:"text-xs sm:text-sm text-secondary-custom",children:"Trade surplus solar energy directly with verified households in your area"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-primary/20 rounded-full mt-1",children:e.jsx(Gi,{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold text-primary-custom",children:"Grid Simulation & Testing"}),e.jsx("p",{className:"text-xs sm:text-sm text-secondary-custom",children:"Test energy scenarios with AI-powered simulations before implementing"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-accent/20 rounded-full mt-1",children:e.jsx(Ms,{className:"h-4 w-4 sm:h-5 sm:w-5 text-accent"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold text-primary-custom",children:"AI Energy Optimization"}),e.jsx("p",{className:"text-xs sm:text-sm text-secondary-custom",children:"Get personalized recommendations to maximize your solar investment"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-primary/20 rounded-full mt-1",children:e.jsx(Pt,{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold text-primary-custom",children:"Secure & Transparent"}),e.jsx("p",{className:"text-xs sm:text-sm text-secondary-custom",children:"All transactions are secure with transparent pricing and verified participants"})]})]})]})]}),e.jsx("div",{className:"flex justify-center md:justify-start order-2 md:order-2 p-4",children:e.jsxs(D,{className:"w-full max-w-sm sm:max-w-md bg-muted backdrop-blur-sm border border-border shadow-2xl",children:[e.jsxs(se,{className:"space-y-1 text-center px-4 sm:px-6 py-4 sm:py-6",children:[e.jsx("div",{className:"flex items-center justify-center space-x-2 mb-3 sm:mb-4",children:e.jsx("div",{className:"p-1.5 sm:p-2 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full",children:e.jsx(ft,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})})}),e.jsx(le,{className:"text-xl sm:text-2xl font-semibold text-primary-custom",children:"Create Account"}),e.jsx(ka,{className:"text-sm sm:text-base text-secondary-custom",children:"Join thousands of solar professionals"})]}),e.jsx(U,{className:"px-4 sm:px-6 pb-4 sm:pb-6",children:e.jsxs("form",{onSubmit:B(M),className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"username",className:"text-sm font-medium text-primary-custom",children:"Username"}),e.jsxs("div",{className:"relative",children:[e.jsx(bt,{className:"absolute left-3 top-3 h-4 w-4 text-blue-200"}),e.jsx(te,{id:"username",type:"text",placeholder:"Choose a username",className:"pl-10 h-10 sm:h-11 text-sm sm:text-base bg-gradient-to-r from-blue-800 to-blue-700 border-blue-600 text-white placeholder:text-blue-200 focus:border-blue-500 focus:ring-blue-500 transition-all duration-200",...z("username")})]}),j.username&&e.jsx("p",{className:"text-sm text-red-600",children:j.username.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"email",className:"text-sm font-medium text-primary-custom",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ms,{className:"absolute left-3 top-3 h-4 w-4 text-blue-200"}),e.jsx(te,{id:"email",type:"email",placeholder:"Enter your email",className:"pl-10 h-10 sm:h-11 text-sm sm:text-base bg-gradient-to-r from-blue-800 to-blue-700 border-blue-600 text-white placeholder:text-blue-200 focus:border-blue-500 focus:ring-blue-500 transition-all duration-200",...z("email")})]}),j.email&&e.jsx("p",{className:"text-sm text-red-600",children:j.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"password",className:"text-sm font-medium text-primary-custom",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Pt,{className:"absolute left-3 top-3 h-4 w-4 text-blue-200"}),e.jsx(te,{id:"password",type:f?"text":"password",placeholder:"Create a password",className:"pl-10 pr-10 h-10 sm:h-11 text-sm sm:text-base bg-gradient-to-r from-blue-800 to-blue-700 border-blue-600 text-white placeholder:text-blue-200 focus:border-blue-500 focus:ring-blue-500 transition-all duration-200",...z("password",{onChange:fe})}),e.jsx("button",{type:"button",onClick:()=>d(!f),className:"absolute right-3 top-3 text-blue-200 hover:text-white transition-colors duration-200",children:f?e.jsx(ma,{className:"h-4 w-4"}):e.jsx(Ds,{className:"h-4 w-4"})})]}),j.password&&e.jsx("p",{className:"text-sm text-red-600",children:j.password.message}),E&&e.jsx("p",{className:"text-xs text-red-500",children:"Password must be at least 8 characters with uppercase, lowercase, and number"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ce,{htmlFor:"confirmPassword",className:"text-sm font-medium text-primary-custom",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Pt,{className:"absolute left-3 top-3 h-4 w-4 text-blue-200"}),e.jsx(te,{id:"confirmPassword",type:y?"text":"password",placeholder:"Confirm your password",className:"pl-10 pr-10 h-10 sm:h-11 text-sm sm:text-base bg-gradient-to-r from-blue-800 to-blue-700 border-blue-600 text-white placeholder:text-blue-200 focus:border-blue-500 focus:ring-blue-500 transition-all duration-200",...z("confirmPassword")}),e.jsx("button",{type:"button",onClick:()=>b(!y),className:"absolute right-3 top-3 text-blue-200 hover:text-white transition-colors duration-200",children:y?e.jsx(ma,{className:"h-4 w-4"}):e.jsx(Ds,{className:"h-4 w-4"})})]}),j.confirmPassword&&e.jsx("p",{className:"text-sm text-red-600",children:j.confirmPassword.message})]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(Ce,{htmlFor:"phone",className:"text-sm font-medium text-primary-custom",children:["Phone Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Xi,{className:"absolute left-3 top-3 h-4 w-4 text-blue-200"}),e.jsx(te,{id:"phone",type:"tel",placeholder:"+91-98765-43210",className:"pl-10 h-10 sm:h-11 text-sm sm:text-base bg-gradient-to-r from-blue-800 to-blue-700 border-blue-600 text-white placeholder:text-blue-200 focus:border-blue-500 focus:ring-blue-500 transition-all duration-200",...z("phone")})]}),j.phone&&e.jsx("p",{className:"text-sm text-red-600",children:j.phone.message})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(Ce,{htmlFor:"state",className:"text-sm font-medium text-primary-custom",children:["State ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Wt,{className:"absolute left-3 top-3 h-4 w-4 text-blue-200"}),e.jsx(te,{id:"state",type:"text",placeholder:"Enter your state",className:"pl-10 h-10 sm:h-11 text-sm sm:text-base bg-gradient-to-r from-blue-800 to-blue-700 border-blue-600 text-white placeholder:text-blue-200 focus:border-blue-500 focus:ring-blue-500 transition-all duration-200",...z("state")})]}),j.state&&e.jsx("p",{className:"text-sm text-red-600",children:j.state.message})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(Ce,{htmlFor:"district",className:"text-sm font-medium text-primary-custom",children:["District ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ji,{className:"absolute left-3 top-3 h-4 w-4 text-blue-200"}),e.jsx(te,{id:"district",type:"text",placeholder:"Enter your district",className:"pl-10 h-10 sm:h-11 text-sm sm:text-base bg-gradient-to-r from-blue-800 to-blue-700 border-blue-600 text-white placeholder:text-blue-200 focus:border-blue-500 focus:ring-blue-500 transition-all duration-200",...z("district")})]}),j.district&&e.jsx("p",{className:"text-sm text-red-600",children:j.district.message})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(Ce,{htmlFor:"address",className:"text-sm font-medium text-primary-custom",children:["Physical Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Wt,{className:"absolute left-3 top-3 h-4 w-4 text-blue-200"}),e.jsx(te,{id:"address",type:"text",placeholder:"123 Solar Nagar, City, State",className:"pl-10 h-10 sm:h-11 text-sm sm:text-base bg-gradient-to-r from-blue-800 to-blue-700 border-blue-600 text-white placeholder:text-blue-200 focus:border-blue-500 focus:ring-blue-500 transition-all duration-200",...z("address")})]}),j.address&&e.jsx("p",{className:"text-sm text-red-600",children:j.address.message})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(Ce,{htmlFor:"householdName",className:"text-sm font-medium text-primary-custom",children:["Household Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Bt,{className:"absolute left-3 top-3 h-4 w-4 text-blue-200"}),e.jsx(te,{id:"householdName",type:"text",placeholder:"Smith Family Solar Home",className:"pl-10 h-10 sm:h-11 text-sm sm:text-base bg-gradient-to-r from-blue-800 to-blue-700 border-blue-600 text-white placeholder:text-blue-200 focus:border-blue-500 focus:ring-blue-500 transition-all duration-200",...z("householdName")})]}),j.householdName&&e.jsx("p",{className:"text-sm text-red-600",children:j.householdName.message})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(Ce,{htmlFor:"solarCapacity",className:"text-sm font-medium text-primary-custom",children:["Solar Capacity (Watts)"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ie,{className:"absolute left-3 top-3 h-4 w-4 text-blue-200"}),e.jsx(te,{id:"solarCapacity",type:"number",placeholder:"8000",className:"pl-10 h-10 sm:h-11 text-sm sm:text-base bg-gradient-to-r from-blue-800 to-blue-700 border-blue-600 text-white placeholder:text-blue-200 focus:border-blue-500 focus:ring-blue-500 transition-all duration-200",...z("solarCapacity")})]}),j.solarCapacity&&e.jsx("p",{className:"text-sm text-red-600",children:j.solarCapacity.message})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(Ce,{htmlFor:"batteryCapacity",className:"text-sm font-medium text-primary-custom",children:["Battery Storage (kWh)"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ns,{className:"absolute left-3 top-3 h-4 w-4 text-blue-200"}),e.jsx(te,{id:"batteryCapacity",type:"number",step:"1",placeholder:"13",className:"pl-10 h-10 sm:h-11 text-sm sm:text-base bg-gradient-to-r from-blue-800 to-blue-700 border-blue-600 text-white placeholder:text-blue-200 focus:border-blue-500 focus:ring-blue-500 transition-all duration-200",...z("batteryCapacity")})]}),j.batteryCapacity&&e.jsx("p",{className:"text-sm text-red-600",children:j.batteryCapacity.message})]}),e.jsxs("div",{className:"flex items-start space-x-2 pt-2",children:[e.jsx(tn,{name:"dataAccuracyConfirmed",control:be,render:({field:C})=>e.jsx(Zn,{id:"dataAccuracyConfirmed",checked:C.value,onCheckedChange:C.onChange,className:"mt-1"})}),e.jsx("div",{className:"grid gap-1.5 leading-none",children:e.jsx(Ce,{htmlFor:"dataAccuracyConfirmed",className:"text-xs sm:text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 text-primary-custom",children:"I confirm that the provided energy system details are accurate"})})]}),j.dataAccuracyConfirmed&&e.jsx("p",{className:"text-sm text-red-600",children:j.dataAccuracyConfirmed.message})]}),e.jsx(w,{type:"submit",disabled:t.isPending,className:"w-full h-10 sm:h-11 text-sm sm:text-base bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white font-medium transition-all duration-200 shadow-lg hover:shadow-xl touch-manipulation",children:t.isPending?e.jsxs(e.Fragment,{children:[e.jsx(gt,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating Account..."]}):"Create Account"}),e.jsx("div",{className:"text-center pt-2",children:e.jsxs("p",{className:"text-xs sm:text-sm text-secondary-custom",children:["Already have an account?"," ",e.jsx(Te,{href:"/login",children:e.jsx("span",{className:"text-primary hover:text-accent font-medium cursor-pointer transition-colors duration-200",children:"Sign in here"})})]})})]})})]})})]})})]})}function su(){return e.jsxs(e.Fragment,{children:[e.jsx(Tt,{}),e.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50 pt-20",children:e.jsx(D,{className:"w-full max-w-md mx-4",children:e.jsxs(U,{className:"pt-6",children:[e.jsxs("div",{className:"flex mb-4 gap-2",children:[e.jsx(va,{className:"h-8 w-8 text-red-500"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),e.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})]})}function au(){return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary to-blue-600 flex items-center justify-center px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center text-white max-w-lg w-full",children:[e.jsx("div",{className:"mb-6 sm:mb-8 flex justify-center",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-white rounded-full flex items-center justify-center animate-pulse",children:e.jsx(ft,{className:"text-primary",size:32})}),e.jsx("div",{className:"absolute inset-0 w-16 h-16 sm:w-20 sm:h-20 border-4 border-white border-t-transparent rounded-full animate-spin"})]})}),e.jsx("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold mb-3 sm:mb-4",children:"SolarSense AI"}),e.jsx("p",{className:"text-base sm:text-lg lg:text-xl opacity-90 mb-6 sm:mb-8 px-2",children:"Loading AI-Powered Energy Trading Platform"}),e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 sm:w-3 sm:h-3 bg-white rounded-full animate-bounce"}),e.jsx("div",{className:"w-2 h-2 sm:w-3 sm:h-3 bg-white rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),e.jsx("div",{className:"w-2 h-2 sm:w-3 sm:h-3 bg-white rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})})}const ru=Ii,ei=l.forwardRef(({className:s,...t},a)=>e.jsx(Br,{ref:a,className:A("fixed top-4 right-2 sm:right-4 md:right-6 z-[10000] flex max-h-screen w-full max-w-xs sm:max-w-sm md:max-w-md lg:max-w-lg flex-col p-2 sm:p-4",s),...t}));ei.displayName=Br.displayName;const nu=Gt("group pointer-events-auto relative flex w-full items-center justify-between space-x-3 sm:space-x-4 overflow-hidden rounded-lg border-l-4 p-3 sm:p-4 md:p-5 pr-6 sm:pr-8 shadow-lg transition-all duration-300 data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border-l-gray-400 bg-white text-gray-900 shadow-md",destructive:"destructive group border-l-red-500 bg-red-500 text-white shadow-lg",success:"success group border-l-green-500 bg-green-500 text-white shadow-lg",warning:"warning group border-l-blue-500 bg-blue-500 text-white shadow-lg",info:"info group border-l-blue-500 bg-blue-500 text-white shadow-lg"}},defaultVariants:{variant:"default"}}),ti=l.forwardRef(({className:s,variant:t,...a},r)=>{const n=()=>{switch(t){case"success":return e.jsx(ie,{className:"h-4 w-4 sm:h-5 sm:w-5 flex-shrink-0"});case"destructive":return e.jsx(va,{className:"h-4 w-4 sm:h-5 sm:w-5 flex-shrink-0"});case"warning":return e.jsx(Xt,{className:"h-4 w-4 sm:h-5 sm:w-5 flex-shrink-0"});case"info":return e.jsx(Es,{className:"h-4 w-4 sm:h-5 sm:w-5 flex-shrink-0"});default:return e.jsx(Es,{className:"h-4 w-4 sm:h-5 sm:w-5 flex-shrink-0"})}};return e.jsx(zr,{ref:r,className:A(nu({variant:t}),s),...a,children:e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:n()}),e.jsx("div",{className:"flex-1 min-w-0",children:a.children})]})})});ti.displayName=zr.displayName;const iu=l.forwardRef(({className:s,...t},a)=>e.jsx(qr,{ref:a,className:A("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...t}));iu.displayName=qr.displayName;const si=l.forwardRef(({className:s,...t},a)=>e.jsx($r,{ref:a,className:A("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...t,children:e.jsx(ce,{className:"h-3 w-3 sm:h-4 sm:w-4"})}));si.displayName=$r.displayName;const ai=l.forwardRef(({className:s,...t},a)=>e.jsx(Vr,{ref:a,className:A("text-sm sm:text-base font-semibold leading-tight",s),...t}));ai.displayName=Vr.displayName;const ri=l.forwardRef(({className:s,...t},a)=>e.jsx(Wr,{ref:a,className:A("text-xs sm:text-sm opacity-90 leading-relaxed mt-1",s),...t}));ri.displayName=Wr.displayName;function lu(){const{toasts:s}=Zt();return e.jsxs(ru,{children:[s.map(function({id:t,title:a,description:r,action:n,...i}){return e.jsxs(ti,{...i,children:[e.jsxs("div",{className:"grid gap-1",children:[a&&e.jsx(ai,{children:a}),r&&e.jsx(ri,{children:r})]}),n,e.jsx(si,{})]},t)}),e.jsx(ei,{})]})}function ou(){const[s]=xs();return l.useEffect(()=>{window.scrollTo(0,0)},[s]),null}function cu(){return e.jsxs(e.Fragment,{children:[e.jsx(ou,{}),e.jsxs(Cl,{children:[e.jsx(ws,{path:"/",component:to}),e.jsx(ws,{path:"/about",component:so}),e.jsx(ws,{path:"/chat",component:uc}),e.jsx(ws,{path:"/storage",component:Nc}),e.jsx(qt,{path:"/login",component:eu}),e.jsx(qt,{path:"/signup",component:tu}),e.jsx(qt,{component:su})]})]})}function du(){const[s,t]=l.useState(!0);return l.useEffect(()=>{const a=setTimeout(()=>t(!1),600);return()=>clearTimeout(a)},[]),s?e.jsx(au,{}):e.jsx(xi,{client:Al,children:e.jsxs(Ol,{children:[e.jsx(cu,{}),e.jsx(lu,{})]})})}cl.createRoot(document.getElementById("root")).render(e.jsx(du,{}));
